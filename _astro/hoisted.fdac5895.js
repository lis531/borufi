/* empty css                       */const oa={name:"InvalidComponentArgs",title:"Invalid component arguments.",message:t=>`Invalid arguments passed to${t?` <${t}>`:""} component.`,hint:"Astro components cannot be rendered directly via function call, such as `Component()` or `{items.map(Component)}`."},aa={name:"AstroGlobUsedOutside",title:"Astro.glob() used outside of an Astro file.",message:t=>`\`Astro.glob(${t})\` can only be used in \`.astro\` files. \`import.meta.glob(${t})\` can be used instead to achieve a similar result.`,hint:"See Vite's documentation on `import.meta.glob` for more information: https://vitejs.dev/guide/features.html#glob-import"},la={name:"AstroGlobNoMatch",title:"Astro.glob() did not match any files.",message:t=>`\`Astro.glob(${t})\` did not return any matching files. Check the pattern for typos.`};function fd(t){return t.replace(/\r\n|\r(?!\n)|\n/g,`
`)}function dd(t,e){if(!e||e.line===void 0||e.column===void 0)return"";const n=fd(t).split(`
`).map(o=>o.replace(/\t/g,"  ")),r=[];for(let o=-2;o<=2;o++)n[e.line+o]&&r.push(e.line+o);let i=0;for(const o of r){let a=`> ${o}`;a.length>i&&(i=a.length)}let s="";for(const o of r){const a=o===e.line-1;s+=a?"> ":"  ",s+=`${o+1} | ${n[o]}
`,a&&(s+=`${Array.from({length:i}).join(" ")}  | ${Array.from({length:e.column}).join(" ")}^
`)}return s}class Zi extends Error{loc;title;hint;frame;type="AstroError";constructor(e,...n){super(...n);const{name:r,title:i,message:s,stack:o,location:a,hint:l,frame:c}=e;this.title=i,this.name=r,s&&(this.message=s),this.stack=o||this.stack,this.loc=a,this.hint=l,this.frame=c}setLocation(e){this.loc=e}setName(e){this.name=e}setMessage(e){this.message=e}setHint(e){this.hint=e}setFrame(e,n){this.frame=dd(e,n)}static is(e){return e.type==="AstroError"}}function pd(t){return!(t.length!==3||!t[0]||typeof t[0]!="object")}function Oc(t,e,n){const r=e?.split("/").pop()?.replace(".astro","")??"",i=(...s)=>{if(!pd(s))throw new Zi({...oa,message:oa.message(r)});return t(...s)};return Object.defineProperty(i,"name",{value:r,writable:!1}),i.isAstroComponentFactory=!0,i.moduleId=e,i.propagation=n,i}function gd(t){return Oc(t.factory,t.moduleId,t.propagation)}function md(t,e,n){return typeof t=="function"?Oc(t,e,n):gd(t)}const _d="3.6.4";function yd(){return e=>{if(typeof e=="string")throw new Zi({...aa,message:aa.message(JSON.stringify(e))});let n=[...Object.values(e)];if(n.length===0)throw new Zi({...la,message:la.message(JSON.stringify(e))});return Promise.all(n.map(r=>r()))}}function vd(t){return{site:t?new URL(t):void 0,generator:`Astro v${_d}`,glob:yd()}}const{replace:bd}="",wd=/[&<>'"]/g,Ed={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},Cd=t=>Ed[t],Sd=t=>bd.call(t,wd,Cd);function Td(t){return!!t&&typeof t=="object"&&typeof t.then=="function"}const Id=Sd;class es extends String{get[Symbol.toStringTag](){return"HTMLString"}}const xc=t=>t instanceof es?t:typeof t=="string"?new es(t):t;function Ad(t){return Object.prototype.toString.call(t)==="[object HTMLString]"}const Pd=Symbol.for("astro:render");function Rd(t){return Object.defineProperty(t,Pd,{value:!0})}function Nc(t){const e=[],n={write:i=>e.push(i)},r=t(n);return{async renderToFinalDestination(i){for(const s of e)i.write(s);n.write=s=>i.write(s),await r}}}function*Od(){yield Rd({type:"maybe-head"})}const ca=Symbol.for("astro:slot-string");class xd extends es{instructions;[ca];constructor(e,n){super(e),this.instructions=n,this[ca]=!0}}new TextEncoder;new TextDecoder;function Nd(t){return!!t&&typeof t=="object"&&"render"in t&&typeof t.render=="function"}async function Er(t,e){if(e=await e,e instanceof xd)t.write(e);else if(Ad(e))t.write(e);else if(Array.isArray(e)){const n=e.map(r=>Nc(i=>Er(i,r)));for(const r of n)r&&await r.renderToFinalDestination(t)}else if(typeof e=="function")await Er(t,e());else if(typeof e=="string")t.write(xc(Id(e)));else if(!(!e&&e!==0))if(Nd(e))await e.render(t);else if(Ld(e))await e.render(t);else if($d(e))await e.render(t);else if(ArrayBuffer.isView(e))t.write(e);else if(typeof e=="object"&&(Symbol.asyncIterator in e||Symbol.iterator in e))for await(const n of e)await Er(t,n);else t.write(e)}const Dd=Symbol.for("astro.componentInstance");function $d(t){return typeof t=="object"&&!!t[Dd]}const Dc=Symbol.for("astro.renderTemplateResult");class Md{[Dc]=!0;htmlParts;expressions;error;constructor(e,n){this.htmlParts=e,this.error=void 0,this.expressions=n.map(r=>Td(r)?Promise.resolve(r).catch(i=>{if(!this.error)throw this.error=i,i}):r)}async render(e){const n=this.expressions.map(r=>Nc(i=>{if(r||r===0)return Er(i,r)}));for(let r=0;r<this.htmlParts.length;r++){const i=this.htmlParts[r],s=n[r];e.write(xc(i)),s&&await s.renderToFinalDestination(e)}}}function Ld(t){return typeof t=="object"&&!!t[Dc]}function kd(t,...e){return new Md(t,e)}const Fd=vd();let b={isLooping:!1,isShuffling:!1,audioSource:"",currentPlaylist:NaN,openedPlaylist:NaN,currentSong:NaN};const Bd=md(async(t,e,n)=>{const r=t.createAstro(Fd,e,n);return r.self=Bd,kd`${Od()}<div style="display: flex; justify-content: center;" data-astro-cid-quhwgcgm> <div id="audioPlayer" data-astro-cid-quhwgcgm> <div id="songInfo" data-astro-cid-quhwgcgm> <h1 id="title" data-astro-cid-quhwgcgm></h1> <h2 id="artist" data-astro-cid-quhwgcgm></h2> </div> <div id="mainControls" data-astro-cid-quhwgcgm> <div id="songControls" data-astro-cid-quhwgcgm> <button id="random" data-astro-cid-quhwgcgm> <svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" height="32px" width="32px" xmlns="http://www.w3.org/2000/svg" data-darkreader-inline-stroke="" style="--darkreader-inline-stroke: currentColor;" data-astro-cid-quhwgcgm><path fill-rule="evenodd" clip-rule="evenodd" d="M12.3536 1.14645C12.1583 0.951184 11.8417 0.951184 11.6464 1.14645C11.4512 1.34171 11.4512 1.65829 11.6464 1.85355L12.7929 3H12C10.7037 3 9.71111 3.58423 8.87248 4.38931C8.20065 5.03427 7.59349 5.85684 6.99461 6.6682C6.86287 6.84668 6.73154 7.02462 6.6 7.2C5.10874 9.18835 3.49037 11 0.5 11C0.223858 11 0 11.2239 0 11.5C0 11.7761 0.223858 12 0.5 12C4.00963 12 5.89126 9.81165 7.4 7.8C7.54367 7.60845 7.6832 7.41962 7.81996 7.23454L7.82005 7.23443L7.82006 7.23441C8.41674 6.42695 8.96069 5.69085 9.56502 5.11069C10.2889 4.41577 11.0463 4 12 4H12.7929L11.6464 5.14645C11.4512 5.34171 11.4512 5.65829 11.6464 5.85355C11.8417 6.04882 12.1583 6.04882 12.3536 5.85355L14.3536 3.85355C14.5488 3.65829 14.5488 3.34171 14.3536 3.14645L12.3536 1.14645ZM0.5 3C3.35278 3 5.12992 4.44588 6.50548 6.06746L6.3762 6.24266C6.2483 6.4161 6.12293 6.58609 6 6.75C5.96397 6.79804 5.92798 6.84581 5.892 6.89331C4.57348 5.29306 3.02637 4 0.5 4C0.223858 4 0 3.77614 0 3.5C0 3.22386 0.223858 3 0.5 3ZM8.87248 10.6107C8.37284 10.131 7.90897 9.55314 7.45767 8.95468C7.64688 8.71693 7.82704 8.48061 8 8.25L8.08987 8.12987C8.58412 8.79402 9.05288 9.39766 9.56502 9.88931C10.2889 10.5842 11.0463 11 12 11H12.7929L11.6464 9.85355C11.4512 9.65829 11.4512 9.34171 11.6464 9.14645C11.8417 8.95118 12.1583 8.95118 12.3536 9.14645L14.3536 11.1464C14.5488 11.3417 14.5488 11.6583 14.3536 11.8536L12.3536 13.8536C12.1583 14.0488 11.8417 14.0488 11.6464 13.8536C11.4512 13.6583 11.4512 13.3417 11.6464 13.1464L12.7929 12H12C10.7037 12 9.71111 11.4158 8.87248 10.6107Z" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;" data-astro-cid-quhwgcgm></path></svg> </button> <button id="playPrevious" data-astro-cid-quhwgcgm> <svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" height="32px" width="32px" xmlns="http://www.w3.org/2000/svg" data-darkreader-inline-stroke="" style="--darkreader-inline-stroke: currentColor;" data-astro-cid-quhwgcgm><path fill-rule="evenodd" clip-rule="evenodd" d="M1.94976 2.74989C1.94976 2.44613 2.196 2.19989 2.49976 2.19989C2.80351 2.19989 3.04976 2.44613 3.04976 2.74989V7.2825C3.0954 7.18802 3.17046 7.10851 3.26662 7.05776L12.2666 2.30776C12.4216 2.22596 12.6081 2.23127 12.7582 2.32176C12.9083 2.41225 13 2.57471 13 2.74995V12.25C13 12.4252 12.9083 12.5877 12.7582 12.6781C12.6081 12.7686 12.4216 12.7739 12.2666 12.6921L3.26662 7.94214C3.17046 7.89139 3.0954 7.81188 3.04976 7.7174V12.2499C3.04976 12.5536 2.80351 12.7999 2.49976 12.7999C2.196 12.7999 1.94976 12.5536 1.94976 12.2499V2.74989ZM4.57122 7.49995L12 11.4207V3.5792L4.57122 7.49995Z" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;" data-astro-cid-quhwgcgm></path></svg> </button> <button id="play" disabled data-astro-cid-quhwgcgm> <svg viewBox="0 0 15 15" height="32px" width="32px" data-astro-cid-quhwgcgm><path d="M3.24182 2.32181C3.3919 2.23132 3.5784 2.22601 3.73338 2.30781L12.7334 7.05781C12.8974 7.14436 13 7.31457 13 7.5C13 7.68543 12.8974 7.85564 12.7334 7.94219L3.73338 12.6922C3.5784 12.774 3.3919 12.7687 3.24182 12.6782C3.09175 12.5877 3 12.4252 3 12.25V2.75C3 2.57476 3.09175 2.4123 3.24182 2.32181ZM4 3.57925V11.4207L11.4288 7.5L4 3.57925" data-astro-cid-quhwgcgm></path></svg> <svg viewBox="0 0 15 15" height="32px" width="32px" data-astro-cid-quhwgcgm><path d="M6.04995 2.74998C6.04995 2.44623 5.80371 2.19998 5.49995 2.19998C5.19619 2.19998 4.94995 2.44623 4.94995 2.74998V12.25C4.94995 12.5537 5.19619 12.8 5.49995 12.8C5.80371 12.8 6.04995 12.5537 6.04995 12.25V2.74998ZM10.05 2.74998C10.05 2.44623 9.80371 2.19998 9.49995 2.19998C9.19619 2.19998 8.94995 2.44623 8.94995 2.74998V12.25C8.94995 12.5537 9.19619 12.8 9.49995 12.8C9.80371 12.8 10.05 12.5537 10.05 12.25V2.74998Z" data-astro-cid-quhwgcgm></path></svg> </button> <button id="playNext" data-astro-cid-quhwgcgm> <svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" height="32px" width="32px" xmlns="http://www.w3.org/2000/svg" data-darkreader-inline-stroke="" style="--darkreader-inline-stroke: currentColor;" data-astro-cid-quhwgcgm><path fill-rule="evenodd" clip-rule="evenodd" d="M13.0502 2.74989C13.0502 2.44613 12.804 2.19989 12.5002 2.19989C12.1965 2.19989 11.9502 2.44613 11.9502 2.74989V7.2825C11.9046 7.18802 11.8295 7.10851 11.7334 7.05776L2.73338 2.30776C2.5784 2.22596 2.3919 2.23127 2.24182 2.32176C2.09175 2.41225 2 2.57471 2 2.74995V12.25C2 12.4252 2.09175 12.5877 2.24182 12.6781C2.3919 12.7686 2.5784 12.7739 2.73338 12.6921L11.7334 7.94214C11.8295 7.89139 11.9046 7.81188 11.9502 7.7174V12.2499C11.9502 12.5536 12.1965 12.7999 12.5002 12.7999C12.804 12.7999 13.0502 12.5536 13.0502 12.2499V2.74989ZM3 11.4207V3.5792L10.4288 7.49995L3 11.4207Z" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;" data-astro-cid-quhwgcgm></path></svg> </button> <button id="loop" data-astro-cid-quhwgcgm> <svg stroke="currentColor" fill="none" stroke-width="0" viewBox="0 0 15 15" height="32px" width="32px" xmlns="http://www.w3.org/2000/svg" data-darkreader-inline-stroke="" style="--darkreader-inline-stroke: currentColor;" data-astro-cid-quhwgcgm><path fill-rule="evenodd" clip-rule="evenodd" d="M3.35355 1.85355C3.54882 1.65829 3.54882 1.34171 3.35355 1.14645C3.15829 0.951184 2.84171 0.951184 2.64645 1.14645L0.646447 3.14645C0.451184 3.34171 0.451184 3.65829 0.646447 3.85355L2.64645 5.85355C2.84171 6.04882 3.15829 6.04882 3.35355 5.85355C3.54882 5.65829 3.54882 5.34171 3.35355 5.14645L2.20711 4H9.5C11.433 4 13 5.567 13 7.5C13 7.77614 13.2239 8 13.5 8C13.7761 8 14 7.77614 14 7.5C14 5.01472 11.9853 3 9.5 3H2.20711L3.35355 1.85355ZM2 7.5C2 7.22386 1.77614 7 1.5 7C1.22386 7 1 7.22386 1 7.5C1 9.98528 3.01472 12 5.5 12H12.7929L11.6464 13.1464C11.4512 13.3417 11.4512 13.6583 11.6464 13.8536C11.8417 14.0488 12.1583 14.0488 12.3536 13.8536L14.3536 11.8536C14.5488 11.6583 14.5488 11.3417 14.3536 11.1464L12.3536 9.14645C12.1583 8.95118 11.8417 8.95118 11.6464 9.14645C11.4512 9.34171 11.4512 9.65829 11.6464 9.85355L12.7929 11H5.5C3.567 11 2 9.433 2 7.5Z" fill="currentColor" data-darkreader-inline-fill="" style="--darkreader-inline-fill: currentColor;" data-astro-cid-quhwgcgm></path></svg> </button> </div> <div id="audioNavigation" data-astro-cid-quhwgcgm> <label id="current-time" class="time" data-astro-cid-quhwgcgm>0:00</label> <input type="range" id="seek-slider" min="0" max="0" value="0" disabled data-astro-cid-quhwgcgm> <label id="duration" class="time" data-astro-cid-quhwgcgm>0:00</label> </div> </div> <div id="volumeControl" data-astro-cid-quhwgcgm> <!-- <span id="volume">50</span> --> <button id="mute" data-astro-cid-quhwgcgm> <svg id="highV" viewBox="0 0 16 16" height="32px" width="32px" fill="white" data-astro-cid-quhwgcgm><path d="M11.536 14.01A8.473 8.473 0 0 0 14.026 8a8.473 8.473 0 0 0-2.49-6.01l-.708.707A7.476 7.476 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303l.708.707z" data-astro-cid-quhwgcgm></path><path d="M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z" data-astro-cid-quhwgcgm></path><path d="M10.025 8a4.486 4.486 0 0 1-1.318 3.182L8 10.475A3.489 3.489 0 0 0 9.025 8c0-.966-.392-1.841-1.025-2.475l.707-.707A4.486 4.486 0 0 1 10.025 8zM7 4a.5.5 0 0 0-.812-.39L3.825 5.5H1.5A.5.5 0 0 0 1 6v4a.5.5 0 0 0 .5.5h2.325l2.363 1.89A.5.5 0 0 0 7 12V4zM4.312 6.39 6 5.04v5.92L4.312 9.61A.5.5 0 0 0 4 9.5H2v-3h2a.5.5 0 0 0 .312-.11z" data-astro-cid-quhwgcgm></path></svg> <svg id="medV" viewBox="0 0 16 16" height="32px" width="32px" fill="white" data-astro-cid-quhwgcgm><path d="M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.483 5.483 0 0 1 11.025 8a5.483 5.483 0 0 1-1.61 3.89l.706.706z" data-astro-cid-quhwgcgm></path><path d="M10.025 8a4.486 4.486 0 0 1-1.318 3.182L8 10.475A3.489 3.489 0 0 0 9.025 8c0-.966-.392-1.841-1.025-2.475l.707-.707A4.486 4.486 0 0 1 10.025 8zM7 4a.5.5 0 0 0-.812-.39L3.825 5.5H1.5A.5.5 0 0 0 1 6v4a.5.5 0 0 0 .5.5h2.325l2.363 1.89A.5.5 0 0 0 7 12V4zM4.312 6.39 6 5.04v5.92L4.312 9.61A.5.5 0 0 0 4 9.5H2v-3h2a.5.5 0 0 0 .312-.11z" data-astro-cid-quhwgcgm></path></svg> <svg id="lowV" viewBox="0 0 16 16" height="32px" width="32px" fill="white" data-astro-cid-quhwgcgm><path d="M10.025 8a4.486 4.486 0 0 1-1.318 3.182L8 10.475A3.489 3.489 0 0 0 9.025 8c0-.966-.392-1.841-1.025-2.475l.707-.707A4.486 4.486 0 0 1 10.025 8zM7 4a.5.5 0 0 0-.812-.39L3.825 5.5H1.5A.5.5 0 0 0 1 6v4a.5.5 0 0 0 .5.5h2.325l2.363 1.89A.5.5 0 0 0 7 12V4zM4.312 6.39 6 5.04v5.92L4.312 9.61A.5.5 0 0 0 4 9.5H2v-3h2a.5.5 0 0 0 .312-.11z" data-astro-cid-quhwgcgm></path></svg> <svg id="noV" viewBox="0 0 16 16" height="32px" width="32px" fill="white" data-astro-cid-quhwgcgm><path d="M6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06zM6 5.04 4.312 6.39A.5.5 0 0 1 4 6.5H2v3h2a.5.5 0 0 1 .312.11L6 10.96V5.04zm7.854.606a.5.5 0 0 1 0 .708L12.207 8l1.647 1.646a.5.5 0 0 1-.708.708L11.5 8.707l-1.646 1.647a.5.5 0 0 1-.708-.708L10.793 8 9.146 6.354a.5.5 0 1 1 .708-.708L11.5 7.293l1.646-1.647a.5.5 0 0 1 .708 0z" data-astro-cid-quhwgcgm></path></svg> </button> <input type="range" id="volume-slider" min="0" max="100" value="50" data-astro-cid-quhwgcgm> </div> <audio id="audio" src="" preload="metadata" data-astro-cid-quhwgcgm></audio></div> </div>  `},"E:/borufi/src/player/Player.astro",void 0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $c={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v=function(t,e){if(!t)throw ln(e)},ln=function(t){return new Error("Firebase Database ("+$c.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},Ud=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},qs={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,u=s>>2,f=(s&3)<<4|a>>4;let h=(a&15)<<2|c>>6,p=c&63;l||(p=64,o||(h=64)),r.push(n[u],n[f],n[h],n[p])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(Mc(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Ud(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const f=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||f==null)throw new Hd;const h=s<<2|a>>4;if(r.push(h),c!==64){const p=a<<4&240|c>>2;if(r.push(p),f!==64){const d=c<<6&192|f;r.push(d)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Hd extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Lc=function(t){const e=Mc(t);return qs.encodeByteArray(e,!0)},Ar=function(t){return Lc(t).replace(/\./g,"")},ts=function(t){try{return qs.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jd(t){return kc(void 0,t)}function kc(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!Vd(n)||(t[n]=kc(t[n],e[n]));return t}function Vd(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qd(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=()=>qd().__FIREBASE_DEFAULTS__,Gd=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},zd=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ts(t[1]);return e&&JSON.parse(e)},Fc=()=>{try{return Wd()||Gd()||zd()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Kd=t=>{var e,n;return(n=(e=Fc())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Bc=t=>{const e=Kd(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},Uc=()=>{var t;return(t=Fc())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hc(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),a="";return[Ar(JSON.stringify(n)),Ar(JSON.stringify(o)),a].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yd(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jc(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Yd())}function Qd(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Vc(){return $c.NODE_ADMIN===!0}function Xd(){try{return typeof indexedDB=="object"}catch{return!1}}function Jd(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zd="FirebaseError";class cn extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Zd,Object.setPrototypeOf(this,cn.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qc.prototype.create)}}class qc{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?ep(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new cn(i,a,r)}}function ep(t,e){return t.replace(tp,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const tp=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kn(t){return JSON.parse(t)}function ie(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wc=function(t){let e={},n={},r={},i="";try{const s=t.split(".");e=kn(ts(s[0])||""),n=kn(ts(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:i}},np=function(t){const e=Wc(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},rp=function(t){const e=Wc(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Je(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Zt(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function ua(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Pr(t,e,n){const r={};for(const i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}function ns(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(ha(s)&&ha(o)){if(!ns(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function ha(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ip(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sp{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,n){n||(n=0);const r=this.W_;if(typeof e=="string")for(let f=0;f<16;f++)r[f]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(let f=0;f<16;f++)r[f]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(let f=16;f<80;f++){const h=r[f-3]^r[f-8]^r[f-14]^r[f-16];r[f]=(h<<1|h>>>31)&4294967295}let i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4],c,u;for(let f=0;f<80;f++){f<40?f<20?(c=a^s&(o^a),u=1518500249):(c=s^o^a,u=1859775393):f<60?(c=s&o|a&(s|o),u=2400959708):(c=s^o^a,u=3395469782);const h=(i<<5|i>>>27)+c+l+u+r[f]&4294967295;l=a,a=o,o=(s<<30|s>>>2)&4294967295,s=i,i=h}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,n){if(e==null)return;n===void 0&&(n=e.length);const r=n-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<n;){if(o===0)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if(typeof e=="string"){for(;i<n;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<n;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=n}digest(){const e=[];let n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=n&255,n/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function Gc(t,e){return`${t} failed: ${e} argument `}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const op=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,v(r<t.length,"Surrogate pair missing trail surrogate.");const o=t.charCodeAt(r)-56320;i=65536+(s<<10)+o}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},ai=function(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(t){return t&&t._delegate?t._delegate:t}class en{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mt="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ap{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Ws;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e?.identifier),i=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cp(e))try{this.getOrInitializeService({instanceIdentifier:mt})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=mt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mt){return this.instances.has(e)}getOptions(e=mt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:lp(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=mt){return this.component?this.component.multipleInstances?e:mt:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lp(t){return t===mt?void 0:t}function cp(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class up{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new ap(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var j;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(j||(j={}));const hp={debug:j.DEBUG,verbose:j.VERBOSE,info:j.INFO,warn:j.WARN,error:j.ERROR,silent:j.SILENT},fp=j.INFO,dp={[j.DEBUG]:"log",[j.VERBOSE]:"log",[j.INFO]:"info",[j.WARN]:"warn",[j.ERROR]:"error"},pp=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=dp[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class zc{constructor(e){this.name=e,this._logLevel=fp,this._logHandler=pp,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in j))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?hp[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,j.DEBUG,...e),this._logHandler(this,j.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,j.VERBOSE,...e),this._logHandler(this,j.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,j.INFO,...e),this._logHandler(this,j.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,j.WARN,...e),this._logHandler(this,j.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,j.ERROR,...e),this._logHandler(this,j.ERROR,...e)}}const gp=(t,e)=>e.some(n=>t instanceof n);let fa,da;function mp(){return fa||(fa=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _p(){return da||(da=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Kc=new WeakMap,rs=new WeakMap,Yc=new WeakMap,Ri=new WeakMap,Gs=new WeakMap;function yp(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(st(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Kc.set(n,t)}).catch(()=>{}),Gs.set(e,t),e}function vp(t){if(rs.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});rs.set(t,e)}let is={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return rs.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Yc.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return st(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function bp(t){is=t(is)}function wp(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Oi(this),e,...n);return Yc.set(r,e.sort?e.sort():[e]),st(r)}:_p().includes(t)?function(...e){return t.apply(Oi(this),e),st(Kc.get(this))}:function(...e){return st(t.apply(Oi(this),e))}}function Ep(t){return typeof t=="function"?wp(t):(t instanceof IDBTransaction&&vp(t),gp(t,mp())?new Proxy(t,is):t)}function st(t){if(t instanceof IDBRequest)return yp(t);if(Ri.has(t))return Ri.get(t);const e=Ep(t);return e!==t&&(Ri.set(t,e),Gs.set(e,t)),e}const Oi=t=>Gs.get(t);function Cp(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=st(o);return r&&o.addEventListener("upgradeneeded",l=>{r(st(o.result),l.oldVersion,l.newVersion,st(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const Sp=["get","getKey","getAll","getAllKeys","count"],Tp=["put","add","delete","clear"],xi=new Map;function pa(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xi.get(e))return xi.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Tp.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Sp.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return xi.set(e,s),s}bp(t=>({...t,get:(e,n,r)=>pa(e,n)||t.get(e,n,r),has:(e,n)=>!!pa(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ip{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Ap(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Ap(t){const e=t.getComponent();return e?.type==="VERSION"}const ss="@firebase/app",ga="0.9.28";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tt=new zc("@firebase/app"),Pp="@firebase/app-compat",Rp="@firebase/analytics-compat",Op="@firebase/analytics",xp="@firebase/app-check-compat",Np="@firebase/app-check",Dp="@firebase/auth",$p="@firebase/auth-compat",Mp="@firebase/database",Lp="@firebase/database-compat",kp="@firebase/functions",Fp="@firebase/functions-compat",Bp="@firebase/installations",Up="@firebase/installations-compat",Hp="@firebase/messaging",jp="@firebase/messaging-compat",Vp="@firebase/performance",qp="@firebase/performance-compat",Wp="@firebase/remote-config",Gp="@firebase/remote-config-compat",zp="@firebase/storage",Kp="@firebase/storage-compat",Yp="@firebase/firestore",Qp="@firebase/firestore-compat",Xp="firebase",Jp="10.8.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const os="[DEFAULT]",Zp={[ss]:"fire-core",[Pp]:"fire-core-compat",[Op]:"fire-analytics",[Rp]:"fire-analytics-compat",[Np]:"fire-app-check",[xp]:"fire-app-check-compat",[Dp]:"fire-auth",[$p]:"fire-auth-compat",[Mp]:"fire-rtdb",[Lp]:"fire-rtdb-compat",[kp]:"fire-fn",[Fp]:"fire-fn-compat",[Bp]:"fire-iid",[Up]:"fire-iid-compat",[Hp]:"fire-fcm",[jp]:"fire-fcm-compat",[Vp]:"fire-perf",[qp]:"fire-perf-compat",[Wp]:"fire-rc",[Gp]:"fire-rc-compat",[zp]:"fire-gcs",[Kp]:"fire-gcs-compat",[Yp]:"fire-fst",[Qp]:"fire-fst-compat","fire-js":"fire-js",[Xp]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rr=new Map,as=new Map;function eg(t,e){try{t.container.addComponent(e)}catch(n){Tt.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Fn(t){const e=t.name;if(as.has(e))return Tt.debug(`There were multiple attempts to register component ${e}.`),!1;as.set(e,t);for(const n of Rr.values())eg(n,t);return!0}function Qc(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tg={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},ot=new qc("app","Firebase",tg);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new en("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ot.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xc=Jp;function zs(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:os,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ot.create("bad-app-name",{appName:String(i)});if(n||(n=Uc()),!n)throw ot.create("no-options");const s=Rr.get(i);if(s){if(ns(n,s.options)&&ns(r,s.config))return s;throw ot.create("duplicate-app",{appName:i})}const o=new up(i);for(const l of as.values())o.addComponent(l);const a=new ng(n,r,o);return Rr.set(i,a),a}function Jc(t=os){const e=Rr.get(t);if(!e&&t===os&&Uc())return zs();if(!e)throw ot.create("no-app",{appName:t});return e}function at(t,e,n){var r;let i=(r=Zp[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Tt.warn(a.join(" "));return}Fn(new en(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rg="firebase-heartbeat-database",ig=1,Bn="firebase-heartbeat-store";let Ni=null;function Zc(){return Ni||(Ni=Cp(rg,ig,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Bn)}catch(n){console.warn(n)}}}}).catch(t=>{throw ot.create("idb-open",{originalErrorMessage:t.message})})),Ni}async function sg(t){try{const n=(await Zc()).transaction(Bn),r=await n.objectStore(Bn).get(eu(t));return await n.done,r}catch(e){if(e instanceof cn)Tt.warn(e.message);else{const n=ot.create("idb-get",{originalErrorMessage:e?.message});Tt.warn(n.message)}}}async function ma(t,e){try{const r=(await Zc()).transaction(Bn,"readwrite");await r.objectStore(Bn).put(e,eu(t)),await r.done}catch(n){if(n instanceof cn)Tt.warn(n.message);else{const r=ot.create("idb-set",{originalErrorMessage:n?.message});Tt.warn(r.message)}}}function eu(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og=1024,ag=30*24*60*60*1e3;class lg{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new ug(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=_a();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=ag}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=_a(),{heartbeatsToSend:r,unsentEntries:i}=cg(this._heartbeatsCache.heartbeats),s=Ar(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}}function _a(){return new Date().toISOString().substring(0,10)}function cg(t,e=og){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),ya(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ya(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class ug{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Xd()?Jd().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await sg(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return ma(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return ma(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function ya(t){return Ar(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hg(t){Fn(new en("platform-logger",e=>new Ip(e),"PRIVATE")),Fn(new en("heartbeat",e=>new lg(e),"PRIVATE")),at(ss,ga,t),at(ss,ga,"esm2017"),at("fire-js","")}hg("");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tu="firebasestorage.googleapis.com",nu="storageBucket",fg=2*60*1e3,dg=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fe extends cn{constructor(e,n,r=0){super(Di(e),`Firebase Storage: ${n} (${Di(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,fe.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Di(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var he;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(he||(he={}));function Di(t){return"storage/"+t}function ru(){const t="An unknown error occurred, please check the error payload for server response.";return new fe(he.UNKNOWN,t)}function pg(t){return new fe(he.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function gg(t){return new fe(he.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function mg(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new fe(he.UNAUTHENTICATED,t)}function _g(){return new fe(he.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function yg(t){return new fe(he.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function vg(){return new fe(he.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function bg(){return new fe(he.CANCELED,"User canceled the upload/download.")}function wg(t){return new fe(he.INVALID_URL,"Invalid URL '"+t+"'.")}function Eg(t){return new fe(he.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Cg(){return new fe(he.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+nu+"' property when initializing the app?")}function Sg(){return new fe(he.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function ls(t){return new fe(he.INVALID_ARGUMENT,t)}function iu(){return new fe(he.APP_DELETED,"The Firebase app was deleted.")}function Tg(t){return new fe(he.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function bn(t){throw new fe(he.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pe{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Pe.makeFromUrl(e,n)}catch{return new Pe(e,"")}if(r.path==="")return r;throw Eg(e)}static makeFromUrl(e,n){let r=null;const i="([A-Za-z0-9.\\-_]+)";function s(E){E.path.charAt(E.path.length-1)==="/"&&(E.path_=E.path_.slice(0,-1))}const o="(/(.*))?$",a=new RegExp("^gs://"+i+o,"i"),l={bucket:1,path:3};function c(E){E.path_=decodeURIComponent(E.path)}const u="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),h="(/([^?#]*).*)?$",p=new RegExp(`^https?://${f}/${u}/b/${i}/o${h}`,"i"),d={bucket:1,path:3},g=n===tu?"(?:storage.googleapis.com|storage.cloud.google.com)":n,m="([^?#]*)",_=new RegExp(`^https?://${g}/${i}/${m}`,"i"),w=[{regex:a,indices:l,postModify:s},{regex:p,indices:d,postModify:c},{regex:_,indices:{bucket:1,path:2},postModify:c}];for(let E=0;E<w.length;E++){const C=w[E],I=C.regex.exec(e);if(I){const L=I[C.indices.bucket];let R=I[C.indices.path];R||(R=""),r=new Pe(L,R),C.postModify(r);break}}if(r==null)throw wg(e);return r}}class Ig{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ag(t,e,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return a===2}let c=!1;function u(...m){c||(c=!0,e.apply(null,m))}function f(m){i=setTimeout(()=>{i=null,t(p,l())},m)}function h(){s&&clearTimeout(s)}function p(m,..._){if(c){h();return}if(m){h(),u.call(null,m,..._);return}if(l()||o){h(),u.call(null,m,..._);return}r<64&&(r*=2);let w;a===1?(a=2,w=0):w=(r+Math.random())*1e3,f(w)}let d=!1;function g(m){d||(d=!0,h(),!c&&(i!==null?(m||(a=2),clearTimeout(i),f(0)):m||(a=1)))}return f(0),s=setTimeout(()=>{o=!0,g(!0)},n),g}function Pg(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rg(t){return t!==void 0}function Og(t){return typeof t=="object"&&!Array.isArray(t)}function su(t){return typeof t=="string"||t instanceof String}function va(t,e,n,r){if(r<e)throw ls(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw ls(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ks(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function ou(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const i=e(r)+"="+e(t[r]);n=n+i+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wt;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(wt||(wt={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xg(t,e){const n=t>=500&&t<600,i=[408,429].indexOf(t)!==-1,s=e.indexOf(t)!==-1;return n||i||s}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e,n,r,i,s,o,a,l,c,u,f,h=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=i,this.successCodes_=s,this.additionalRetryCodes_=o,this.callback_=a,this.errorCallback_=l,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=f,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((p,d)=>{this.resolve_=p,this.reject_=d,this.start_()})}start_(){const e=(r,i)=>{if(i){r(!1,new fr(!1,null,!0));return}const s=this.connectionFactory_();this.pendingConnection_=s;const o=a=>{const l=a.loaded,c=a.lengthComputable?a.total:-1;this.progressCallback_!==null&&this.progressCallback_(l,c)};this.progressCallback_!==null&&s.addUploadProgressListener(o),s.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&s.removeUploadProgressListener(o),this.pendingConnection_=null;const a=s.getErrorCode()===wt.NO_ERROR,l=s.getStatus();if(!a||xg(l,this.additionalRetryCodes_)&&this.retry){const u=s.getErrorCode()===wt.ABORT;r(!1,new fr(!1,null,u));return}const c=this.successCodes_.indexOf(l)!==-1;r(!0,new fr(c,s))})},n=(r,i)=>{const s=this.resolve_,o=this.reject_,a=i.connection;if(i.wasSuccessCode)try{const l=this.callback_(a,a.getResponse());Rg(l)?s(l):s()}catch(l){o(l)}else if(a!==null){const l=ru();l.serverResponse=a.getErrorText(),this.errorCallback_?o(this.errorCallback_(a,l)):o(l)}else if(i.canceled){const l=this.appDelete_?iu():bg();o(l)}else{const l=vg();o(l)}};this.canceled_?n(!1,new fr(!1,null,!0)):this.backoffId_=Ag(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Pg(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class fr{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Dg(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function $g(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Mg(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Lg(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function kg(t,e,n,r,i,s,o=!0){const a=ou(t.urlParams),l=t.url+a,c=Object.assign({},t.headers);return Mg(c,e),Dg(c,n),$g(c,s),Lg(c,r),new Ng(l,t.method,c,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,i,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function au(t){let e;try{e=JSON.parse(t)}catch{return null}return Og(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Bg(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function lu(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(t,e){return e}class we{constructor(e,n,r,i){this.server=e,this.local=n||e,this.writable=!!r,this.xform=i||Ug}}let dr=null;function Hg(t){return!su(t)||t.length<2?t:lu(t)}function cu(){if(dr)return dr;const t=[];t.push(new we("bucket")),t.push(new we("generation")),t.push(new we("metageneration")),t.push(new we("name","fullPath",!0));function e(s,o){return Hg(o)}const n=new we("name");n.xform=e,t.push(n);function r(s,o){return o!==void 0?Number(o):o}const i=new we("size");return i.xform=r,t.push(i),t.push(new we("timeCreated")),t.push(new we("updated")),t.push(new we("md5Hash",null,!0)),t.push(new we("cacheControl",null,!0)),t.push(new we("contentDisposition",null,!0)),t.push(new we("contentEncoding",null,!0)),t.push(new we("contentLanguage",null,!0)),t.push(new we("contentType",null,!0)),t.push(new we("metadata","customMetadata",!0)),dr=t,dr}function jg(t,e){function n(){const r=t.bucket,i=t.fullPath,s=new Pe(r,i);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function Vg(t,e,n){const r={};r.type="file";const i=n.length;for(let s=0;s<i;s++){const o=n[s];r[o.local]=o.xform(r,e[o.server])}return jg(r,t),r}function uu(t,e,n){const r=au(e);return r===null?null:Vg(t,r,n)}function qg(t,e,n,r){const i=au(e);if(i===null||!su(i.downloadTokens))return null;const s=i.downloadTokens;if(s.length===0)return null;const o=encodeURIComponent;return s.split(",").map(c=>{const u=t.bucket,f=t.fullPath,h="/b/"+o(u)+"/o/"+o(f),p=Ks(h,n,r),d=ou({alt:"media",token:c});return p+d})[0]}class hu{constructor(e,n,r,i){this.url=e,this.method=n,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fu(t){if(!t)throw ru()}function Wg(t,e){function n(r,i){const s=uu(t,i,e);return fu(s!==null),s}return n}function Gg(t,e){function n(r,i){const s=uu(t,i,e);return fu(s!==null),qg(s,i,t.host,t._protocol)}return n}function zg(t){function e(n,r){let i;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?i=_g():i=mg():n.getStatus()===402?i=gg(t.bucket):n.getStatus()===403?i=yg(t.path):i=r,i.status=n.getStatus(),i.serverResponse=r.serverResponse,i}return e}function du(t){const e=zg(t);function n(r,i){let s=e(r,i);return r.getStatus()===404&&(s=pg(t.path)),s.serverResponse=i.serverResponse,s}return n}function Kg(t,e,n){const r=e.fullServerUrl(),i=Ks(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new hu(i,s,Wg(t,n),o);return a.errorHandler=du(e),a}function Yg(t,e,n){const r=e.fullServerUrl(),i=Ks(r,t.host,t._protocol),s="GET",o=t.maxOperationRetryTime,a=new hu(i,s,Gg(t,n),o);return a.errorHandler=du(e),a}class Qg{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=wt.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=wt.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=wt.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,i){if(this.sent_)throw bn("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const s in i)i.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,i[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw bn("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw bn("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw bn("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw bn("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class Xg extends Qg{initXhr(){this.xhr_.responseType="text"}}function pu(){return new Xg}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e,n){this._service=e,n instanceof Pe?this._location=n:this._location=Pe.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new It(e,n)}get root(){const e=new Pe(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return lu(this._location.path)}get storage(){return this._service}get parent(){const e=Fg(this._location.path);if(e===null)return null;const n=new Pe(this._location.bucket,e);return new It(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Tg(e)}}function Jg(t){t._throwIfRoot("getMetadata");const e=Kg(t.storage,t._location,cu());return t.storage.makeRequestWithTokens(e,pu)}function Zg(t){t._throwIfRoot("getDownloadURL");const e=Yg(t.storage,t._location,cu());return t.storage.makeRequestWithTokens(e,pu).then(n=>{if(n===null)throw Sg();return n})}function em(t,e){const n=Bg(t._location.path,e),r=new Pe(t._location.bucket,n);return new It(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(t){return/^[A-Za-z]+:\/\//.test(t)}function nm(t,e){return new It(t,e)}function gu(t,e){if(t instanceof Ys){const n=t;if(n._bucket==null)throw Cg();const r=new It(n,n._bucket);return e!=null?gu(r,e):r}else return e!==void 0?em(t,e):t}function rm(t,e){if(e&&tm(e)){if(t instanceof Ys)return nm(t,e);throw ls("To use ref(service, url), the first argument must be a Storage instance.")}else return gu(t,e)}function ba(t,e){const n=e?.[nu];return n==null?null:Pe.makeFromBucketSpec(n,t)}function im(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:Hc(i,t.app.options.projectId))}class Ys{constructor(e,n,r,i,s){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=tu,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=fg,this._maxUploadRetryTime=dg,this._requests=new Set,i!=null?this._bucket=Pe.makeFromBucketSpec(i,this._host):this._bucket=ba(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Pe.makeFromBucketSpec(this._url,e):this._bucket=ba(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){va("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){va("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new It(this,e)}_makeRequest(e,n,r,i,s=!0){if(this._deleted)return new Ig(iu());{const o=kg(e,this._appId,r,i,n,this._firebaseVersion,s);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,i).getPromise()}}const wa="@firebase/storage",Ea="0.12.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mu="storage";function sm(t){return t=Ze(t),Jg(t)}function li(t){return t=Ze(t),Zg(t)}function Un(t,e){return t=Ze(t),rm(t,e)}function _u(t=Jc(),e){t=Ze(t);const r=Qc(t,mu).getImmediate({identifier:e}),i=Bc("storage");return i&&om(r,...i),r}function om(t,e,n,r={}){im(t,e,n,r)}function am(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("app-check-internal");return new Ys(n,r,i,e,Xc)}function lm(){Fn(new en(mu,am,"PUBLIC").setMultipleInstances(!0)),at(wa,Ea,""),at(wa,Ea,"esm2017")}lm();var cm="firebase",um="10.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */at(cm,um,"app");const Ca="@firebase/database",Sa="1.0.3";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yu="";function hm(t){yu=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ie(n))}get(e){const n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:kn(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return Je(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vu=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){const e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new fm(e)}}catch{}return new dm},bt=vu("localStorage"),cs=vu("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zt=new zc("@firebase/database"),pm=function(){let t=1;return function(){return t++}}(),bu=function(t){const e=op(t),n=new sp;n.update(e);const r=n.digest();return qs.encodeByteArray(r)},Qn=function(...t){let e="";for(let n=0;n<t.length;n++){const r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=Qn.apply(null,r):typeof r=="object"?e+=ie(r):e+=r,e+=" "}return e};let Et=null,Ta=!0;const gm=function(t,e){v(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(zt.logLevel=j.VERBOSE,Et=zt.log.bind(zt),e&&cs.set("logging_enabled",!0)):typeof t=="function"?Et=t:(Et=null,cs.remove("logging_enabled"))},ye=function(...t){if(Ta===!0&&(Ta=!1,Et===null&&cs.get("logging_enabled")===!0&&gm(!0)),Et){const e=Qn.apply(null,t);Et(e)}},Xn=function(t){return function(...e){ye(t,...e)}},us=function(...t){const e="FIREBASE INTERNAL ERROR: "+Qn(...t);zt.error(e)},Xe=function(...t){const e=`FIREBASE FATAL ERROR: ${Qn(...t)}`;throw zt.error(e),new Error(e)},Re=function(...t){const e="FIREBASE WARNING: "+Qn(...t);zt.warn(e)},mm=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&Re("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},wu=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},_m=function(t){if(document.readyState==="complete")t();else{let e=!1;const n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},tn="[MIN_NAME]",At="[MAX_NAME]",un=function(t,e){if(t===e)return 0;if(t===tn||e===At)return-1;if(e===tn||t===At)return 1;{const n=Ia(t),r=Ia(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},ym=function(t,e){return t===e?0:t<e?-1:1},wn=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ie(e))},Qs=function(t){if(typeof t!="object"||t===null)return ie(t);const e=[];for(const r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=ie(e[r]),n+=":",n+=Qs(t[e[r]]);return n+="}",n},Eu=function(t,e){const n=t.length;if(n<=e)return[t];const r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function Ie(t,e){for(const n in t)t.hasOwnProperty(n)&&e(n,t[n])}const Cu=function(t){v(!wu(t),"Invalid JSON number");const e=11,n=52,r=(1<<e-1)-1;let i,s,o,a,l;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));const c=[];for(l=n;l;l-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(l=e;l;l-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();const u=c.join("");let f="";for(l=0;l<64;l+=8){let h=parseInt(u.substr(l,8),2).toString(16);h.length===1&&(h="0"+h),f=f+h}return f.toLowerCase()},vm=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},bm=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function wm(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");const r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}const Em=new RegExp("^-?(0*)\\d{1,10}$"),Cm=-2147483648,Sm=2147483647,Ia=function(t){if(Em.test(t)){const e=Number(t);if(e>=Cm&&e<=Sm)return e}return null},Jn=function(t){try{t()}catch(e){setTimeout(()=>{const n=e.stack||"";throw Re("Exception was thrown by user callback.",n),e},Math.floor(0))}},Tm=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Pn=function(t,e){const n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Im{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Re(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ye("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Re(e)}}class Kt{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}Kt.OWNER="owner";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xs="5",Su="v",Tu="s",Iu="r",Au="f",Pu=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,Ru="ls",Ou="p",hs="ac",xu="websocket",Nu="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Du{constructor(e,n,r,i,s=!1,o="",a=!1,l=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=bt.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&bt.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){const e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}}function Pm(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function $u(t,e,n){v(typeof e=="string","typeof type must == string"),v(typeof n=="object","typeof params must == object");let r;if(e===xu)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===Nu)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);Pm(t)&&(n.ns=t.namespace);const i=[];return Ie(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rm{constructor(){this.counters_={}}incrementCounter(e,n=1){Je(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return jd(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $i={},Mi={};function Js(t){const e=t.toString();return $i[e]||($i[e]=new Rm),$i[e]}function Om(t,e){const n=t.toString();return Mi[n]||(Mi[n]=e()),Mi[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&Jn(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa="start",Nm="close",Dm="pLPCommand",$m="pRTLPCB",Mu="id",Lu="pw",ku="ser",Mm="cb",Lm="seg",km="ts",Fm="d",Bm="dframe",Fu=1870,Bu=30,Um=Fu-Bu,Hm=25e3,jm=3e4;class Wt{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Xn(e),this.stats_=Js(n),this.urlFn=l=>(this.appCheckToken&&(l[hs]=this.appCheckToken),$u(n,Nu,l))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new xm(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(jm)),_m(()=>{if(this.isClosed_)return;this.scriptTagHolder=new Zs((...s)=>{const[o,a,l,c,u]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===Aa)this.id=a,this.password=l;else if(o===Nm)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={};r[Aa]="t",r[ku]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[Mm]=this.scriptTagHolder.uniqueCallbackIdentifier),r[Su]=Xs,this.transportSessionId&&(r[Tu]=this.transportSessionId),this.lastSessionId&&(r[Ru]=this.lastSessionId),this.applicationId&&(r[Ou]=this.applicationId),this.appCheckToken&&(r[hs]=this.appCheckToken),typeof location<"u"&&location.hostname&&Pu.test(location.hostname)&&(r[Iu]=Au);const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Wt.forceAllow_=!0}static forceDisallow(){Wt.forceDisallow_=!0}static isAvailable(){return Wt.forceAllow_?!0:!Wt.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!vm()&&!bm()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const n=ie(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Lc(n),i=Eu(r,Um);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){this.myDisconnFrame=document.createElement("iframe");const r={};r[Bm]="t",r[Mu]=e,r[Lu]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const n=ie(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}}class Zs{constructor(e,n,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=pm(),window[Dm+this.uniqueCallbackIdentifier]=e,window[$m+this.uniqueCallbackIdentifier]=n,this.myIFrame=Zs.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ye("frame writing exception"),a.stack&&ye(a.stack),ye(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ye("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e[Mu]=this.myID,e[Lu]=this.myPW,e[ku]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+Bu+r.length<=Fu;){const o=this.pendingSegs.shift();r=r+"&"+Lm+i+"="+o.seg+"&"+km+i+"="+o.ts+"&"+Fm+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);const r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(Hm)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{ye("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vm=16384,qm=45e3;let Or=null;typeof MozWebSocket<"u"?Or=MozWebSocket:typeof WebSocket<"u"&&(Or=WebSocket);class Le{constructor(e,n,r,i,s,o,a){this.connId=e,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Xn(this.connId),this.stats_=Js(n),this.connURL=Le.connectionURL_(n,o,a,i,r),this.nodeAdmin=n.nodeAdmin}static connectionURL_(e,n,r,i,s){const o={};return o[Su]=Xs,typeof location<"u"&&location.hostname&&Pu.test(location.hostname)&&(o[Iu]=Au),n&&(o[Tu]=n),r&&(o[Ru]=r),i&&(o[hs]=i),s&&(o[Ou]=s),$u(e,xu,o)}open(e,n){this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,bt.set("previous_websocket_failure",!0);try{let r;Vc(),this.mySock=new Or(this.connURL,[],r)}catch(r){this.log_("Error instantiating WebSocket.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=r=>{this.handleIncomingFrame(r)},this.mySock.onerror=r=>{this.log_("WebSocket error.  Closing connection.");const i=r.message||r.data;i&&this.log_(i),this.onClosed_()}}start(){}static forceDisallow(){Le.forceDisallow_=!0}static isAvailable(){let e=!1;if(typeof navigator<"u"&&navigator.userAgent){const n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Or!==null&&!Le.forceDisallow_}static previouslyFailed(){return bt.isInMemoryStorage||bt.get("previous_websocket_failure")===!0}markConnectionHealthy(){bt.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){const n=this.frames.join("");this.frames=null;const r=kn(n);this.onMessage(r)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if(v(this.frames===null,"We already have a frame buffer"),e.length<=6){const n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(this.mySock===null)return;const n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{const r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}send(e){this.resetKeepAlive();const n=ie(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);const r=Eu(n,Vm);r.length>1&&this.sendString_(String(r.length));for(let i=0;i<r.length;i++)this.sendString_(r[i])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(qm))}sendString_(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}Le.responsesRequiredToBeHealthy=2;Le.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[Wt,Le]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){const n=Le&&Le.isAvailable();let r=n&&!Le.previouslyFailed();if(e.webSocketOnly&&(n||Re("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[Le];else{const i=this.transports_=[];for(const s of Hn.ALL_TRANSPORTS)s&&s.isAvailable()&&i.push(s);Hn.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}Hn.globalTransportInitialized_=!1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wm=6e4,Gm=5e3,zm=10*1024,Km=100*1024,Li="t",Pa="d",Ym="s",Ra="r",Qm="e",Oa="o",xa="a",Na="n",Da="p",Xm="h";class Jm{constructor(e,n,r,i,s,o,a,l,c,u){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=c,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Xn("c:"+this.id+":"),this.transportManager_=new Hn(n),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Pn(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>Km?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>zm?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){const n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(Li in e){const n=e[Li];n===xa?this.upgradeIfSecondaryHealthy_():n===Ra?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===Oa&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const n=wn("t",e),r=wn("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:Da,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:xa,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:Na,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const n=wn("t",e),r=wn("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const n=wn(Li,e);if(Pa in e){const r=e[Pa];if(n===Xm){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===Na){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===Ym?this.onConnectionShutdown_(r):n===Ra?this.onReset_(r):n===Qm?us("Server Error: "+r):n===Oa?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):us("Unknown control packet command: "+n)}}onHandshake_(e){const n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Xs!==r&&Re("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Pn(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(Wm))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Pn(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(Gm))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:Da,d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(bt.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uu{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hu{constructor(e){this.allowedEvents_=e,this.listeners_={},v(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});const i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){v(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr extends Hu{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!jc()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new xr}getInitialEvent(e){return v(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $a=32,Ma=768;class U{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}}function k(){return new U("")}function $(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function ut(t){return t.pieces_.length-t.pieceNum_}function V(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new U(t.pieces_,e)}function ju(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function Zm(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function Vu(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function qu(t){if(t.pieceNum_>=t.pieces_.length)return null;const e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new U(e,0)}function se(t,e){const n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof U)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new U(n,0)}function x(t){return t.pieceNum_>=t.pieces_.length}function Ee(t,e){const n=$(t),r=$(e);if(n===null)return e;if(n===r)return Ee(V(t),V(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function Wu(t,e){if(ut(t)!==ut(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function ke(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(ut(t)>ut(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}class e_{constructor(e,n){this.errorPrefix_=n,this.parts_=Vu(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=ai(this.parts_[r]);Gu(this)}}function t_(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=ai(e),Gu(t)}function n_(t){const e=t.parts_.pop();t.byteLength_-=ai(e),t.parts_.length>0&&(t.byteLength_-=1)}function Gu(t){if(t.byteLength_>Ma)throw new Error(t.errorPrefix_+"has a key path longer than "+Ma+" bytes ("+t.byteLength_+").");if(t.parts_.length>$a)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+$a+") or object contains a cycle "+_t(t))}function _t(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo extends Hu{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new eo}getInitialEvent(e){return v(e==="visible","Unknown event type: "+e),[this.visible_]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En=1e3,r_=60*5*1e3,La=30*1e3,i_=1.3,s_=3e4,o_="server_kill",ka=3;class Qe extends Uu{constructor(e,n,r,i,s,o,a,l){if(super(),this.repoInfo_=e,this.applicationId_=n,this.onDataUpdate_=r,this.onConnectStatus_=i,this.onServerInfoUpdate_=s,this.authTokenProvider_=o,this.appCheckTokenProvider_=a,this.authOverride_=l,this.id=Qe.nextPersistentConnectionId_++,this.log_=Xn("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=En,this.maxReconnectDelay_=r_,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,l&&!Vc())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");eo.getInstance().on("visible",this.onVisible_,this),e.host.indexOf("fblocal")===-1&&xr.getInstance().on("online",this.onOnline_,this)}sendRequest(e,n,r){const i=++this.requestNumber_,s={r:i,a:e,b:n};this.log_(ie(s)),v(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(s),r&&(this.requestCBHash_[i]=r)}get(e){this.initConnection_();const n=new Ws,i={action:"g",request:{p:e._path.toString(),q:e._queryObject},onComplete:o=>{const a=o.d;o.s==="ok"?n.resolve(a):n.reject(a)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;const s=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(s),n.promise}listen(e,n,r,i){this.initConnection_();const s=e._queryIdentifier,o=e._path.toString();this.log_("Listen called for "+o+" "+s),this.listens.has(o)||this.listens.set(o,new Map),v(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),v(!this.listens.get(o).has(s),"listen() called twice for same path/queryId.");const a={onComplete:i,hashFn:n,query:e,tag:r};this.listens.get(o).set(s,a),this.connected_&&this.sendListen_(a)}sendGet_(e){const n=this.outstandingGets_[e];this.sendRequest("g",n.request,r=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),n.onComplete&&n.onComplete(r)})}sendListen_(e){const n=e.query,r=n._path.toString(),i=n._queryIdentifier;this.log_("Listen on "+r+" for "+i);const s={p:r},o="q";e.tag&&(s.q=n._queryObject,s.t=e.tag),s.h=e.hashFn(),this.sendRequest(o,s,a=>{const l=a.d,c=a.s;Qe.warnOnListenWarnings_(l,n),(this.listens.get(r)&&this.listens.get(r).get(i))===e&&(this.log_("listen response",a),c!=="ok"&&this.removeListen_(r,i),e.onComplete&&e.onComplete(c,l))})}static warnOnListenWarnings_(e,n){if(e&&typeof e=="object"&&Je(e,"w")){const r=Zt(e,"w");if(Array.isArray(r)&&~r.indexOf("no_index")){const i='".indexOn": "'+n._queryParams.getIndex().toString()+'"',s=n._path.toString();Re(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${i} at ${s} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){(e&&e.length===40||rp(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=La)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const e=this.authToken_,n=np(e)?"auth":"gauth",r={cred:e};this.authOverride_===null?r.noauth=!0:typeof this.authOverride_=="object"&&(r.authvar=this.authOverride_),this.sendRequest(n,r,i=>{const s=i.s,o=i.d||"error";this.authToken_===e&&(s==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(s,o))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{const n=e.s,r=e.d||"error";n==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(n,r)})}unlisten(e,n){const r=e._path.toString(),i=e._queryIdentifier;this.log_("Unlisten called for "+r+" "+i),v(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(r,i)&&this.connected_&&this.sendUnlisten_(r,i,e._queryObject,n)}sendUnlisten_(e,n,r,i){this.log_("Unlisten on "+e+" for "+n);const s={p:e},o="n";i&&(s.q=r,s.t=i),this.sendRequest(o,s)}onDisconnectPut(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:n,onComplete:r})}onDisconnectMerge(e,n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,n,r):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:n,onComplete:r})}onDisconnectCancel(e,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:n})}sendOnDisconnect_(e,n,r,i){const s={p:n,d:r};this.log_("onDisconnect "+e,s),this.sendRequest(e,s,o=>{i&&setTimeout(()=>{i(o.s,o.d)},Math.floor(0))})}put(e,n,r,i){this.putInternal("p",e,n,r,i)}merge(e,n,r,i){this.putInternal("m",e,n,r,i)}putInternal(e,n,r,i,s){this.initConnection_();const o={p:n,d:r};s!==void 0&&(o.h=s),this.outstandingPuts_.push({action:e,request:o,onComplete:i}),this.outstandingPutCount_++;const a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+n)}sendPut_(e){const n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,s=>{this.log_(n+" response",s),delete this.outstandingPuts_[e],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),i&&i(s.s,s.d)})}reportStats(e){if(this.connected_){const n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,r=>{if(r.s!=="ok"){const s=r.d;this.log_("reportStats","Error sending stats: "+s)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+ie(e));const n=e.r,r=this.requestCBHash_[n];r&&(delete this.requestCBHash_[n],r(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}}onDataPush_(e,n){this.log_("handleServerMessage",e,n),e==="d"?this.onDataUpdate_(n.p,n.d,!1,n.t):e==="m"?this.onDataUpdate_(n.p,n.d,!0,n.t):e==="c"?this.onListenRevoked_(n.p,n.q):e==="ac"?this.onAuthRevoked_(n.s,n.d):e==="apc"?this.onAppCheckRevoked_(n.s,n.d):e==="sd"?this.onSecurityDebugPacket_(n):us("Unrecognized action received from server: "+ie(e)+`
Are you using the latest client?`)}onReady_(e,n){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=n,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){v(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=En,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=En,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>s_&&(this.reconnectDelay_=En),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());const e=new Date().getTime()-this.lastConnectionAttemptTime_;let n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*i_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;const e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+Qe.nextConnectionId_++,s=this.lastSessionId;let o=!1,a=null;const l=function(){a?a.close():(o=!0,r())},c=function(f){v(a,"sendRequest call when we're not connected not allowed."),a.sendRequest(f)};this.realtime_={close:l,sendRequest:c};const u=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{const[f,h]=await Promise.all([this.authTokenProvider_.getToken(u),this.appCheckTokenProvider_.getToken(u)]);o?ye("getToken() completed but was canceled"):(ye("getToken() completed. Creating connection."),this.authToken_=f&&f.accessToken,this.appCheckToken_=h&&h.token,a=new Jm(i,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,n,r,p=>{Re(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(o_)},s))}catch(f){this.log_("Failed to get token: "+f),o||(this.repoInfo_.nodeAdmin&&Re(f),l())}}}interrupt(e){ye("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ye("Resuming connection for reason: "+e),delete this.interruptReasons_[e],ua(this.interruptReasons_)&&(this.reconnectDelay_=En,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){const n=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:n})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){const n=this.outstandingPuts_[e];n&&"h"in n.request&&n.queued&&(n.onComplete&&n.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(e,n){let r;n?r=n.map(s=>Qs(s)).join("$"):r="default";const i=this.removeListen_(e,r);i&&i.onComplete&&i.onComplete("permission_denied")}removeListen_(e,n){const r=new U(e).toString();let i;if(this.listens.has(r)){const s=this.listens.get(r);i=s.get(n),s.delete(n),s.size===0&&this.listens.delete(r)}else i=void 0;return i}onAuthRevoked_(e,n){ye("Auth token revoked: "+e+"/"+n),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(e==="invalid_token"||e==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=ka&&(this.reconnectDelay_=La,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,n){ye("App check token revoked: "+e+"/"+n),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(e==="invalid_token"||e==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=ka&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const e of this.listens.values())for(const n of e.values())this.sendListen_(n);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){const e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){const e={};let n="js";e["sdk."+n+"."+yu.replace(/\./g,"-")]=1,jc()?e["framework.cordova"]=1:Qd()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){const e=xr.getInstance().currentlyOnline();return ua(this.interruptReasons_)&&e}}Qe.nextPersistentConnectionId_=0;Qe.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new O(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){const r=new O(tn,e),i=new O(tn,n);return this.compare(r,i)!==0}minPost(){return O.MIN}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pr;class zu extends ci{static get __EMPTY_NODE(){return pr}static set __EMPTY_NODE(e){pr=e}compare(e,n){return un(e.name,n.name)}isDefinedOn(e){throw ln("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return O.MIN}maxPost(){return new O(At,pr)}makePost(e,n){return v(typeof e=="string","KeyIndex indexValue must always be a string."),new O(e,pr)}toString(){return".key"}}const Yt=new zu;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gr{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class ce{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??ce.RED,this.left=i??Se.EMPTY_NODE,this.right=s??Se.EMPTY_NODE}copy(e,n,r,i,s){return new ce(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return s<0?i=i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i=i.copy(null,n,null,null,null):i=i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp_()}removeMin_(){if(this.left.isEmpty())return Se.EMPTY_NODE;let e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()}remove(e,n){let r,i;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return Se.EMPTY_NODE;i=r.right.min_(),r=r.copy(i.key,i.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e}rotateLeft_(){const e=this.copy(null,null,ce.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){const e=this.copy(null,null,ce.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth_(){const e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)}}ce.RED=!0;ce.BLACK=!1;class a_{copy(e,n,r,i,s){return this}insert(e,n,r){return new ce(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}}class Se{constructor(e,n=Se.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new Se(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,ce.BLACK,null,null))}remove(e){return new Se(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,ce.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new gr(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new gr(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new gr(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new gr(this.root_,null,this.comparator_,!0,e)}}Se.EMPTY_NODE=new a_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l_(t,e){return un(t.name,e.name)}function to(t,e){return un(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fs;function c_(t){fs=t}const Ku=function(t){return typeof t=="number"?"number:"+Cu(t):"string:"+t},Yu=function(t){if(t.isLeafNode()){const e=t.val();v(typeof e=="string"||typeof e=="number"||typeof e=="object"&&Je(e,".sv"),"Priority must be a string or number.")}else v(t===fs||t.isEmpty(),"priority of unexpected type.");v(t===fs||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fa;class le{constructor(e,n=le.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=n,this.lazyHash_=null,v(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),Yu(this.priorityNode_)}static set __childrenNodeConstructor(e){Fa=e}static get __childrenNodeConstructor(){return Fa}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new le(this.value_,e)}getImmediateChild(e){return e===".priority"?this.priorityNode_:le.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return x(e)?this:$(e)===".priority"?this.priorityNode_:le.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,n){return null}updateImmediateChild(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:le.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)}updateChild(e,n){const r=$(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(v(r!==".priority"||ut(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,le.__childrenNodeConstructor.EMPTY_NODE.updateChild(V(e),n)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,n){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ku(this.priorityNode_.val())+":");const n=typeof this.value_;e+=n+":",n==="number"?e+=Cu(this.value_):e+=this.value_,this.lazyHash_=bu(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===le.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof le.__childrenNodeConstructor?-1:(v(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){const n=typeof e.value_,r=typeof this.value_,i=le.VALUE_TYPE_ORDER.indexOf(n),s=le.VALUE_TYPE_ORDER.indexOf(r);return v(i>=0,"Unknown leaf type: "+n),v(s>=0,"Unknown leaf type: "+r),i===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-i}withIndex(){return this}isIndexed(){return!0}equals(e){if(e===this)return!0;if(e.isLeafNode()){const n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1}}le.VALUE_TYPE_ORDER=["object","boolean","number","string"];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qu,Xu;function u_(t){Qu=t}function h_(t){Xu=t}class f_ extends ci{compare(e,n){const r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?un(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return O.MIN}maxPost(){return new O(At,new le("[PRIORITY-POST]",Xu))}makePost(e,n){const r=Qu(e);return new O(n,new le("[PRIORITY-POST]",r))}toString(){return".priority"}}const Z=new f_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_=Math.log(2);class p_{constructor(e){const n=s=>parseInt(Math.log(s)/d_,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;const i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const Nr=function(t,e,n,r){t.sort(e);const i=function(l,c){const u=c-l;let f,h;if(u===0)return null;if(u===1)return f=t[l],h=n?n(f):f,new ce(h,f.node,ce.BLACK,null,null);{const p=parseInt(u/2,10)+l,d=i(l,p),g=i(p+1,c);return f=t[p],h=n?n(f):f,new ce(h,f.node,ce.BLACK,d,g)}},s=function(l){let c=null,u=null,f=t.length;const h=function(d,g){const m=f-d,_=f;f-=d;const y=i(m+1,_),w=t[m],E=n?n(w):w;p(new ce(E,w.node,g,null,y))},p=function(d){c?(c.left=d,c=d):(u=d,c=d)};for(let d=0;d<l.count;++d){const g=l.nextBitIsOne(),m=Math.pow(2,l.count-(d+1));g?h(m,ce.BLACK):(h(m,ce.BLACK),h(m,ce.RED))}return u},o=new p_(t.length),a=s(o);return new Se(r||e,a)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ki;const kt={};class Ye{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return v(kt&&Z,"ChildrenNode.ts has not been loaded"),ki=ki||new Ye({".priority":kt},{".priority":Z}),ki}get(e){const n=Zt(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Se?n:null}hasIndex(e){return Je(this.indexSet_,e.toString())}addIndex(e,n){v(e!==Yt,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=n.getIterator(O.Wrap);let o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Nr(r,e.getCompare()):a=kt;const l=e.toString(),c=Object.assign({},this.indexSet_);c[l]=e;const u=Object.assign({},this.indexes_);return u[l]=a,new Ye(u,c)}addToIndexes(e,n){const r=Pr(this.indexes_,(i,s)=>{const o=Zt(this.indexSet_,s);if(v(o,"Missing index implementation for "+s),i===kt)if(o.isDefinedOn(e.node)){const a=[],l=n.getIterator(O.Wrap);let c=l.getNext();for(;c;)c.name!==e.name&&a.push(c),c=l.getNext();return a.push(e),Nr(a,o.getCompare())}else return kt;else{const a=n.get(e.name);let l=i;return a&&(l=l.remove(new O(e.name,a))),l.insert(e,e.node)}});return new Ye(r,this.indexSet_)}removeFromIndexes(e,n){const r=Pr(this.indexes_,i=>{if(i===kt)return i;{const s=n.get(e.name);return s?i.remove(new O(e.name,s)):i}});return new Ye(r,this.indexSet_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cn;class T{constructor(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&Yu(this.priorityNode_),this.children_.isEmpty()&&v(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Cn||(Cn=new T(new Se(to),null,Ye.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Cn}updatePriority(e){return this.children_.isEmpty()?this:new T(this.children_,e,this.indexMap_)}getImmediateChild(e){if(e===".priority")return this.getPriority();{const n=this.children_.get(e);return n===null?Cn:n}}getChild(e){const n=$(e);return n===null?this:this.getImmediateChild(n).getChild(V(e))}hasChild(e){return this.children_.get(e)!==null}updateImmediateChild(e,n){if(v(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);{const r=new O(e,n);let i,s;n.isEmpty()?(i=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));const o=i.isEmpty()?Cn:this.priorityNode_;return new T(i,o,s)}}updateChild(e,n){const r=$(e);if(r===null)return n;{v($(e)!==".priority"||ut(e)===1,".priority must be the last token in a path");const i=this.getImmediateChild(r).updateChild(V(e),n);return this.updateImmediateChild(r,i)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;const n={};let r=0,i=0,s=!0;if(this.forEachChild(Z,(o,a)=>{n[o]=a.val(e),r++,s&&T.INTEGER_REGEXP_.test(o)?i=Math.max(i,Number(o)):s=!1}),!e&&s&&i<2*r){const o=[];for(const a in n)o[a]=n[a];return o}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n}hash(){if(this.lazyHash_===null){let e="";this.getPriority().isEmpty()||(e+="priority:"+Ku(this.getPriority().val())+":"),this.forEachChild(Z,(n,r)=>{const i=r.hash();i!==""&&(e+=":"+n+":"+i)}),this.lazyHash_=e===""?"":bu(e)}return this.lazyHash_}getPredecessorChildName(e,n,r){const i=this.resolveIndex_(r);if(i){const s=i.getPredecessorKey(new O(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)}getFirstChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.minKey();return r&&r.name}else return this.children_.minKey()}getFirstChild(e){const n=this.getFirstChildName(e);return n?new O(n,this.children_.get(n)):null}getLastChildName(e){const n=this.resolveIndex_(e);if(n){const r=n.maxKey();return r&&r.name}else return this.children_.maxKey()}getLastChild(e){const n=this.getLastChildName(e);return n?new O(n,this.children_.get(n)):null}forEachChild(e,n){const r=this.resolveIndex_(e);return r?r.inorderTraversal(i=>n(i.name,i.node)):this.children_.inorderTraversal(n)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,i=>i);{const i=this.children_.getIteratorFrom(e.name,O.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)<0;)i.getNext(),s=i.peek();return i}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,n){const r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,i=>i);{const i=this.children_.getReverseIteratorFrom(e.name,O.Wrap);let s=i.peek();for(;s!=null&&n.compare(s,e)>0;)i.getNext(),s=i.peek();return i}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Zn?-1:0}withIndex(e){if(e===Yt||this.indexMap_.hasIndex(e))return this;{const n=this.indexMap_.addIndex(e,this.children_);return new T(this.children_,this.priorityNode_,n)}}isIndexed(e){return e===Yt||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode())return!1;{const n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){const r=this.getIterator(Z),i=n.getIterator(Z);let s=r.getNext(),o=i.getNext();for(;s&&o;){if(s.name!==o.name||!s.node.equals(o.node))return!1;s=r.getNext(),o=i.getNext()}return s===null&&o===null}else return!1;else return!1}}resolveIndex_(e){return e===Yt?null:this.indexMap_.get(e.toString())}}T.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;class g_ extends T{constructor(){super(new Se(to),T.EMPTY_NODE,Ye.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return T.EMPTY_NODE}isEmpty(){return!1}}const Zn=new g_;Object.defineProperties(O,{MIN:{value:new O(tn,T.EMPTY_NODE)},MAX:{value:new O(At,Zn)}});zu.__EMPTY_NODE=T.EMPTY_NODE;le.__childrenNodeConstructor=T;c_(Zn);h_(Zn);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_=!0;function ge(t,e=null){if(t===null)return T.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),v(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){const n=t;return new le(n,ge(e))}if(!(t instanceof Array)&&m_){const n=[];let r=!1;if(Ie(t,(o,a)=>{if(o.substring(0,1)!=="."){const l=ge(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),n.push(new O(o,l)))}}),n.length===0)return T.EMPTY_NODE;const s=Nr(n,l_,o=>o.name,to);if(r){const o=Nr(n,Z.getCompare());return new T(s,ge(e),new Ye({".priority":o},{".priority":Z}))}else return new T(s,ge(e),Ye.Default)}else{let n=T.EMPTY_NODE;return Ie(t,(r,i)=>{if(Je(t,r)&&r.substring(0,1)!=="."){const s=ge(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(ge(e))}}u_(ge);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class __ extends ci{constructor(e){super(),this.indexPath_=e,v(!x(e)&&$(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){const r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?un(e.name,n.name):s}makePost(e,n){const r=ge(e),i=T.EMPTY_NODE.updateChild(this.indexPath_,r);return new O(n,i)}maxPost(){const e=T.EMPTY_NODE.updateChild(this.indexPath_,Zn);return new O(At,e)}toString(){return Vu(this.indexPath_,0).join("/")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_ extends ci{compare(e,n){const r=e.node.compareTo(n.node);return r===0?un(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return O.MIN}maxPost(){return O.MAX}makePost(e,n){const r=ge(e);return new O(n,r)}toString(){return".value"}}const v_=new y_;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ju(t){return{type:"value",snapshotNode:t}}function nn(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function jn(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Vn(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function b_(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){v(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(jn(n,a)):v(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(nn(n,r)):o.trackChildChange(Vn(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Z,(i,s)=>{n.hasChild(i)||r.trackChildChange(jn(i,s))}),n.isLeafNode()||n.forEachChild(Z,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Vn(i,s,o))}else r.trackChildChange(nn(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?T.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.indexedFilter_=new no(e.getIndex()),this.index_=e.getIndex(),this.startPost_=qn.getStartPost_(e),this.endPost_=qn.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new O(n,r))||(r=T.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=T.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(T.EMPTY_NODE);const s=this;return n.forEachChild(Z,(o,a)=>{s.matches(new O(o,a))||(i=i.updateImmediateChild(o,T.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w_{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{const r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new qn(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new O(n,r))||(r=T.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=T.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=T.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(T.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,T.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){const f=this.index_.getCompare();o=(h,p)=>f(p,h)}else o=this.index_.getCompare();const a=e;v(a.numChildren()===this.limit_,"");const l=new O(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),u=this.rangedFilter_.matches(l);if(a.hasChild(n)){const f=a.getImmediateChild(n);let h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);const p=h==null?1:o(h,l);if(u&&!r.isEmpty()&&p>=0)return s?.trackChildChange(Vn(n,r,f)),a.updateImmediateChild(n,r);{s?.trackChildChange(jn(n,f));const g=a.updateImmediateChild(n,T.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(nn(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:u&&o(c,l)>=0?(s!=null&&(s.trackChildChange(jn(c.name,c.node)),s.trackChildChange(nn(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,T.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Z}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return v(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return v(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:tn}hasEnd(){return this.endSet_}getIndexEndValue(){return v(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return v(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:At}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return v(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Z}copy(){const e=new ro;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function E_(t){return t.loadsAllData()?new no(t.getIndex()):t.hasLimit()?new w_(t):new qn(t)}function Ba(t){const e={};if(t.isDefault())return e;let n;if(t.index_===Z?n="$priority":t.index_===v_?n="$value":t.index_===Yt?n="$key":(v(t.index_ instanceof __,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ie(n),t.startSet_){const r=t.startAfterSet_?"startAfter":"startAt";e[r]=ie(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+ie(t.indexStartName_))}if(t.endSet_){const r=t.endBeforeSet_?"endBefore":"endAt";e[r]=ie(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+ie(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function Ua(t){const e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Z&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr extends Uu{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=Xn("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(v(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=Dr.getListenId_(e,r),a={};this.listens_[o]=a;const l=Ba(e._queryParams);this.restRequest_(s+".json",l,(c,u)=>{let f=u;if(c===404&&(f=null,c=null),c===null&&this.onDataUpdate_(s,f,!1,r),Zt(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){const r=Dr.getListenId_(e,n);delete this.listens_[r]}get(e){const n=Ba(e._queryParams),r=e._path.toString(),i=new Ws;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+ip(n);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=kn(a.responseText)}catch{Re("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else a.status!==401&&a.status!==404&&Re("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C_{constructor(){this.rootNode_=T.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $r(){return{value:null,children:new Map}}function Zu(t,e,n){if(x(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{const r=$(e);t.children.has(r)||t.children.set(r,$r());const i=t.children.get(r);e=V(e),Zu(i,e,n)}}function ds(t,e,n){t.value!==null?n(e,t.value):S_(t,(r,i)=>{const s=new U(e.toString()+"/"+r);ds(i,s,n)})}function S_(t,e){t.children.forEach((n,r)=>{e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T_{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),n=Object.assign({},e);return this.last_&&Ie(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ha=10*1e3,I_=30*1e3,A_=5*60*1e3;class P_{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new T_(e);const r=Ha+(I_-Ha)*Math.random();Pn(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),n={};let r=!1;Ie(e,(i,s)=>{s>0&&Je(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Pn(this.reportStats_.bind(this),Math.floor(Math.random()*2*A_))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fe;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(Fe||(Fe={}));function eh(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function io(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function so(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=Fe.ACK_USER_WRITE,this.source=eh()}operationForChild(e){if(x(this.path)){if(this.affectedTree.value!=null)return v(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const n=this.affectedTree.subtree(new U(e));return new Mr(k(),n,this.revert)}}else return v($(this.path)===e,"operationForChild called for unrelated child."),new Mr(V(this.path),this.affectedTree,this.revert)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wn{constructor(e,n){this.source=e,this.path=n,this.type=Fe.LISTEN_COMPLETE}operationForChild(e){return x(this.path)?new Wn(this.source,k()):new Wn(this.source,V(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pt{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=Fe.OVERWRITE}operationForChild(e){return x(this.path)?new Pt(this.source,k(),this.snap.getImmediateChild(e)):new Pt(this.source,V(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=Fe.MERGE}operationForChild(e){if(x(this.path)){const n=this.children.subtree(new U(e));return n.isEmpty()?null:n.value?new Pt(this.source,k(),n.value):new Gn(this.source,k(),n)}else return v($(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Gn(this.source,V(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(x(e))return this.isFullyInitialized()&&!this.filtered_;const n=$(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function O_(t,e,n,r){const i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(b_(o.childName,o.snapshotNode))}),Sn(t,i,"child_removed",e,r,n),Sn(t,i,"child_added",e,r,n),Sn(t,i,"child_moved",s,r,n),Sn(t,i,"child_changed",e,r,n),Sn(t,i,"value",e,r,n),i}function Sn(t,e,n,r,i,s){const o=r.filter(a=>a.type===n);o.sort((a,l)=>N_(t,a,l)),o.forEach(a=>{const l=x_(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(l,t.query_))})})}function x_(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function N_(t,e,n){if(e.childName==null||n.childName==null)throw ln("Should only compare child_ events.");const r=new O(e.childName,e.snapshotNode),i=new O(n.childName,n.snapshotNode);return t.index_.compare(r,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ui(t,e){return{eventCache:t,serverCache:e}}function Rn(t,e,n,r){return ui(new ht(e,n,r),t.serverCache)}function th(t,e,n,r){return ui(t.eventCache,new ht(e,n,r))}function Lr(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function Rt(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fi;const D_=()=>(Fi||(Fi=new Se(ym)),Fi);class G{constructor(e,n=D_()){this.value=e,this.children=n}static fromObject(e){let n=new G(null);return Ie(e,(r,i)=>{n=n.set(new U(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:k(),value:this.value};if(x(e))return null;{const r=$(e),i=this.children.get(r);if(i!==null){const s=i.findRootMostMatchingPathAndValue(V(e),n);return s!=null?{path:se(new U(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(x(e))return this;{const n=$(e),r=this.children.get(n);return r!==null?r.subtree(V(e)):new G(null)}}set(e,n){if(x(e))return new G(n,this.children);{const r=$(e),s=(this.children.get(r)||new G(null)).set(V(e),n),o=this.children.insert(r,s);return new G(this.value,o)}}remove(e){if(x(e))return this.children.isEmpty()?new G(null):new G(null,this.children);{const n=$(e),r=this.children.get(n);if(r){const i=r.remove(V(e));let s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new G(null):new G(this.value,s)}else return this}}get(e){if(x(e))return this.value;{const n=$(e),r=this.children.get(n);return r?r.get(V(e)):null}}setTree(e,n){if(x(e))return n;{const r=$(e),s=(this.children.get(r)||new G(null)).setTree(V(e),n);let o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new G(this.value,o)}}fold(e){return this.fold_(k(),e)}fold_(e,n){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(se(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,k(),n)}findOnPath_(e,n,r){const i=this.value?r(n,this.value):!1;if(i)return i;if(x(e))return null;{const s=$(e),o=this.children.get(s);return o?o.findOnPath_(V(e),se(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,k(),n)}foreachOnPath_(e,n,r){if(x(e))return this;{this.value&&r(n,this.value);const i=$(e),s=this.children.get(i);return s?s.foreachOnPath_(V(e),se(n,i),r):new G(null)}}foreach(e){this.foreach_(k(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(se(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Be{constructor(e){this.writeTree_=e}static empty(){return new Be(new G(null))}}function On(t,e,n){if(x(e))return new Be(new G(n));{const r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){const i=r.path;let s=r.value;const o=Ee(i,e);return s=s.updateChild(o,n),new Be(t.writeTree_.set(i,s))}else{const i=new G(n),s=t.writeTree_.setTree(e,i);return new Be(s)}}}function ja(t,e,n){let r=t;return Ie(n,(i,s)=>{r=On(r,se(e,i),s)}),r}function Va(t,e){if(x(e))return Be.empty();{const n=t.writeTree_.setTree(e,new G(null));return new Be(n)}}function ps(t,e){return Ot(t,e)!=null}function Ot(t,e){const n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ee(n.path,e)):null}function qa(t){const e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Z,(r,i)=>{e.push(new O(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new O(r,i.value))}),e}function lt(t,e){if(x(e))return t;{const n=Ot(t,e);return n!=null?new Be(new G(n)):new Be(t.writeTree_.subtree(e))}}function gs(t){return t.writeTree_.isEmpty()}function rn(t,e){return nh(k(),t.writeTree_,e)}function nh(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(v(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=nh(se(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(se(t,".priority"),r)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hi(t,e){return oh(e,t)}function $_(t,e,n,r,i){v(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=On(t.visibleWrites,e,n)),t.lastWriteId=r}function M_(t,e){for(let n=0;n<t.allWrites.length;n++){const r=t.allWrites[n];if(r.writeId===e)return r}return null}function L_(t,e){const n=t.allWrites.findIndex(a=>a.writeId===e);v(n>=0,"removeWrite called with nonexistent writeId.");const r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){const a=t.allWrites[o];a.visible&&(o>=n&&k_(a,r.path)?i=!1:ke(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return F_(t),!0;if(r.snap)t.visibleWrites=Va(t.visibleWrites,r.path);else{const a=r.children;Ie(a,l=>{t.visibleWrites=Va(t.visibleWrites,se(r.path,l))})}return!0}else return!1}function k_(t,e){if(t.snap)return ke(t.path,e);for(const n in t.children)if(t.children.hasOwnProperty(n)&&ke(se(t.path,n),e))return!0;return!1}function F_(t){t.visibleWrites=rh(t.allWrites,B_,k()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function B_(t){return t.visible}function rh(t,e,n){let r=Be.empty();for(let i=0;i<t.length;++i){const s=t[i];if(e(s)){const o=s.path;let a;if(s.snap)ke(n,o)?(a=Ee(n,o),r=On(r,a,s.snap)):ke(o,n)&&(a=Ee(o,n),r=On(r,k(),s.snap.getChild(a)));else if(s.children){if(ke(n,o))a=Ee(n,o),r=ja(r,a,s.children);else if(ke(o,n))if(a=Ee(o,n),x(a))r=ja(r,k(),s.children);else{const l=Zt(s.children,$(a));if(l){const c=l.getChild(V(a));r=On(r,k(),c)}}}else throw ln("WriteRecord should have .snap or .children")}}return r}function ih(t,e,n,r,i){if(!r&&!i){const s=Ot(t.visibleWrites,e);if(s!=null)return s;{const o=lt(t.visibleWrites,e);if(gs(o))return n;if(n==null&&!ps(o,k()))return null;{const a=n||T.EMPTY_NODE;return rn(o,a)}}}else{const s=lt(t.visibleWrites,e);if(!i&&gs(s))return n;if(!i&&n==null&&!ps(s,k()))return null;{const o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(ke(c.path,e)||ke(e,c.path))},a=rh(t.allWrites,o,e),l=n||T.EMPTY_NODE;return rn(a,l)}}}function U_(t,e,n){let r=T.EMPTY_NODE;const i=Ot(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Z,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){const s=lt(t.visibleWrites,e);return n.forEachChild(Z,(o,a)=>{const l=rn(lt(s,new U(o)),a);r=r.updateImmediateChild(o,l)}),qa(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{const s=lt(t.visibleWrites,e);return qa(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function H_(t,e,n,r,i){v(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=se(e,n);if(ps(t.visibleWrites,s))return null;{const o=lt(t.visibleWrites,s);return gs(o)?i.getChild(n):rn(o,i.getChild(n))}}function j_(t,e,n,r){const i=se(e,n),s=Ot(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){const o=lt(t.visibleWrites,i);return rn(o,r.getNode().getImmediateChild(n))}else return null}function V_(t,e){return Ot(t.visibleWrites,e)}function q_(t,e,n,r,i,s,o){let a;const l=lt(t.visibleWrites,e),c=Ot(l,k());if(c!=null)a=c;else if(n!=null)a=rn(l,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){const u=[],f=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let p=h.getNext();for(;p&&u.length<i;)f(p,r)!==0&&u.push(p),p=h.getNext();return u}else return[]}function W_(){return{visibleWrites:Be.empty(),allWrites:[],lastWriteId:-1}}function kr(t,e,n,r){return ih(t.writeTree,t.treePath,e,n,r)}function oo(t,e){return U_(t.writeTree,t.treePath,e)}function Wa(t,e,n,r){return H_(t.writeTree,t.treePath,e,n,r)}function Fr(t,e){return V_(t.writeTree,se(t.treePath,e))}function G_(t,e,n,r,i,s){return q_(t.writeTree,t.treePath,e,n,r,i,s)}function ao(t,e,n){return j_(t.writeTree,t.treePath,e,n)}function sh(t,e){return oh(se(t.treePath,e),t.writeTree)}function oh(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z_{constructor(){this.changeMap=new Map}trackChildChange(e){const n=e.type,r=e.childName;v(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),v(r!==".priority","Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Vn(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,jn(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,nn(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Vn(r,e.snapshotNode,i.oldSnap));else throw ln("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}}const ah=new K_;class lo{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){const n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{const r=this.optCompleteServerCache_!=null?new ht(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return ao(this.writes_,e,r)}}getChildAfterChild(e,n,r){const i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:Rt(this.viewCache_),s=G_(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y_(t){return{filter:t}}function Q_(t,e){v(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),v(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function X_(t,e,n,r,i){const s=new z_;let o,a;if(n.type===Fe.OVERWRITE){const c=n;c.source.fromUser?o=ms(t,e,c.path,c.snap,r,i,s):(v(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!x(c.path),o=Br(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===Fe.MERGE){const c=n;c.source.fromUser?o=Z_(t,e,c.path,c.children,r,i,s):(v(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=_s(t,e,c.path,c.children,r,i,a,s))}else if(n.type===Fe.ACK_USER_WRITE){const c=n;c.revert?o=ny(t,e,c.path,r,i,s):o=ey(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===Fe.LISTEN_COMPLETE)o=ty(t,e,n.path,r,s);else throw ln("Unknown operation type: "+n.type);const l=s.getChanges();return J_(e,o,l),{viewCache:o,changes:l}}function J_(t,e,n){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Lr(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(Ju(Lr(e)))}}function lh(t,e,n,r,i,s){const o=e.eventCache;if(Fr(r,n)!=null)return e;{let a,l;if(x(n))if(v(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const c=Rt(e),u=c instanceof T?c:T.EMPTY_NODE,f=oo(r,u);a=t.filter.updateFullNode(e.eventCache.getNode(),f,s)}else{const c=kr(r,Rt(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{const c=$(n);if(c===".priority"){v(ut(n)===1,"Can't have a priority with additional path components");const u=o.getNode();l=e.serverCache.getNode();const f=Wa(r,n,u,l);f!=null?a=t.filter.updatePriority(u,f):a=o.getNode()}else{const u=V(n);let f;if(o.isCompleteForChild(c)){l=e.serverCache.getNode();const h=Wa(r,n,o.getNode(),l);h!=null?f=o.getNode().getImmediateChild(c).updateChild(u,h):f=o.getNode().getImmediateChild(c)}else f=ao(r,c,e.serverCache);f!=null?a=t.filter.updateChild(o.getNode(),c,f,u,i,s):a=o.getNode()}}return Rn(e,a,o.isFullyInitialized()||x(n),t.filter.filtersNodes())}}function Br(t,e,n,r,i,s,o,a){const l=e.serverCache;let c;const u=o?t.filter:t.filter.getIndexedFilter();if(x(n))c=u.updateFullNode(l.getNode(),r,null);else if(u.filtersNodes()&&!l.isFiltered()){const p=l.getNode().updateChild(n,r);c=u.updateFullNode(l.getNode(),p,null)}else{const p=$(n);if(!l.isCompleteForPath(n)&&ut(n)>1)return e;const d=V(n),m=l.getNode().getImmediateChild(p).updateChild(d,r);p===".priority"?c=u.updatePriority(l.getNode(),m):c=u.updateChild(l.getNode(),p,m,d,ah,null)}const f=th(e,c,l.isFullyInitialized()||x(n),u.filtersNodes()),h=new lo(i,f,s);return lh(t,f,n,i,h,a)}function ms(t,e,n,r,i,s,o){const a=e.eventCache;let l,c;const u=new lo(i,e,s);if(x(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),l=Rn(e,c,!0,t.filter.filtersNodes());else{const f=$(n);if(f===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),l=Rn(e,c,a.isFullyInitialized(),a.isFiltered());else{const h=V(n),p=a.getNode().getImmediateChild(f);let d;if(x(h))d=r;else{const g=u.getCompleteChild(f);g!=null?ju(h)===".priority"&&g.getChild(qu(h)).isEmpty()?d=g:d=g.updateChild(h,r):d=T.EMPTY_NODE}if(p.equals(d))l=e;else{const g=t.filter.updateChild(a.getNode(),f,d,h,u,o);l=Rn(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return l}function Ga(t,e){return t.eventCache.isCompleteForChild(e)}function Z_(t,e,n,r,i,s,o){let a=e;return r.foreach((l,c)=>{const u=se(n,l);Ga(e,$(u))&&(a=ms(t,a,u,c,i,s,o))}),r.foreach((l,c)=>{const u=se(n,l);Ga(e,$(u))||(a=ms(t,a,u,c,i,s,o))}),a}function za(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function _s(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let l=e,c;x(n)?c=r:c=new G(null).setTree(n,r);const u=e.serverCache.getNode();return c.children.inorderTraversal((f,h)=>{if(u.hasChild(f)){const p=e.serverCache.getNode().getImmediateChild(f),d=za(t,p,h);l=Br(t,l,new U(f),d,i,s,o,a)}}),c.children.inorderTraversal((f,h)=>{const p=!e.serverCache.isCompleteForChild(f)&&h.value===null;if(!u.hasChild(f)&&!p){const d=e.serverCache.getNode().getImmediateChild(f),g=za(t,d,h);l=Br(t,l,new U(f),g,i,s,o,a)}}),l}function ey(t,e,n,r,i,s,o){if(Fr(i,n)!=null)return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(r.value!=null){if(x(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return Br(t,e,n,l.getNode().getChild(n),i,s,a,o);if(x(n)){let c=new G(null);return l.getNode().forEachChild(Yt,(u,f)=>{c=c.set(new U(u),f)}),_s(t,e,n,c,i,s,a,o)}else return e}else{let c=new G(null);return r.foreach((u,f)=>{const h=se(n,u);l.isCompleteForPath(h)&&(c=c.set(u,l.getNode().getChild(h)))}),_s(t,e,n,c,i,s,a,o)}}function ty(t,e,n,r,i){const s=e.serverCache,o=th(e,s.getNode(),s.isFullyInitialized()||x(n),s.isFiltered());return lh(t,o,n,r,ah,i)}function ny(t,e,n,r,i,s){let o;if(Fr(r,n)!=null)return e;{const a=new lo(r,e,i),l=e.eventCache.getNode();let c;if(x(n)||$(n)===".priority"){let u;if(e.serverCache.isFullyInitialized())u=kr(r,Rt(e));else{const f=e.serverCache.getNode();v(f instanceof T,"serverChildren would be complete if leaf node"),u=oo(r,f)}u=u,c=t.filter.updateFullNode(l,u,s)}else{const u=$(n);let f=ao(r,u,e.serverCache);f==null&&e.serverCache.isCompleteForChild(u)&&(f=l.getImmediateChild(u)),f!=null?c=t.filter.updateChild(l,u,f,V(n),a,s):e.eventCache.getNode().hasChild(u)?c=t.filter.updateChild(l,u,T.EMPTY_NODE,V(n),a,s):c=l,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=kr(r,Rt(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||Fr(r,k())!=null,Rn(e,c,o,t.filter.filtersNodes())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry{constructor(e,n){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new no(r.getIndex()),s=E_(r);this.processor_=Y_(s);const o=n.serverCache,a=n.eventCache,l=i.updateFullNode(T.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(T.EMPTY_NODE,a.getNode(),null),u=new ht(l,o.isFullyInitialized(),i.filtersNodes()),f=new ht(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=ui(f,u),this.eventGenerator_=new R_(this.query_)}get query(){return this.query_}}function iy(t){return t.viewCache_.serverCache.getNode()}function sy(t){return Lr(t.viewCache_)}function oy(t,e){const n=Rt(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!x(e)&&!n.getImmediateChild($(e)).isEmpty())?n.getChild(e):null}function Ka(t){return t.eventRegistrations_.length===0}function ay(t,e){t.eventRegistrations_.push(e)}function Ya(t,e,n){const r=[];if(n){v(e==null,"A cancel should cancel all event registrations.");const i=t.query._path;t.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){const o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function Qa(t,e,n,r){e.type===Fe.MERGE&&e.source.queryId!==null&&(v(Rt(t.viewCache_),"We should always have a full cache before handling merges"),v(Lr(t.viewCache_),"Missing event cache, even though we have a server cache"));const i=t.viewCache_,s=X_(t.processor_,i,e,n,r);return Q_(t.processor_,s.viewCache),v(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,ch(t,s.changes,s.viewCache.eventCache.getNode(),null)}function ly(t,e){const n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Z,(s,o)=>{r.push(nn(s,o))}),n.isFullyInitialized()&&r.push(Ju(n.getNode())),ch(t,r,n.getNode(),e)}function ch(t,e,n,r){const i=r?[r]:t.eventRegistrations_;return O_(t.eventGenerator_,e,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ur;class uh{constructor(){this.views=new Map}}function cy(t){v(!Ur,"__referenceConstructor has already been defined"),Ur=t}function uy(){return v(Ur,"Reference.ts has not been loaded"),Ur}function hy(t){return t.views.size===0}function co(t,e,n,r){const i=e.source.queryId;if(i!==null){const s=t.views.get(i);return v(s!=null,"SyncTree gave us an op for an invalid query."),Qa(s,e,n,r)}else{let s=[];for(const o of t.views.values())s=s.concat(Qa(o,e,n,r));return s}}function hh(t,e,n,r,i){const s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=kr(n,i?r:null),l=!1;a?l=!0:r instanceof T?(a=oo(n,r),l=!1):(a=T.EMPTY_NODE,l=!1);const c=ui(new ht(a,l,!1),new ht(r,i,!1));return new ry(e,c)}return o}function fy(t,e,n,r,i,s){const o=hh(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),ay(o,n),ly(o,n)}function dy(t,e,n,r){const i=e._queryIdentifier,s=[];let o=[];const a=ft(t);if(i==="default")for(const[l,c]of t.views.entries())o=o.concat(Ya(c,n,r)),Ka(c)&&(t.views.delete(l),c.query._queryParams.loadsAllData()||s.push(c.query));else{const l=t.views.get(i);l&&(o=o.concat(Ya(l,n,r)),Ka(l)&&(t.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!ft(t)&&s.push(new(uy())(e._repo,e._path)),{removed:s,events:o}}function fh(t){const e=[];for(const n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function ct(t,e){let n=null;for(const r of t.views.values())n=n||oy(r,e);return n}function dh(t,e){if(e._queryParams.loadsAllData())return fi(t);{const r=e._queryIdentifier;return t.views.get(r)}}function ph(t,e){return dh(t,e)!=null}function ft(t){return fi(t)!=null}function fi(t){for(const e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hr;function py(t){v(!Hr,"__referenceConstructor has already been defined"),Hr=t}function gy(){return v(Hr,"Reference.ts has not been loaded"),Hr}let my=1;class Xa{constructor(e){this.listenProvider_=e,this.syncPointTree_=new G(null),this.pendingWriteTree_=W_(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function _y(t,e,n,r,i){return $_(t.pendingWriteTree_,e,n,r,i),i?tr(t,new Pt(eh(),e,n)):[]}function Gt(t,e,n=!1){const r=M_(t.pendingWriteTree_,e);if(L_(t.pendingWriteTree_,e)){let s=new G(null);return r.snap!=null?s=s.set(k(),!0):Ie(r.children,o=>{s=s.set(new U(o),!0)}),tr(t,new Mr(r.path,s,n))}else return[]}function er(t,e,n){return tr(t,new Pt(io(),e,n))}function yy(t,e,n){const r=G.fromObject(n);return tr(t,new Gn(io(),e,r))}function vy(t,e){return tr(t,new Wn(io(),e))}function by(t,e,n){const r=uo(t,n);if(r){const i=ho(r),s=i.path,o=i.queryId,a=Ee(s,e),l=new Wn(so(o),a);return fo(t,s,l)}else return[]}function gh(t,e,n,r,i=!1){const s=e._path,o=t.syncPointTree_.get(s);let a=[];if(o&&(e._queryIdentifier==="default"||ph(o,e))){const l=dy(o,e,n,r);hy(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));const c=l.removed;if(a=l.events,!i){const u=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,f=t.syncPointTree_.findOnPath(s,(h,p)=>ft(p));if(u&&!f){const h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){const p=Sy(h);for(let d=0;d<p.length;++d){const g=p[d],m=g.query,_=bh(t,g);t.listenProvider_.startListening(xn(m),zn(t,m),_.hashFn,_.onComplete)}}}!f&&c.length>0&&!r&&(u?t.listenProvider_.stopListening(xn(e),null):c.forEach(h=>{const p=t.queryToTagMap.get(di(h));t.listenProvider_.stopListening(xn(h),p)}))}Ty(t,c)}return a}function mh(t,e,n,r){const i=uo(t,r);if(i!=null){const s=ho(i),o=s.path,a=s.queryId,l=Ee(o,e),c=new Pt(so(a),l,n);return fo(t,o,c)}else return[]}function wy(t,e,n,r){const i=uo(t,r);if(i){const s=ho(i),o=s.path,a=s.queryId,l=Ee(o,e),c=G.fromObject(n),u=new Gn(so(a),l,c);return fo(t,o,u)}else return[]}function Ey(t,e,n,r=!1){const i=e._path;let s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,p)=>{const d=Ee(h,i);s=s||ct(p,d),o=o||ft(p)});let a=t.syncPointTree_.get(i);a?(o=o||ft(a),s=s||ct(a,k())):(a=new uh,t.syncPointTree_=t.syncPointTree_.set(i,a));let l;s!=null?l=!0:(l=!1,s=T.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((p,d)=>{const g=ct(d,k());g&&(s=s.updateImmediateChild(p,g))}));const c=ph(a,e);if(!c&&!e._queryParams.loadsAllData()){const h=di(e);v(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");const p=Iy();t.queryToTagMap.set(h,p),t.tagToQueryMap.set(p,h)}const u=hi(t.pendingWriteTree_,i);let f=fy(a,e,n,u,s,l);if(!c&&!o&&!r){const h=dh(a,e);f=f.concat(Ay(t,e,h))}return f}function _h(t,e,n){const i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{const l=Ee(o,e),c=ct(a,l);if(c)return c});return ih(i,e,s,n,!0)}function Cy(t,e){const n=e._path;let r=null;t.syncPointTree_.foreachOnPath(n,(c,u)=>{const f=Ee(c,n);r=r||ct(u,f)});let i=t.syncPointTree_.get(n);i?r=r||ct(i,k()):(i=new uh,t.syncPointTree_=t.syncPointTree_.set(n,i));const s=r!=null,o=s?new ht(r,!0,!1):null,a=hi(t.pendingWriteTree_,e._path),l=hh(i,e,a,s?o.getNode():T.EMPTY_NODE,s);return sy(l)}function tr(t,e){return yh(e,t.syncPointTree_,null,hi(t.pendingWriteTree_,k()))}function yh(t,e,n,r){if(x(t.path))return vh(t,e,n,r);{const i=e.get(k());n==null&&i!=null&&(n=ct(i,k()));let s=[];const o=$(t.path),a=t.operationForChild(o),l=e.children.get(o);if(l&&a){const c=n?n.getImmediateChild(o):null,u=sh(r,o);s=s.concat(yh(a,l,c,u))}return i&&(s=s.concat(co(i,t,r,n))),s}}function vh(t,e,n,r){const i=e.get(k());n==null&&i!=null&&(n=ct(i,k()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=n?n.getImmediateChild(o):null,c=sh(r,o),u=t.operationForChild(o);u&&(s=s.concat(vh(u,a,l,c)))}),i&&(s=s.concat(co(i,t,r,n))),s}function bh(t,e){const n=e.query,r=zn(t,n);return{hashFn:()=>(iy(e)||T.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?by(t,n._path,r):vy(t,n._path);{const s=wm(i,n);return gh(t,n,null,s)}}}}function zn(t,e){const n=di(e);return t.queryToTagMap.get(n)}function di(t){return t._path.toString()+"$"+t._queryIdentifier}function uo(t,e){return t.tagToQueryMap.get(e)}function ho(t){const e=t.indexOf("$");return v(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new U(t.substr(0,e))}}function fo(t,e,n){const r=t.syncPointTree_.get(e);v(r,"Missing sync point for query tag that we're tracking");const i=hi(t.pendingWriteTree_,e);return co(r,n,i,null)}function Sy(t){return t.fold((e,n,r)=>{if(n&&ft(n))return[fi(n)];{let i=[];return n&&(i=fh(n)),Ie(r,(s,o)=>{i=i.concat(o)}),i}})}function xn(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(gy())(t._repo,t._path):t}function Ty(t,e){for(let n=0;n<e.length;++n){const r=e[n];if(!r._queryParams.loadsAllData()){const i=di(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function Iy(){return my++}function Ay(t,e,n){const r=e._path,i=zn(t,e),s=bh(t,n),o=t.listenProvider_.startListening(xn(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)v(!ft(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((c,u,f)=>{if(!x(c)&&u&&ft(u))return[fi(u).query];{let h=[];return u&&(h=h.concat(fh(u).map(p=>p.query))),Ie(f,(p,d)=>{h=h.concat(d)}),h}});for(let c=0;c<l.length;++c){const u=l[c];t.listenProvider_.stopListening(xn(u),zn(t,u))}}return o}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this.node_=e}getImmediateChild(e){const n=this.node_.getImmediateChild(e);return new po(n)}node(){return this.node_}}class go{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){const n=se(this.path_,e);return new go(this.syncTree_,n)}node(){return _h(this.syncTree_,this.path_)}}const Py=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},Ja=function(t,e,n){if(!t||typeof t!="object")return t;if(v(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return Ry(t[".sv"],e,n);if(typeof t[".sv"]=="object")return Oy(t[".sv"],e);v(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},Ry=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:v(!1,"Unexpected server value: "+t)}},Oy=function(t,e,n){t.hasOwnProperty("increment")||v(!1,"Unexpected server value: "+JSON.stringify(t,null,2));const r=t.increment;typeof r!="number"&&v(!1,"Unexpected increment value: "+r);const i=e.node();if(v(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return typeof o!="number"?r:o+r},xy=function(t,e,n,r){return mo(e,new go(n,t),r)},Ny=function(t,e,n){return mo(t,new po(e),n)};function mo(t,e,n){const r=t.getPriority().val(),i=Ja(r,e.getImmediateChild(".priority"),n);let s;if(t.isLeafNode()){const o=t,a=Ja(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new le(a,ge(i)):t}else{const o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new le(i))),o.forEachChild(Z,(a,l)=>{const c=mo(l,e.getImmediateChild(a),n);c!==l&&(s=s.updateImmediateChild(a,c))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _o{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}}function yo(t,e){let n=e instanceof U?e:new U(e),r=t,i=$(n);for(;i!==null;){const s=Zt(r.node.children,i)||{children:{},childCount:0};r=new _o(i,r,s),n=V(n),i=$(n)}return r}function hn(t){return t.node.value}function wh(t,e){t.node.value=e,ys(t)}function Eh(t){return t.node.childCount>0}function Dy(t){return hn(t)===void 0&&!Eh(t)}function pi(t,e){Ie(t.node.children,(n,r)=>{e(new _o(n,t,r))})}function Ch(t,e,n,r){n&&!r&&e(t),pi(t,i=>{Ch(i,e,!0,r)}),n&&r&&e(t)}function $y(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function nr(t){return new U(t.parent===null?t.name:nr(t.parent)+"/"+t.name)}function ys(t){t.parent!==null&&My(t.parent,t.name,t)}function My(t,e,n){const r=Dy(n),i=Je(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,ys(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,ys(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ly=/[\[\].#$\/\u0000-\u001F\u007F]/,ky=/[\[\].#$\u0000-\u001F\u007F]/,Bi=10*1024*1024,Sh=function(t){return typeof t=="string"&&t.length!==0&&!Ly.test(t)},Th=function(t){return typeof t=="string"&&t.length!==0&&!ky.test(t)},Fy=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),Th(t)},Ih=function(t,e,n){const r=n instanceof U?new e_(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+_t(r));if(typeof e=="function")throw new Error(t+"contains a function "+_t(r)+" with contents = "+e.toString());if(wu(e))throw new Error(t+"contains "+e.toString()+" "+_t(r));if(typeof e=="string"&&e.length>Bi/3&&ai(e)>Bi)throw new Error(t+"contains a string greater than "+Bi+" utf8 bytes "+_t(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(Ie(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!Sh(o)))throw new Error(t+" contains an invalid key ("+o+") "+_t(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);t_(r,o),Ih(t,a,r),n_(r)}),i&&s)throw new Error(t+' contains ".value" child '+_t(r)+" in addition to actual children.")}},Ah=function(t,e,n,r){if(!(r&&n===void 0)&&!Th(n))throw new Error(Gc(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},By=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),Ah(t,e,n,r)},Uy=function(t,e){const n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!Sh(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!Fy(n))throw new Error(Gc(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hy{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function jy(t,e){let n=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();n!==null&&!Wu(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function dt(t,e,n){jy(t,n),Vy(t,r=>ke(r,e)||ke(e,r))}function Vy(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){const i=t.eventLists_[r];if(i){const s=i.path;e(s)?(qy(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function qy(t){for(let e=0;e<t.events.length;e++){const n=t.events[e];if(n!==null){t.events[e]=null;const r=n.getEventRunner();Et&&ye("event: "+n.toString()),Jn(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wy="repo_interrupt",Gy=25;class zy{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Hy,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=$r(),this.transactionQueueTree_=new _o,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function Ky(t,e,n){if(t.stats_=Js(t.repoInfo_),t.forceRestClient_||Tm())t.server_=new Dr(t.repoInfo_,(r,i,s,o)=>{Za(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>el(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ie(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Qe(t.repoInfo_,e,(r,i,s,o)=>{Za(t,r,i,s,o)},r=>{el(t,r)},r=>{Qy(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=Om(t.repoInfo_,()=>new P_(t.stats_,t.server_)),t.infoData_=new C_,t.infoSyncTree_=new Xa({startListening:(r,i,s,o)=>{let a=[];const l=t.infoData_.getNode(r._path);return l.isEmpty()||(a=er(t.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),vo(t,"connected",!1),t.serverSyncTree_=new Xa({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,l)=>{const c=o(a,l);dt(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function Yy(t){const n=t.infoData_.getNode(new U(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function Ph(t){return Py({timestamp:Yy(t)})}function Za(t,e,n,r,i){t.dataUpdateCount++;const s=new U(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){const l=Pr(n,c=>ge(c));o=wy(t.serverSyncTree_,s,l,i)}else{const l=ge(n);o=mh(t.serverSyncTree_,s,l,i)}else if(r){const l=Pr(n,c=>ge(c));o=yy(t.serverSyncTree_,s,l)}else{const l=ge(n);o=er(t.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Eo(t,s)),dt(t.eventQueue_,a,o)}function el(t,e){vo(t,"connected",e),e===!1&&Zy(t)}function Qy(t,e){Ie(e,(n,r)=>{vo(t,n,r)})}function vo(t,e,n){const r=new U("/.info/"+e),i=ge(n);t.infoData_.updateSnapshot(r,i);const s=er(t.infoSyncTree_,r,i);dt(t.eventQueue_,r,s)}function Xy(t){return t.nextWriteId_++}function Jy(t,e,n){const r=Cy(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{const s=ge(i).withIndex(e._queryParams.getIndex());Ey(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=er(t.serverSyncTree_,e._path,s);else{const a=zn(t.serverSyncTree_,e);o=mh(t.serverSyncTree_,e._path,s,a)}return dt(t.eventQueue_,e._path,o),gh(t.serverSyncTree_,e,n,null,!0),s},i=>(bo(t,"get for query "+ie(e)+" failed: "+i),Promise.reject(new Error(i))))}function Zy(t){bo(t,"onDisconnectEvents");const e=Ph(t),n=$r();ds(t.onDisconnect_,k(),(i,s)=>{const o=xy(i,s,t.serverSyncTree_,e);Zu(n,i,o)});let r=[];ds(n,k(),(i,s)=>{r=r.concat(er(t.serverSyncTree_,i,s));const o=rv(t,i);Eo(t,o)}),t.onDisconnect_=$r(),dt(t.eventQueue_,k(),r)}function ev(t){t.persistentConnection_&&t.persistentConnection_.interrupt(Wy)}function bo(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ye(n,...e)}function Rh(t,e,n){return _h(t.serverSyncTree_,e,n)||T.EMPTY_NODE}function wo(t,e=t.transactionQueueTree_){if(e||gi(t,e),hn(e)){const n=xh(t,e);v(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&tv(t,nr(e),n)}else Eh(e)&&pi(e,n=>{wo(t,n)})}function tv(t,e,n){const r=n.map(c=>c.currentWriteId),i=Rh(t,e,r);let s=i;const o=i.hash();for(let c=0;c<n.length;c++){const u=n[c];v(u.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;const f=Ee(e,u.path);s=s.updateChild(f,u.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;t.server_.put(l.toString(),a,c=>{bo(t,"transaction put response",{path:l.toString(),status:c});let u=[];if(c==="ok"){const f=[];for(let h=0;h<n.length;h++)n[h].status=2,u=u.concat(Gt(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&f.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();gi(t,yo(t.transactionQueueTree_,e)),wo(t,t.transactionQueueTree_),dt(t.eventQueue_,e,u);for(let h=0;h<f.length;h++)Jn(f[h])}else{if(c==="datastale")for(let f=0;f<n.length;f++)n[f].status===3?n[f].status=4:n[f].status=0;else{Re("transaction at "+l.toString()+" failed: "+c);for(let f=0;f<n.length;f++)n[f].status=4,n[f].abortReason=c}Eo(t,e)}},o)}function Eo(t,e){const n=Oh(t,e),r=nr(n),i=xh(t,n);return nv(t,i,r),r}function nv(t,e,n){if(e.length===0)return;const r=[];let i=[];const o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],c=Ee(n,l.path);let u=!1,f;if(v(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),l.status===4)u=!0,f=l.abortReason,i=i.concat(Gt(t.serverSyncTree_,l.currentWriteId,!0));else if(l.status===0)if(l.retryCount>=Gy)u=!0,f="maxretry",i=i.concat(Gt(t.serverSyncTree_,l.currentWriteId,!0));else{const h=Rh(t,l.path,o);l.currentInputSnapshot=h;const p=e[a].update(h.val());if(p!==void 0){Ih("transaction failed: Data returned ",p,l.path);let d=ge(p);typeof p=="object"&&p!=null&&Je(p,".priority")||(d=d.updatePriority(h.getPriority()));const m=l.currentWriteId,_=Ph(t),y=Ny(d,h,_);l.currentOutputSnapshotRaw=d,l.currentOutputSnapshotResolved=y,l.currentWriteId=Xy(t),o.splice(o.indexOf(m),1),i=i.concat(_y(t.serverSyncTree_,l.path,y,l.currentWriteId,l.applyLocally)),i=i.concat(Gt(t.serverSyncTree_,m,!0))}else u=!0,f="nodata",i=i.concat(Gt(t.serverSyncTree_,l.currentWriteId,!0))}dt(t.eventQueue_,n,i),i=[],u&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(f==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(f),!1,null))))}gi(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)Jn(r[a]);wo(t,t.transactionQueueTree_)}function Oh(t,e){let n,r=t.transactionQueueTree_;for(n=$(e);n!==null&&hn(r)===void 0;)r=yo(r,n),e=V(e),n=$(e);return r}function xh(t,e){const n=[];return Nh(t,e,n),n.sort((r,i)=>r.order-i.order),n}function Nh(t,e,n){const r=hn(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);pi(e,i=>{Nh(t,i,n)})}function gi(t,e){const n=hn(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,wh(e,n.length>0?n:void 0)}pi(e,r=>{gi(t,r)})}function rv(t,e){const n=nr(Oh(t,e)),r=yo(t.transactionQueueTree_,e);return $y(r,i=>{Ui(t,i)}),Ui(t,r),Ch(r,i=>{Ui(t,i)}),n}function Ui(t,e){const n=hn(e);if(n){const r=[];let i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(v(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(v(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Gt(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?wh(e,void 0):n.length=s+1,dt(t.eventQueue_,nr(e),i);for(let o=0;o<r.length;o++)Jn(r[o])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iv(t){let e="";const n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function sv(t){const e={};t.charAt(0)==="?"&&(t=t.substring(1));for(const n of t.split("&")){if(n.length===0)continue;const r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Re(`Invalid query segment '${n}' in query '${t}'`)}return e}const tl=function(t,e){const n=ov(t),r=n.namespace;n.domain==="firebase.com"&&Xe(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Xe("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||mm();const i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Du(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new U(n.pathString)}},ov=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",l=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let u=t.indexOf("/");u===-1&&(u=t.length);let f=t.indexOf("?");f===-1&&(f=t.length),e=t.substring(0,Math.min(u,f)),u<f&&(i=iv(t.substring(u,f)));const h=sv(t.substring(Math.min(t.length,f)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",l=parseInt(e.substring(c+1),10)):c=e.length;const p=e.slice(0,c);if(p.toLowerCase()==="localhost")n="localhost";else if(p.split(".").length<=2)n=p;else{const d=e.indexOf(".");r=e.substring(0,d).toLowerCase(),n=e.substring(d+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ie(this.snapshot.exportVal())}}class lv{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cv{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return v(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Co{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return x(this._path)?null:ju(this._path)}get ref(){return new et(this._repo,this._path)}get _queryIdentifier(){const e=Ua(this._queryParams),n=Qs(e);return n==="{}"?"default":n}get _queryObject(){return Ua(this._queryParams)}isEqual(e){if(e=Ze(e),!(e instanceof Co))return!1;const n=this._repo===e._repo,r=Wu(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+Zm(this._path)}}class et extends Co{constructor(e,n){super(e,n,new ro,!1)}get parent(){const e=qu(this._path);return e===null?null:new et(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}}class Kn{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const n=new U(e),r=vs(this.ref,e);return new Kn(this._node.getChild(n),r,Z)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new Kn(i,vs(this.ref,r),Z)))}hasChild(e){const n=new U(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function Dh(t,e){return t=Ze(t),t._checkNotDeleted("ref"),e!==void 0?vs(t._root,e):t._root}function vs(t,e){return t=Ze(t),$(t._path)===null?By("child","path",e,!1):Ah("child","path",e,!1),new et(t._repo,se(t._path,e))}function So(t){t=Ze(t);const e=new cv(()=>{}),n=new To(e);return Jy(t._repo,t,n).then(r=>new Kn(r,new et(t._repo,t._path),t._queryParams.getIndex()))}class To{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){const r=n._queryParams.getIndex();return new av("value",this,new Kn(e.snapshotNode,new et(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new lv(this,e,n):null}matches(e){return e instanceof To?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}}cy(et);py(et);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uv="FIREBASE_DATABASE_EMULATOR_HOST",bs={};let hv=!1;function fv(t,e,n,r){t.repoInfo_=new Du(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function dv(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Xe("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ye("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=tl(s,i),a=o.repoInfo,l,c;typeof process<"u"&&process.env&&(c=process.env[uv]),c?(l=!0,s=`http://${c}?ns=${a.namespace}`,o=tl(s,i),a=o.repoInfo):l=!o.repoInfo.secure;const u=i&&l?new Kt(Kt.OWNER):new Am(t.name,t.options,e);Uy("Invalid Firebase Database URL",o),x(o.path)||Xe("Database URL must point to the root of a Firebase Database (not including a child path).");const f=gv(a,t,u,new Im(t.name,n));return new mv(f,t)}function pv(t,e){const n=bs[e];(!n||n[t.key]!==t)&&Xe(`Database ${e}(${t.repoInfo_}) has already been deleted.`),ev(t),delete n[t.key]}function gv(t,e,n,r){let i=bs[e.name];i||(i={},bs[e.name]=i);let s=i[t.toURLString()];return s&&Xe("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new zy(t,hv,n,r),i[t.toURLString()]=s,s}class mv{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(Ky(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new et(this._repo,k())),this._rootInternal}_delete(){return this._rootInternal!==null&&(pv(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&Xe("Cannot call "+e+" on a deleted database.")}}function $h(t=Jc(),e){const n=Qc(t,"database").getImmediate({identifier:e});if(!n._instanceStarted){const r=Bc("database");r&&_v(n,...r)}return n}function _v(t,e,n,r={}){t=Ze(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Xe("Cannot call useEmulator() after instance has already been initialized.");const i=t._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&Xe('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Kt(Kt.OWNER);else if(r.mockUserToken){const o=typeof r.mockUserToken=="string"?r.mockUserToken:Hc(r.mockUserToken,t.app.options.projectId);s=new Kt(o)}fv(i,e,n,s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t){hm(Xc),Fn(new en("database",(e,{instanceIdentifier:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return dv(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),at(Ca,Sa,t),at(Ca,Sa,"esm2017")}Qe.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Qe.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};yv();const Mh=zs({apiKey:{}.FIREBASE_API_KEY,authDomain:{}.FIREBASE_AUTH_DOMAIN,databaseURL:{}.FIREBASE_DATABASE_URL,projectId:{}.FIREBASE_PROJECT_ID,storageBucket:{}.FIREBASE_STORAGE_BUCKET,messagingSenderId:{}.FIREBASE_MESSAGING_SENDER_ID,appId:{}.FIREBASE_APP_ID,measurementId:{}.FIREBASE_MEASUREMENT_ID}),vv=$h(Mh),Lh=_u(Mh),kh=Dh(vv,"songData"),bv=await So(kh),jr=bv.val(),nl=document.getElementById("playlistsList"),wv=async()=>{jr.forEach(()=>{nl&&(nl.innerHTML+=`
			<div class="link-card">
				<div class="song">
    				<div class="imgPlay">
					<img loading="eager" src="" width="250px" height="250px" />
					<button class="playButton no-animation">
						<!-- <svg viewBox="0 0 384 512" height="32px" width="32px" fill="white"><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"></path></svg> -->
						<!-- <svg viewBox="0 0 320 512" height="32px" width="32px" fill="white"><path d="M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"></path></svg> -->
						<svg viewBox="0 0 448 512" height="32px" width="32px" fill="white"><path d="M424.4 214.7L72.4 6.6C43.8-10.3 0 6.1 0 47.9V464c0 37.5 40.7 60.1 72.4 41.3l352-208c31.4-18.5 31.5-64.1 0-82.6z"></path></svg>
						<svg viewBox="0 0 448 512" height="32px" width="32px" fill="white"><path d="M144 479H48c-26.5 0-48-21.5-48-48V79c0-26.5 21.5-48 48-48h96c26.5 0 48 21.5 48 48v352c0 26.5-21.5 48-48 48zm304-48V79c0-26.5-21.5-48-48-48h-96c-26.5 0-48 21.5-48 48v352c0 26.5 21.5 48 48 48h96c26.5 0 48-21.5 48-48z"></path></svg>
					</button>
    				</div>
    				<div class="info">
						<h2></h2>
						<p></p>
    				</div>
				</div>
			</div>`)})};await wv();const Io=document.querySelectorAll(".playButton"),Ev=document.querySelectorAll(".link-card");Io.forEach(t=>{t.firstElementChild&&t.lastElementChild&&(t.firstElementChild.style.display="block",t.lastElementChild.style.display="none")});Ev.forEach(t=>{const e=t.querySelector(".playButton");t.addEventListener("mouseover",()=>{e?.classList.remove("no-animation")})});let Cv=document.querySelectorAll(".imgPlay img"),Sv=document.querySelectorAll(".info h2"),Tv=document.querySelectorAll(".info p");try{const e=(await So(kh)).val();e?Object.keys(e).forEach((n,r)=>{const i=Un(Lh,"covers/"+e[r].img);(async()=>{const s=await li(i);Cv[r].src=s,Sv[r].innerHTML=e[r].title,Tv[r].innerHTML=e[r].author})()}):console.log("No data available")}catch(t){console.error("Error fetching data:",t)}const Qt=document.getElementById("audio"),Iv=document.getElementById("title"),Av=document.getElementById("artist"),Pv=()=>{Io.forEach(t=>{t.firstElementChild.style.display="block",t.lastElementChild.style.display="none";const e=t.parentElement?.parentElement?.parentElement;e&&e.classList.remove("active")})},Rv=async t=>{if(t!==Qt.src){const e=Un(Lh,"songs/"+t),n=await li(e);Qt.src=n,Iv.innerHTML=jr[b.currentPlaylist].songs[b.currentSong].title,Av.innerHTML=jr[b.currentPlaylist].songs[b.currentSong].artist,b.audioSource=t,Qt.play()}};let Ov=document.querySelectorAll(".song");Io.forEach((t,e)=>{t.addEventListener("click",n=>{b.currentPlaylist!=e?(Pv(),Ov[e].parentElement.classList.add("active"),b.currentPlaylist=e,b.currentSong=0,Rv(jr[b.currentPlaylist].songs[b.currentSong].source),t.firstElementChild.style.display="none",t.lastElementChild.style.display="block"):Qt.paused?(t.firstElementChild.style.display="none",t.lastElementChild.style.display="block",Qt.play()):(t.firstElementChild.style.display="block",t.lastElementChild.style.display="none",Qt.pause()),n.stopPropagation()})});let Vr=document.getElementById("play"),qr=document.getElementById("current-time"),re=document.getElementById("seek-slider"),ws=document.getElementById("duration"),ue=document.getElementById("audio"),Es=document.getElementById("mute"),J=document.getElementById("volume-slider");const Fh=(t=!1)=>{const e=Vr.firstElementChild,n=Vr.lastElementChild;t?(e.style.display="block",n.style.display="none"):(e.style.display="none",n.style.display="block")},xv=()=>{let t=document.querySelectorAll(".singleSongButton"),e=document.getElementById("playPlaylist")?.lastElementChild,n=document.querySelectorAll(".playButton");ue.paused?(ue.play(),n.forEach(r=>{r.firstElementChild.style.display="none",r.lastElementChild.style.display="block"}),n[b.currentPlaylist].firstElementChild.style.display="none",n[b.currentPlaylist].lastElementChild.style.display="block",b.currentPlaylist==b.openedPlaylist&&(t[b.currentSong].lastElementChild.style.display="block",t[b.currentSong].firstElementChild.style.display="none",e.firstElementChild.style.display="none",e.lastElementChild.style.display="block")):(ue.pause(),n.forEach(r=>{r.firstElementChild.style.display="block",r.lastElementChild.style.display="none"}),n[b.currentPlaylist].firstElementChild.style.display="block",n[b.currentPlaylist].lastElementChild.style.display="none",b.currentPlaylist==b.openedPlaylist&&(t[b.currentSong].lastElementChild.style.display="none",t[b.currentSong].firstElementChild.style.display="block",e.firstElementChild.style.display="block",e.lastElementChild.style.display="none"))};ue.addEventListener("play",()=>{Fh()});ue.addEventListener("pause",()=>{Fh(!0)});Vr.addEventListener("click",()=>{xv()});const Bh=(t,e=0)=>{qr&&(qr.innerHTML=Cs(t)),ws&&e!==0&&(ws.innerHTML=Cs(e)),re.value="0"},Cs=t=>{const e=Math.floor(t/60),n=Math.floor(t%60);return n<10?`${e}:0${n}`:n>=10?`${e}:${n}`:"0:00"};J.style.setProperty("--volume-before-width",`${Number(J.value)/Number(J.max)*100}%`);ue.volume=Number(J.value)/200;const Uh=()=>{ue.volume=Number(J.value)/200};let Cr=!0,jt=50;Es?.addEventListener("click",()=>{if(J.value=="0"&&jt==0)return;const[t,e,n,r]=Es?.children;Cr?(jt=parseInt(J.value),J.value="0",t.style.display="none",e.style.display="none",n.style.display="none",r.style.display="block"):(J.value=jt.toString(),jt>65?(t.style.display="block",e.style.display="none",n.style.display="none",r.style.display="none"):jt>35?(t.style.display="none",e.style.display="block",n.style.display="none",r.style.display="none"):(t.style.display="none",e.style.display="none",n.style.display="block",r.style.display="none")),J.style.setProperty("--volume-before-width",`${Number(J.value)/Number(J.max)*100}%`),Uh(),Cr=!Cr});J.addEventListener("input",()=>{ue.volume=Number(J.value)/200;const[t,e,n,r]=Es?.children;Number(J.value)>65?(t.style.display="block",e.style.display="none",n.style.display="none",r.style.display="none"):Number(J.value)>35?(t.style.display="none",e.style.display="block",n.style.display="none",r.style.display="none"):Number(J.value)>0?(t.style.display="none",e.style.display="none",n.style.display="block",r.style.display="none"):(t.style.display="none",e.style.display="none",n.style.display="none",r.style.display="block"),J.style.setProperty("--volume-before-width",`${Number(J.value)/Number(J.max)*100}%`),Cr=!0});J?.addEventListener("change",()=>{jt=Number(J.value),Uh()});let Wr=0;re?.addEventListener("input",()=>{ue&&qr&&(Wr=Number(re.value),re.style.setProperty("--seek-before-width",`${Number(re.value)/Number(re.max)*100}%`),qr.innerHTML=Cs(Wr))});re?.addEventListener("change",()=>{ue.currentTime=ue.duration*(Number(re.value)/Number(re.max)),re.style.setProperty("--seek-before-width",`${Number(re.value)/Number(re.max)*100}%`),Wr=0});setInterval(()=>{ws&&Wr==0&&(Bh(ue.currentTime),re.value=ue.currentTime.toString(),re.style.setProperty("--seek-before-width",`${Number(re.value)/Number(re.max)*100}%`),isNaN(Number(re.max))?re.max="0":re.max=Math.floor(ue.duration).toString())},1e3);ue?.addEventListener("loadedmetadata",()=>{Bh(ue.currentTime,ue.duration),Vr.removeAttribute("disabled"),re.removeAttribute("disabled")});let rl=document.getElementById("random"),il=document.getElementById("loop");il?.addEventListener("click",()=>{il?.classList.toggle("on"),b.isLooping=!b.isLooping,ue.loop=b.isLooping});rl?.addEventListener("click",()=>{rl?.classList.toggle("on"),b.isShuffling=!b.isShuffling});var B=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Nv(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Dv(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var mr={},fn={},rr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.getColorIndex=t.getColorDiffStatus=t.hexDiff=t.rgbDiff=t.deltaE94=t.rgbToCIELab=t.xyzToCIELab=t.rgbToXyz=t.hslToRgb=t.rgbToHsl=t.rgbToHex=t.hexToRgb=t.defer=t.RSHIFT=t.SIGBITS=t.DELTAE94_DIFF_STATUS=void 0,t.DELTAE94_DIFF_STATUS={NA:0,PERFECT:1,CLOSE:2,GOOD:10,SIMILAR:50},t.SIGBITS=5,t.RSHIFT=8-t.SIGBITS;function e(){var d,g,m=new Promise(function(_,y){d=_,g=y});return{resolve:d,reject:g,promise:m}}t.defer=e;function n(d){var g=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(d);return g===null?null:[g[1],g[2],g[3]].map(function(m){return parseInt(m,16)})}t.hexToRgb=n;function r(d,g,m){return"#"+((1<<24)+(d<<16)+(g<<8)+m).toString(16).slice(1,7)}t.rgbToHex=r;function i(d,g,m){d/=255,g/=255,m/=255;var _=Math.max(d,g,m),y=Math.min(d,g,m),w,E,C=(_+y)/2;if(_===y)w=E=0;else{var I=_-y;switch(E=C>.5?I/(2-_-y):I/(_+y),_){case d:w=(g-m)/I+(g<m?6:0);break;case g:w=(m-d)/I+2;break;case m:w=(d-g)/I+4;break}w/=6}return[w,E,C]}t.rgbToHsl=i;function s(d,g,m){var _,y,w;function E(L,R,N){return N<0&&(N+=1),N>1&&(N-=1),N<1/6?L+(R-L)*6*N:N<1/2?R:N<2/3?L+(R-L)*(2/3-N)*6:L}if(g===0)_=y=w=m;else{var C=m<.5?m*(1+g):m+g-m*g,I=2*m-C;_=E(I,C,d+1/3),y=E(I,C,d),w=E(I,C,d-1/3)}return[_*255,y*255,w*255]}t.hslToRgb=s;function o(d,g,m){d/=255,g/=255,m/=255,d=d>.04045?Math.pow((d+.005)/1.055,2.4):d/12.92,g=g>.04045?Math.pow((g+.005)/1.055,2.4):g/12.92,m=m>.04045?Math.pow((m+.005)/1.055,2.4):m/12.92,d*=100,g*=100,m*=100;var _=d*.4124+g*.3576+m*.1805,y=d*.2126+g*.7152+m*.0722,w=d*.0193+g*.1192+m*.9505;return[_,y,w]}t.rgbToXyz=o;function a(d,g,m){var _=95.047,y=100,w=108.883;d/=_,g/=y,m/=w,d=d>.008856?Math.pow(d,1/3):7.787*d+16/116,g=g>.008856?Math.pow(g,1/3):7.787*g+16/116,m=m>.008856?Math.pow(m,1/3):7.787*m+16/116;var E=116*g-16,C=500*(d-g),I=200*(g-m);return[E,C,I]}t.xyzToCIELab=a;function l(d,g,m){var _=o(d,g,m),y=_[0],w=_[1],E=_[2];return a(y,w,E)}t.rgbToCIELab=l;function c(d,g){var m=1,_=1,y=1,w=d[0],E=d[1],C=d[2],I=g[0],L=g[1],R=g[2],N=w-I,q=E-L,de=C-R,Y=Math.sqrt(E*E+C*C),X=Math.sqrt(L*L+R*R),K=I-w,ee=X-Y,M=Math.sqrt(N*N+q*q+de*de),De=Math.sqrt(M)>Math.sqrt(Math.abs(K))+Math.sqrt(Math.abs(ee))?Math.sqrt(M*M-K*K-ee*ee):0,Mt=1+.045*Y,Lt=1+.015*Y;return K/=m,ee/=_*Mt,De/=y*Lt,Math.sqrt(K*K+ee*ee+De*De)}t.deltaE94=c;function u(d,g){var m=l.apply(void 0,d),_=l.apply(void 0,g);return c(m,_)}t.rgbDiff=u;function f(d,g){var m=n(d),_=n(g);return u(m,_)}t.hexDiff=f;function h(d){return d<t.DELTAE94_DIFF_STATUS.NA?"N/A":d<=t.DELTAE94_DIFF_STATUS.PERFECT?"Perfect":d<=t.DELTAE94_DIFF_STATUS.CLOSE?"Close":d<=t.DELTAE94_DIFF_STATUS.GOOD?"Good":d<t.DELTAE94_DIFF_STATUS.SIMILAR?"Similar":"Wrong"}t.getColorDiffStatus=h;function p(d,g,m){return(d<<2*t.SIGBITS)+(g<<t.SIGBITS)+m}t.getColorIndex=p})(rr);function $v(t,e){for(var n=-1,r=t==null?0:t.length,i=0,s=[];++n<r;){var o=t[n];e(o,n,t)&&(s[i++]=o)}return s}var Hh=$v;function Mv(t){return function(e,n,r){for(var i=-1,s=Object(e),o=r(e),a=o.length;a--;){var l=o[t?a:++i];if(n(s[l],l,s)===!1)break}return e}}var Lv=Mv,kv=Lv,Fv=kv(),Bv=Fv;function Uv(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var Hv=Uv,jv=typeof B=="object"&&B&&B.Object===Object&&B,jh=jv,Vv=jh,qv=typeof self=="object"&&self&&self.Object===Object&&self,Wv=Vv||qv||Function("return this")(),Ve=Wv,Gv=Ve,zv=Gv.Symbol,ir=zv,sl=ir,Vh=Object.prototype,Kv=Vh.hasOwnProperty,Yv=Vh.toString,Tn=sl?sl.toStringTag:void 0;function Qv(t){var e=Kv.call(t,Tn),n=t[Tn];try{t[Tn]=void 0;var r=!0}catch{}var i=Yv.call(t);return r&&(e?t[Tn]=n:delete t[Tn]),i}var Xv=Qv,Jv=Object.prototype,Zv=Jv.toString;function e1(t){return Zv.call(t)}var t1=e1,ol=ir,n1=Xv,r1=t1,i1="[object Null]",s1="[object Undefined]",al=ol?ol.toStringTag:void 0;function o1(t){return t==null?t===void 0?s1:i1:al&&al in Object(t)?n1(t):r1(t)}var sr=o1;function a1(t){return t!=null&&typeof t=="object"}var xt=a1,l1=sr,c1=xt,u1="[object Arguments]";function h1(t){return c1(t)&&l1(t)==u1}var f1=h1,ll=f1,d1=xt,qh=Object.prototype,p1=qh.hasOwnProperty,g1=qh.propertyIsEnumerable,m1=ll(function(){return arguments}())?ll:function(t){return d1(t)&&p1.call(t,"callee")&&!g1.call(t,"callee")},Wh=m1,_1=Array.isArray,qe=_1,Gr={exports:{}};function y1(){return!1}var v1=y1;Gr.exports;(function(t,e){var n=Ve,r=v1,i=e&&!e.nodeType&&e,s=i&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===i,a=o?n.Buffer:void 0,l=a?a.isBuffer:void 0,c=l||r;t.exports=c})(Gr,Gr.exports);var Ao=Gr.exports,b1=9007199254740991,w1=/^(?:0|[1-9]\d*)$/;function E1(t,e){var n=typeof t;return e=e??b1,!!e&&(n=="number"||n!="symbol"&&w1.test(t))&&t>-1&&t%1==0&&t<e}var Po=E1,C1=9007199254740991;function S1(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=C1}var Ro=S1,T1=sr,I1=Ro,A1=xt,P1="[object Arguments]",R1="[object Array]",O1="[object Boolean]",x1="[object Date]",N1="[object Error]",D1="[object Function]",$1="[object Map]",M1="[object Number]",L1="[object Object]",k1="[object RegExp]",F1="[object Set]",B1="[object String]",U1="[object WeakMap]",H1="[object ArrayBuffer]",j1="[object DataView]",V1="[object Float32Array]",q1="[object Float64Array]",W1="[object Int8Array]",G1="[object Int16Array]",z1="[object Int32Array]",K1="[object Uint8Array]",Y1="[object Uint8ClampedArray]",Q1="[object Uint16Array]",X1="[object Uint32Array]",W={};W[V1]=W[q1]=W[W1]=W[G1]=W[z1]=W[K1]=W[Y1]=W[Q1]=W[X1]=!0;W[P1]=W[R1]=W[H1]=W[O1]=W[j1]=W[x1]=W[N1]=W[D1]=W[$1]=W[M1]=W[L1]=W[k1]=W[F1]=W[B1]=W[U1]=!1;function J1(t){return A1(t)&&I1(t.length)&&!!W[T1(t)]}var Z1=J1;function eb(t){return function(e){return t(e)}}var Oo=eb,zr={exports:{}};zr.exports;(function(t,e){var n=jh,r=e&&!e.nodeType&&e,i=r&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===r,o=s&&n.process,a=function(){try{var l=i&&i.require&&i.require("util").types;return l||o&&o.binding&&o.binding("util")}catch{}}();t.exports=a})(zr,zr.exports);var xo=zr.exports,tb=Z1,nb=Oo,cl=xo,ul=cl&&cl.isTypedArray,rb=ul?nb(ul):tb,Gh=rb,ib=Hv,sb=Wh,ob=qe,ab=Ao,lb=Po,cb=Gh,ub=Object.prototype,hb=ub.hasOwnProperty;function fb(t,e){var n=ob(t),r=!n&&sb(t),i=!n&&!r&&ab(t),s=!n&&!r&&!i&&cb(t),o=n||r||i||s,a=o?ib(t.length,String):[],l=a.length;for(var c in t)(e||hb.call(t,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||lb(c,l)))&&a.push(c);return a}var zh=fb,db=Object.prototype;function pb(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||db;return t===n}var No=pb;function gb(t,e){return function(n){return t(e(n))}}var Kh=gb,mb=Kh,_b=mb(Object.keys,Object),yb=_b,vb=No,bb=yb,wb=Object.prototype,Eb=wb.hasOwnProperty;function Cb(t){if(!vb(t))return bb(t);var e=[];for(var n in Object(t))Eb.call(t,n)&&n!="constructor"&&e.push(n);return e}var Sb=Cb;function Tb(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Nt=Tb,Ib=sr,Ab=Nt,Pb="[object AsyncFunction]",Rb="[object Function]",Ob="[object GeneratorFunction]",xb="[object Proxy]";function Nb(t){if(!Ab(t))return!1;var e=Ib(t);return e==Rb||e==Ob||e==Pb||e==xb}var Yh=Nb,Db=Yh,$b=Ro;function Mb(t){return t!=null&&$b(t.length)&&!Db(t)}var mi=Mb,Lb=zh,kb=Sb,Fb=mi;function Bb(t){return Fb(t)?Lb(t):kb(t)}var or=Bb,Ub=Bv,Hb=or;function jb(t,e){return t&&Ub(t,e,Hb)}var Vb=jb,qb=mi;function Wb(t,e){return function(n,r){if(n==null)return n;if(!qb(n))return t(n,r);for(var i=n.length,s=e?i:-1,o=Object(n);(e?s--:++s<i)&&r(o[s],s,o)!==!1;);return n}}var Gb=Wb,zb=Vb,Kb=Gb,Yb=Kb(zb),Qb=Yb,Xb=Qb;function Jb(t,e){var n=[];return Xb(t,function(r,i,s){e(r,i,s)&&n.push(r)}),n}var Zb=Jb;function e0(){this.__data__=[],this.size=0}var t0=e0;function n0(t,e){return t===e||t!==t&&e!==e}var ar=n0,r0=ar;function i0(t,e){for(var n=t.length;n--;)if(r0(t[n][0],e))return n;return-1}var _i=i0,s0=_i,o0=Array.prototype,a0=o0.splice;function l0(t){var e=this.__data__,n=s0(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():a0.call(e,n,1),--this.size,!0}var c0=l0,u0=_i;function h0(t){var e=this.__data__,n=u0(e,t);return n<0?void 0:e[n][1]}var f0=h0,d0=_i;function p0(t){return d0(this.__data__,t)>-1}var g0=p0,m0=_i;function _0(t,e){var n=this.__data__,r=m0(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var y0=_0,v0=t0,b0=c0,w0=f0,E0=g0,C0=y0;function dn(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}dn.prototype.clear=v0;dn.prototype.delete=b0;dn.prototype.get=w0;dn.prototype.has=E0;dn.prototype.set=C0;var yi=dn,S0=yi;function T0(){this.__data__=new S0,this.size=0}var I0=T0;function A0(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var P0=A0;function R0(t){return this.__data__.get(t)}var O0=R0;function x0(t){return this.__data__.has(t)}var N0=x0,D0=Ve,$0=D0["__core-js_shared__"],M0=$0,Hi=M0,hl=function(){var t=/[^.]+$/.exec(Hi&&Hi.keys&&Hi.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function L0(t){return!!hl&&hl in t}var k0=L0,F0=Function.prototype,B0=F0.toString;function U0(t){if(t!=null){try{return B0.call(t)}catch{}try{return t+""}catch{}}return""}var Qh=U0,H0=Yh,j0=k0,V0=Nt,q0=Qh,W0=/[\\^$.*+?()[\]{}|]/g,G0=/^\[object .+?Constructor\]$/,z0=Function.prototype,K0=Object.prototype,Y0=z0.toString,Q0=K0.hasOwnProperty,X0=RegExp("^"+Y0.call(Q0).replace(W0,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function J0(t){if(!V0(t)||j0(t))return!1;var e=H0(t)?X0:G0;return e.test(q0(t))}var Z0=J0;function ew(t,e){return t?.[e]}var tw=ew,nw=Z0,rw=tw;function iw(t,e){var n=rw(t,e);return nw(n)?n:void 0}var Dt=iw,sw=Dt,ow=Ve,aw=sw(ow,"Map"),Do=aw,lw=Dt,cw=lw(Object,"create"),vi=cw,fl=vi;function uw(){this.__data__=fl?fl(null):{},this.size=0}var hw=uw;function fw(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var dw=fw,pw=vi,gw="__lodash_hash_undefined__",mw=Object.prototype,_w=mw.hasOwnProperty;function yw(t){var e=this.__data__;if(pw){var n=e[t];return n===gw?void 0:n}return _w.call(e,t)?e[t]:void 0}var vw=yw,bw=vi,ww=Object.prototype,Ew=ww.hasOwnProperty;function Cw(t){var e=this.__data__;return bw?e[t]!==void 0:Ew.call(e,t)}var Sw=Cw,Tw=vi,Iw="__lodash_hash_undefined__";function Aw(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Tw&&e===void 0?Iw:e,this}var Pw=Aw,Rw=hw,Ow=dw,xw=vw,Nw=Sw,Dw=Pw;function pn(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}pn.prototype.clear=Rw;pn.prototype.delete=Ow;pn.prototype.get=xw;pn.prototype.has=Nw;pn.prototype.set=Dw;var $w=pn,dl=$w,Mw=yi,Lw=Do;function kw(){this.size=0,this.__data__={hash:new dl,map:new(Lw||Mw),string:new dl}}var Fw=kw;function Bw(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Uw=Bw,Hw=Uw;function jw(t,e){var n=t.__data__;return Hw(e)?n[typeof e=="string"?"string":"hash"]:n.map}var bi=jw,Vw=bi;function qw(t){var e=Vw(this,t).delete(t);return this.size-=e?1:0,e}var Ww=qw,Gw=bi;function zw(t){return Gw(this,t).get(t)}var Kw=zw,Yw=bi;function Qw(t){return Yw(this,t).has(t)}var Xw=Qw,Jw=bi;function Zw(t,e){var n=Jw(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var eE=Zw,tE=Fw,nE=Ww,rE=Kw,iE=Xw,sE=eE;function gn(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}gn.prototype.clear=tE;gn.prototype.delete=nE;gn.prototype.get=rE;gn.prototype.has=iE;gn.prototype.set=sE;var $o=gn,oE=yi,aE=Do,lE=$o,cE=200;function uE(t,e){var n=this.__data__;if(n instanceof oE){var r=n.__data__;if(!aE||r.length<cE-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new lE(r)}return n.set(t,e),this.size=n.size,this}var hE=uE,fE=yi,dE=I0,pE=P0,gE=O0,mE=N0,_E=hE;function mn(t){var e=this.__data__=new fE(t);this.size=e.size}mn.prototype.clear=dE;mn.prototype.delete=pE;mn.prototype.get=gE;mn.prototype.has=mE;mn.prototype.set=_E;var Mo=mn,yE="__lodash_hash_undefined__";function vE(t){return this.__data__.set(t,yE),this}var bE=vE;function wE(t){return this.__data__.has(t)}var EE=wE,CE=$o,SE=bE,TE=EE;function Kr(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new CE;++e<n;)this.add(t[e])}Kr.prototype.add=Kr.prototype.push=SE;Kr.prototype.has=TE;var IE=Kr;function AE(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var PE=AE;function RE(t,e){return t.has(e)}var OE=RE,xE=IE,NE=PE,DE=OE,$E=1,ME=2;function LE(t,e,n,r,i,s){var o=n&$E,a=t.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var f=-1,h=!0,p=n&ME?new xE:void 0;for(s.set(t,e),s.set(e,t);++f<a;){var d=t[f],g=e[f];if(r)var m=o?r(g,d,f,e,t,s):r(d,g,f,t,e,s);if(m!==void 0){if(m)continue;h=!1;break}if(p){if(!NE(e,function(_,y){if(!DE(p,y)&&(d===_||i(d,_,n,r,s)))return p.push(y)})){h=!1;break}}else if(!(d===g||i(d,g,n,r,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var Xh=LE,kE=Ve,FE=kE.Uint8Array,Jh=FE;function BE(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}var UE=BE;function HE(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var jE=HE,pl=ir,gl=Jh,VE=ar,qE=Xh,WE=UE,GE=jE,zE=1,KE=2,YE="[object Boolean]",QE="[object Date]",XE="[object Error]",JE="[object Map]",ZE="[object Number]",eC="[object RegExp]",tC="[object Set]",nC="[object String]",rC="[object Symbol]",iC="[object ArrayBuffer]",sC="[object DataView]",ml=pl?pl.prototype:void 0,ji=ml?ml.valueOf:void 0;function oC(t,e,n,r,i,s,o){switch(n){case sC:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case iC:return!(t.byteLength!=e.byteLength||!s(new gl(t),new gl(e)));case YE:case QE:case ZE:return VE(+t,+e);case XE:return t.name==e.name&&t.message==e.message;case eC:case nC:return t==e+"";case JE:var a=WE;case tC:var l=r&zE;if(a||(a=GE),t.size!=e.size&&!l)return!1;var c=o.get(t);if(c)return c==e;r|=KE,o.set(t,e);var u=qE(a(t),a(e),r,i,s,o);return o.delete(t),u;case rC:if(ji)return ji.call(t)==ji.call(e)}return!1}var aC=oC;function lC(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var Zh=lC,cC=Zh,uC=qe;function hC(t,e,n){var r=e(t);return uC(t)?r:cC(r,n(t))}var ef=hC;function fC(){return[]}var tf=fC,dC=Hh,pC=tf,gC=Object.prototype,mC=gC.propertyIsEnumerable,_l=Object.getOwnPropertySymbols,_C=_l?function(t){return t==null?[]:(t=Object(t),dC(_l(t),function(e){return mC.call(t,e)}))}:pC,Lo=_C,yC=ef,vC=Lo,bC=or;function wC(t){return yC(t,bC,vC)}var nf=wC,yl=nf,EC=1,CC=Object.prototype,SC=CC.hasOwnProperty;function TC(t,e,n,r,i,s){var o=n&EC,a=yl(t),l=a.length,c=yl(e),u=c.length;if(l!=u&&!o)return!1;for(var f=l;f--;){var h=a[f];if(!(o?h in e:SC.call(e,h)))return!1}var p=s.get(t),d=s.get(e);if(p&&d)return p==e&&d==t;var g=!0;s.set(t,e),s.set(e,t);for(var m=o;++f<l;){h=a[f];var _=t[h],y=e[h];if(r)var w=o?r(y,_,h,e,t,s):r(_,y,h,t,e,s);if(!(w===void 0?_===y||i(_,y,n,r,s):w)){g=!1;break}m||(m=h=="constructor")}if(g&&!m){var E=t.constructor,C=e.constructor;E!=C&&"constructor"in t&&"constructor"in e&&!(typeof E=="function"&&E instanceof E&&typeof C=="function"&&C instanceof C)&&(g=!1)}return s.delete(t),s.delete(e),g}var IC=TC,AC=Dt,PC=Ve,RC=AC(PC,"DataView"),OC=RC,xC=Dt,NC=Ve,DC=xC(NC,"Promise"),$C=DC,MC=Dt,LC=Ve,kC=MC(LC,"Set"),FC=kC,BC=Dt,UC=Ve,HC=BC(UC,"WeakMap"),jC=HC,Ss=OC,Ts=Do,Is=$C,As=FC,Ps=jC,rf=sr,_n=Qh,vl="[object Map]",VC="[object Object]",bl="[object Promise]",wl="[object Set]",El="[object WeakMap]",Cl="[object DataView]",qC=_n(Ss),WC=_n(Ts),GC=_n(Is),zC=_n(As),KC=_n(Ps),yt=rf;(Ss&&yt(new Ss(new ArrayBuffer(1)))!=Cl||Ts&&yt(new Ts)!=vl||Is&&yt(Is.resolve())!=bl||As&&yt(new As)!=wl||Ps&&yt(new Ps)!=El)&&(yt=function(t){var e=rf(t),n=e==VC?t.constructor:void 0,r=n?_n(n):"";if(r)switch(r){case qC:return Cl;case WC:return vl;case GC:return bl;case zC:return wl;case KC:return El}return e});var wi=yt,Vi=Mo,YC=Xh,QC=aC,XC=IC,Sl=wi,Tl=qe,Il=Ao,JC=Gh,ZC=1,Al="[object Arguments]",Pl="[object Array]",_r="[object Object]",eS=Object.prototype,Rl=eS.hasOwnProperty;function tS(t,e,n,r,i,s){var o=Tl(t),a=Tl(e),l=o?Pl:Sl(t),c=a?Pl:Sl(e);l=l==Al?_r:l,c=c==Al?_r:c;var u=l==_r,f=c==_r,h=l==c;if(h&&Il(t)){if(!Il(e))return!1;o=!0,u=!1}if(h&&!u)return s||(s=new Vi),o||JC(t)?YC(t,e,n,r,i,s):QC(t,e,l,n,r,i,s);if(!(n&ZC)){var p=u&&Rl.call(t,"__wrapped__"),d=f&&Rl.call(e,"__wrapped__");if(p||d){var g=p?t.value():t,m=d?e.value():e;return s||(s=new Vi),i(g,m,n,r,s)}}return h?(s||(s=new Vi),XC(t,e,n,r,i,s)):!1}var nS=tS,rS=nS,Ol=xt;function sf(t,e,n,r,i){return t===e?!0:t==null||e==null||!Ol(t)&&!Ol(e)?t!==t&&e!==e:rS(t,e,n,r,sf,i)}var of=sf,iS=Mo,sS=of,oS=1,aS=2;function lS(t,e,n,r){var i=n.length,s=i,o=!r;if(t==null)return!s;for(t=Object(t);i--;){var a=n[i];if(o&&a[2]?a[1]!==t[a[0]]:!(a[0]in t))return!1}for(;++i<s;){a=n[i];var l=a[0],c=t[l],u=a[1];if(o&&a[2]){if(c===void 0&&!(l in t))return!1}else{var f=new iS;if(r)var h=r(c,u,l,t,e,f);if(!(h===void 0?sS(u,c,oS|aS,r,f):h))return!1}}return!0}var cS=lS,uS=Nt;function hS(t){return t===t&&!uS(t)}var af=hS,fS=af,dS=or;function pS(t){for(var e=dS(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,fS(i)]}return e}var gS=pS;function mS(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var lf=mS,_S=cS,yS=gS,vS=lf;function bS(t){var e=yS(t);return e.length==1&&e[0][2]?vS(e[0][0],e[0][1]):function(n){return n===t||_S(n,t,e)}}var wS=bS,ES=sr,CS=xt,SS="[object Symbol]";function TS(t){return typeof t=="symbol"||CS(t)&&ES(t)==SS}var ko=TS,IS=qe,AS=ko,PS=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,RS=/^\w*$/;function OS(t,e){if(IS(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||AS(t)?!0:RS.test(t)||!PS.test(t)||e!=null&&t in Object(e)}var Fo=OS,cf=$o,xS="Expected a function";function Bo(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(xS);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var o=t.apply(this,r);return n.cache=s.set(i,o)||s,o};return n.cache=new(Bo.Cache||cf),n}Bo.Cache=cf;var NS=Bo,DS=NS,$S=500;function MS(t){var e=DS(t,function(r){return n.size===$S&&n.clear(),r}),n=e.cache;return e}var LS=MS,kS=LS,FS=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,BS=/\\(\\)?/g,US=kS(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(FS,function(n,r,i,s){e.push(i?s.replace(BS,"$1"):r||n)}),e}),HS=US;function jS(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var VS=jS,xl=ir,qS=VS,WS=qe,GS=ko,zS=1/0,Nl=xl?xl.prototype:void 0,Dl=Nl?Nl.toString:void 0;function uf(t){if(typeof t=="string")return t;if(WS(t))return qS(t,uf)+"";if(GS(t))return Dl?Dl.call(t):"";var e=t+"";return e=="0"&&1/t==-zS?"-0":e}var KS=uf,YS=KS;function QS(t){return t==null?"":YS(t)}var XS=QS,JS=qe,ZS=Fo,eT=HS,tT=XS;function nT(t,e){return JS(t)?t:ZS(t,e)?[t]:eT(tT(t))}var hf=nT,rT=ko,iT=1/0;function sT(t){if(typeof t=="string"||rT(t))return t;var e=t+"";return e=="0"&&1/t==-iT?"-0":e}var Ei=sT,oT=hf,aT=Ei;function lT(t,e){e=oT(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[aT(e[n++])];return n&&n==r?t:void 0}var ff=lT,cT=ff;function uT(t,e,n){var r=t==null?void 0:cT(t,e);return r===void 0?n:r}var hT=uT;function fT(t,e){return t!=null&&e in Object(t)}var dT=fT,pT=hf,gT=Wh,mT=qe,_T=Po,yT=Ro,vT=Ei;function bT(t,e,n){e=pT(e,t);for(var r=-1,i=e.length,s=!1;++r<i;){var o=vT(e[r]);if(!(s=t!=null&&n(t,o)))break;t=t[o]}return s||++r!=i?s:(i=t==null?0:t.length,!!i&&yT(i)&&_T(o,i)&&(mT(t)||gT(t)))}var wT=bT,ET=dT,CT=wT;function ST(t,e){return t!=null&&CT(t,e,ET)}var TT=ST,IT=of,AT=hT,PT=TT,RT=Fo,OT=af,xT=lf,NT=Ei,DT=1,$T=2;function MT(t,e){return RT(t)&&OT(e)?xT(NT(t),e):function(n){var r=AT(n,t);return r===void 0&&r===e?PT(n,t):IT(e,r,DT|$T)}}var LT=MT;function kT(t){return t}var Uo=kT;function FT(t){return function(e){return e?.[t]}}var BT=FT,UT=ff;function HT(t){return function(e){return UT(e,t)}}var jT=HT,VT=BT,qT=jT,WT=Fo,GT=Ei;function zT(t){return WT(t)?VT(GT(t)):qT(t)}var KT=zT,YT=wS,QT=LT,XT=Uo,JT=qe,ZT=KT;function eI(t){return typeof t=="function"?t:t==null?XT:typeof t=="object"?JT(t)?QT(t[0],t[1]):YT(t):ZT(t)}var tI=eI,nI=Hh,rI=Zb,iI=tI,sI=qe;function oI(t,e){var n=sI(t)?nI:rI;return n(t,iI(e))}var aI=oI;Object.defineProperty(fn,"__esModule",{value:!0});fn.Swatch=void 0;var $l=rr,lI=aI,cI=function(){function t(e,n){this._rgb=e,this._population=n}return t.applyFilter=function(e,n){return typeof n=="function"?lI(e,function(r){var i=r.r,s=r.g,o=r.b;return n(i,s,o,255)}):e},Object.defineProperty(t.prototype,"r",{get:function(){return this._rgb[0]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"g",{get:function(){return this._rgb[1]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this._rgb[2]},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rgb",{get:function(){return this._rgb},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hsl",{get:function(){if(!this._hsl){var e=this._rgb,n=e[0],r=e[1],i=e[2];this._hsl=$l.rgbToHsl(n,r,i)}return this._hsl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hex",{get:function(){if(!this._hex){var e=this._rgb,n=e[0],r=e[1],i=e[2];this._hex=$l.rgbToHex(n,r,i)}return this._hex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"population",{get:function(){return this._population},enumerable:!1,configurable:!0}),t.prototype.toJSON=function(){return{rgb:this.rgb,population:this.population}},t.prototype.getRgb=function(){return this._rgb},t.prototype.getHsl=function(){return this.hsl},t.prototype.getPopulation=function(){return this._population},t.prototype.getHex=function(){return this.hex},t.prototype.getYiq=function(){if(!this._yiq){var e=this._rgb;this._yiq=(e[0]*299+e[1]*587+e[2]*114)/1e3}return this._yiq},Object.defineProperty(t.prototype,"titleTextColor",{get:function(){return this._titleTextColor||(this._titleTextColor=this.getYiq()<200?"#fff":"#000"),this._titleTextColor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bodyTextColor",{get:function(){return this._bodyTextColor||(this._bodyTextColor=this.getYiq()<150?"#fff":"#000"),this._bodyTextColor},enumerable:!1,configurable:!0}),t.prototype.getTitleTextColor=function(){return this.titleTextColor},t.prototype.getBodyTextColor=function(){return this.bodyTextColor},t}();fn.Swatch=cI;var yr={};function uI(t,e){for(var n=-1,r=t==null?0:t.length;++n<r&&e(t[n],n,t)!==!1;);return t}var hI=uI,fI=Dt,dI=function(){try{var t=fI(Object,"defineProperty");return t({},"",{}),t}catch{}}(),df=dI,Ml=df;function pI(t,e,n){e=="__proto__"&&Ml?Ml(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var pf=pI,gI=pf,mI=ar,_I=Object.prototype,yI=_I.hasOwnProperty;function vI(t,e,n){var r=t[e];(!(yI.call(t,e)&&mI(r,n))||n===void 0&&!(e in t))&&gI(t,e,n)}var gf=vI,bI=gf,wI=pf;function EI(t,e,n,r){var i=!n;n||(n={});for(var s=-1,o=e.length;++s<o;){var a=e[s],l=r?r(n[a],t[a],a,n,t):void 0;l===void 0&&(l=t[a]),i?wI(n,a,l):bI(n,a,l)}return n}var Ci=EI,CI=Ci,SI=or;function TI(t,e){return t&&CI(e,SI(e),t)}var II=TI;function AI(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var PI=AI,RI=Nt,OI=No,xI=PI,NI=Object.prototype,DI=NI.hasOwnProperty;function $I(t){if(!RI(t))return xI(t);var e=OI(t),n=[];for(var r in t)r=="constructor"&&(e||!DI.call(t,r))||n.push(r);return n}var MI=$I,LI=zh,kI=MI,FI=mi;function BI(t){return FI(t)?LI(t,!0):kI(t)}var Si=BI,UI=Ci,HI=Si;function jI(t,e){return t&&UI(e,HI(e),t)}var VI=jI,Yr={exports:{}};Yr.exports;(function(t,e){var n=Ve,r=e&&!e.nodeType&&e,i=r&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===r,o=s?n.Buffer:void 0,a=o?o.allocUnsafe:void 0;function l(c,u){if(u)return c.slice();var f=c.length,h=a?a(f):new c.constructor(f);return c.copy(h),h}t.exports=l})(Yr,Yr.exports);var qI=Yr.exports;function WI(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}var GI=WI,zI=Ci,KI=Lo;function YI(t,e){return zI(t,KI(t),e)}var QI=YI,XI=Kh,JI=XI(Object.getPrototypeOf,Object),mf=JI,ZI=Zh,eA=mf,tA=Lo,nA=tf,rA=Object.getOwnPropertySymbols,iA=rA?function(t){for(var e=[];t;)ZI(e,tA(t)),t=eA(t);return e}:nA,_f=iA,sA=Ci,oA=_f;function aA(t,e){return sA(t,oA(t),e)}var lA=aA,cA=ef,uA=_f,hA=Si;function fA(t){return cA(t,hA,uA)}var dA=fA,pA=Object.prototype,gA=pA.hasOwnProperty;function mA(t){var e=t.length,n=new t.constructor(e);return e&&typeof t[0]=="string"&&gA.call(t,"index")&&(n.index=t.index,n.input=t.input),n}var _A=mA,Ll=Jh;function yA(t){var e=new t.constructor(t.byteLength);return new Ll(e).set(new Ll(t)),e}var Ho=yA,vA=Ho;function bA(t,e){var n=e?vA(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}var wA=bA,EA=/\w*$/;function CA(t){var e=new t.constructor(t.source,EA.exec(t));return e.lastIndex=t.lastIndex,e}var SA=CA,kl=ir,Fl=kl?kl.prototype:void 0,Bl=Fl?Fl.valueOf:void 0;function TA(t){return Bl?Object(Bl.call(t)):{}}var IA=TA,AA=Ho;function PA(t,e){var n=e?AA(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}var RA=PA,OA=Ho,xA=wA,NA=SA,DA=IA,$A=RA,MA="[object Boolean]",LA="[object Date]",kA="[object Map]",FA="[object Number]",BA="[object RegExp]",UA="[object Set]",HA="[object String]",jA="[object Symbol]",VA="[object ArrayBuffer]",qA="[object DataView]",WA="[object Float32Array]",GA="[object Float64Array]",zA="[object Int8Array]",KA="[object Int16Array]",YA="[object Int32Array]",QA="[object Uint8Array]",XA="[object Uint8ClampedArray]",JA="[object Uint16Array]",ZA="[object Uint32Array]";function e2(t,e,n){var r=t.constructor;switch(e){case VA:return OA(t);case MA:case LA:return new r(+t);case qA:return xA(t,n);case WA:case GA:case zA:case KA:case YA:case QA:case XA:case JA:case ZA:return $A(t,n);case kA:return new r;case FA:case HA:return new r(t);case BA:return NA(t);case UA:return new r;case jA:return DA(t)}}var t2=e2,n2=Nt,Ul=Object.create,r2=function(){function t(){}return function(e){if(!n2(e))return{};if(Ul)return Ul(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),i2=r2,s2=i2,o2=mf,a2=No;function l2(t){return typeof t.constructor=="function"&&!a2(t)?s2(o2(t)):{}}var c2=l2,u2=wi,h2=xt,f2="[object Map]";function d2(t){return h2(t)&&u2(t)==f2}var p2=d2,g2=p2,m2=Oo,Hl=xo,jl=Hl&&Hl.isMap,_2=jl?m2(jl):g2,y2=_2,v2=wi,b2=xt,w2="[object Set]";function E2(t){return b2(t)&&v2(t)==w2}var C2=E2,S2=C2,T2=Oo,Vl=xo,ql=Vl&&Vl.isSet,I2=ql?T2(ql):S2,A2=I2,P2=Mo,R2=hI,O2=gf,x2=II,N2=VI,D2=qI,$2=GI,M2=QI,L2=lA,k2=nf,F2=dA,B2=wi,U2=_A,H2=t2,j2=c2,V2=qe,q2=Ao,W2=y2,G2=Nt,z2=A2,K2=or,Y2=Si,Q2=1,X2=2,J2=4,yf="[object Arguments]",Z2="[object Array]",eP="[object Boolean]",tP="[object Date]",nP="[object Error]",vf="[object Function]",rP="[object GeneratorFunction]",iP="[object Map]",sP="[object Number]",bf="[object Object]",oP="[object RegExp]",aP="[object Set]",lP="[object String]",cP="[object Symbol]",uP="[object WeakMap]",hP="[object ArrayBuffer]",fP="[object DataView]",dP="[object Float32Array]",pP="[object Float64Array]",gP="[object Int8Array]",mP="[object Int16Array]",_P="[object Int32Array]",yP="[object Uint8Array]",vP="[object Uint8ClampedArray]",bP="[object Uint16Array]",wP="[object Uint32Array]",H={};H[yf]=H[Z2]=H[hP]=H[fP]=H[eP]=H[tP]=H[dP]=H[pP]=H[gP]=H[mP]=H[_P]=H[iP]=H[sP]=H[bf]=H[oP]=H[aP]=H[lP]=H[cP]=H[yP]=H[vP]=H[bP]=H[wP]=!0;H[nP]=H[vf]=H[uP]=!1;function Sr(t,e,n,r,i,s){var o,a=e&Q2,l=e&X2,c=e&J2;if(n&&(o=i?n(t,r,i,s):n(t)),o!==void 0)return o;if(!G2(t))return t;var u=V2(t);if(u){if(o=U2(t),!a)return $2(t,o)}else{var f=B2(t),h=f==vf||f==rP;if(q2(t))return D2(t,a);if(f==bf||f==yf||h&&!i){if(o=l||h?{}:j2(t),!a)return l?L2(t,N2(o,t)):M2(t,x2(o,t))}else{if(!H[f])return i?t:{};o=H2(t,f,a)}}s||(s=new P2);var p=s.get(t);if(p)return p;s.set(t,o),z2(t)?t.forEach(function(m){o.add(Sr(m,e,n,m,t,s))}):W2(t)&&t.forEach(function(m,_){o.set(_,Sr(m,e,n,_,t,s))});var d=c?l?F2:k2:l?Y2:K2,g=u?void 0:d(t);return R2(g||t,function(m,_){g&&(_=m,m=t[_]),O2(o,_,Sr(m,e,n,_,t,s))}),o}var EP=Sr,CP=EP,SP=4;function TP(t){return CP(t,SP)}var IP=TP,Wl;function AP(){if(Wl)return yr;Wl=1;var t=B&&B.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(yr,"__esModule",{value:!0});var e=t(Af()),n=IP,r=function(){function i(s,o){o===void 0&&(o={}),this._src=s,this._opts=o,this._opts.filters=n(e.default.DefaultOpts.filters)}return i.prototype.maxColorCount=function(s){return this._opts.colorCount=s,this},i.prototype.maxDimension=function(s){return this._opts.maxDimension=s,this},i.prototype.addFilter=function(s){return this._opts.filters.push(s),this},i.prototype.removeFilter=function(s){var o=this._opts.filters.indexOf(s);return o>0&&this._opts.filters.splice(o),this},i.prototype.clearFilters=function(){return this._opts.filters=[],this},i.prototype.quality=function(s){return this._opts.quality=s,this},i.prototype.useImageClass=function(s){return this._opts.ImageClass=s,this},i.prototype.useGenerator=function(s){return this._opts.generator=s,this},i.prototype.useQuantizer=function(s){return this._opts.quantizer=s,this},i.prototype.build=function(){return new e.default(this._src,this._opts)},i.prototype.getPalette=function(s){return this.build().getPalette(s)},i.prototype.getSwatches=function(s){return this.build().getPalette(s)},i}();return yr.default=r,yr}var wf={},jo={},Vo={};Object.defineProperty(Vo,"__esModule",{value:!0});var Ce=rr,PP=function(){function t(e,n,r,i,s,o,a){this._volume=-1,this._count=-1,this.dimension={r1:e,r2:n,g1:r,g2:i,b1:s,b2:o},this.hist=a}return t.build=function(e,n){var r=1<<3*Ce.SIGBITS,i=new Uint32Array(r),s,o,a,l,c,u,f,h,p,d;s=a=c=0,o=l=u=Number.MAX_VALUE;for(var g=e.length/4,m=0;m<g;){var _=m*4;if(m++,f=e[_+0],h=e[_+1],p=e[_+2],d=e[_+3],d!==0){f=f>>Ce.RSHIFT,h=h>>Ce.RSHIFT,p=p>>Ce.RSHIFT;var y=Ce.getColorIndex(f,h,p);i[y]+=1,f>s&&(s=f),f<o&&(o=f),h>a&&(a=h),h<l&&(l=h),p>c&&(c=p),p<u&&(u=p)}}return new t(o,s,l,a,u,c,i)},t.prototype.invalidate=function(){this._volume=this._count=-1,this._avg=null},t.prototype.volume=function(){if(this._volume<0){var e=this.dimension,n=e.r1,r=e.r2,i=e.g1,s=e.g2,o=e.b1,a=e.b2;this._volume=(r-n+1)*(s-i+1)*(a-o+1)}return this._volume},t.prototype.count=function(){if(this._count<0){for(var e=this.hist,n=this.dimension,r=n.r1,i=n.r2,s=n.g1,o=n.g2,a=n.b1,l=n.b2,c=0,u=r;u<=i;u++)for(var f=s;f<=o;f++)for(var h=a;h<=l;h++){var p=Ce.getColorIndex(u,f,h);c+=e[p]}this._count=c}return this._count},t.prototype.clone=function(){var e=this.hist,n=this.dimension,r=n.r1,i=n.r2,s=n.g1,o=n.g2,a=n.b1,l=n.b2;return new t(r,i,s,o,a,l,e)},t.prototype.avg=function(){if(!this._avg){var e=this.hist,n=this.dimension,r=n.r1,i=n.r2,s=n.g1,o=n.g2,a=n.b1,l=n.b2,c=0,u=1<<8-Ce.SIGBITS,f=void 0,h=void 0,p=void 0;f=h=p=0;for(var d=r;d<=i;d++)for(var g=s;g<=o;g++)for(var m=a;m<=l;m++){var _=Ce.getColorIndex(d,g,m),y=e[_];c+=y,f+=y*(d+.5)*u,h+=y*(g+.5)*u,p+=y*(m+.5)*u}c?this._avg=[~~(f/c),~~(h/c),~~(p/c)]:this._avg=[~~(u*(r+i+1)/2),~~(u*(s+o+1)/2),~~(u*(a+l+1)/2)]}return this._avg},t.prototype.contains=function(e){var n=e[0],r=e[1],i=e[2],s=this.dimension,o=s.r1,a=s.r2,l=s.g1,c=s.g2,u=s.b1,f=s.b2;return n>>=Ce.RSHIFT,r>>=Ce.RSHIFT,i>>=Ce.RSHIFT,n>=o&&n<=a&&r>=l&&r<=c&&i>=u&&i<=f},t.prototype.split=function(){var e=this.hist,n=this.dimension,r=n.r1,i=n.r2,s=n.g1,o=n.g2,a=n.b1,l=n.b2,c=this.count();if(!c)return[];if(c===1)return[this.clone()];var u=i-r+1,f=o-s+1,h=l-a+1,p=Math.max(u,f,h),d=null,g,m;g=m=0;var _=null;if(p===u){_="r",d=new Uint32Array(i+1);for(var y=r;y<=i;y++){g=0;for(var w=s;w<=o;w++)for(var E=a;E<=l;E++){var C=Ce.getColorIndex(y,w,E);g+=e[C]}m+=g,d[y]=m}}else if(p===f){_="g",d=new Uint32Array(o+1);for(var w=s;w<=o;w++){g=0;for(var y=r;y<=i;y++)for(var E=a;E<=l;E++){var C=Ce.getColorIndex(y,w,E);g+=e[C]}m+=g,d[w]=m}}else{_="b",d=new Uint32Array(l+1);for(var E=a;E<=l;E++){g=0;for(var y=r;y<=i;y++)for(var w=s;w<=o;w++){var C=Ce.getColorIndex(y,w,E);g+=e[C]}m+=g,d[E]=m}}for(var I=-1,L=new Uint32Array(d.length),R=0;R<d.length;R++){var N=d[R];I<0&&N>m/2&&(I=R),L[R]=m-N}var q=this;function de(Y){var X=Y+"1",K=Y+"2",ee=q.dimension[X],M=q.dimension[K],De=q.clone(),Mt=q.clone(),Lt=I-ee,S=M-I;for(Lt<=S?(M=Math.min(M-1,~~(I+S/2)),M=Math.max(0,M)):(M=Math.max(ee,~~(I-1-Lt/2)),M=Math.min(q.dimension[K],M));!d[M];)M++;for(var P=L[M];!P&&d[M-1];)P=L[--M];return De.dimension[K]=M,Mt.dimension[X]=M+1,[De,Mt]}return de(_)},t}();Vo.default=PP;var qo={};Object.defineProperty(qo,"__esModule",{value:!0});var RP=function(){function t(e){this._comparator=e,this.contents=[],this._sorted=!1}return t.prototype._sort=function(){this._sorted||(this.contents.sort(this._comparator),this._sorted=!0)},t.prototype.push=function(e){this.contents.push(e),this._sorted=!1},t.prototype.peek=function(e){return this._sort(),e=typeof e=="number"?e:this.contents.length-1,this.contents[e]},t.prototype.pop=function(){return this._sort(),this.contents.pop()},t.prototype.size=function(){return this.contents.length},t.prototype.map=function(e){return this._sort(),this.contents.map(e)},t}();qo.default=RP;var Ef=B&&B.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(jo,"__esModule",{value:!0});var OP=fn,xP=Ef(Vo),Gl=Ef(qo),NP=.75;function zl(t,e){for(var n=t.size();t.size()<e;){var r=t.pop();if(r&&r.count()>0){var i=r.split(),s=i[0],o=i[1];if(t.push(s),o&&o.count()>0&&t.push(o),t.size()===n)break;n=t.size()}else break}}var DP=function(t,e){if(t.length===0||e.colorCount<2||e.colorCount>256)throw new Error("Wrong MMCQ parameters");var n=xP.default.build(t),r=n.hist;Object.keys(r).length;var i=new Gl.default(function(o,a){return o.count()-a.count()});i.push(n),zl(i,NP*e.colorCount);var s=new Gl.default(function(o,a){return o.count()*o.volume()-a.count()*a.volume()});return s.contents=i.contents,zl(s,e.colorCount-s.size()),$P(s)};function $P(t){for(var e=[];t.size();){var n=t.pop(),r=n.avg();r[0],r[1],r[2],e.push(new OP.Swatch(r,n.count()))}return e}jo.default=DP;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.WebWorker=void 0;var e=jo;Object.defineProperty(t,"MMCQ",{enumerable:!0,get:function(){return e.default}}),t.WebWorker=null})(wf);var Cf={},Wo={};function MP(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var LP=MP,kP=LP,Kl=Math.max;function FP(t,e,n){return e=Kl(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=Kl(r.length-e,0),o=Array(s);++i<s;)o[i]=r[e+i];i=-1;for(var a=Array(e+1);++i<e;)a[i]=r[i];return a[e]=n(o),kP(t,this,a)}}var BP=FP;function UP(t){return function(){return t}}var HP=UP,jP=HP,Yl=df,VP=Uo,qP=Yl?function(t,e){return Yl(t,"toString",{configurable:!0,enumerable:!1,value:jP(e),writable:!0})}:VP,WP=qP,GP=800,zP=16,KP=Date.now;function YP(t){var e=0,n=0;return function(){var r=KP(),i=zP-(r-n);if(n=r,i>0){if(++e>=GP)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var QP=YP,XP=WP,JP=QP,ZP=JP(XP),eR=ZP,tR=Uo,nR=BP,rR=eR;function iR(t,e){return rR(nR(t,e,tR),t+"")}var sR=iR,oR=ar,aR=mi,lR=Po,cR=Nt;function uR(t,e,n){if(!cR(n))return!1;var r=typeof e;return(r=="number"?aR(n)&&lR(e,n.length):r=="string"&&e in n)?oR(n[e],t):!1}var hR=uR,fR=sR,dR=ar,pR=hR,gR=Si,Sf=Object.prototype,mR=Sf.hasOwnProperty,_R=fR(function(t,e){t=Object(t);var n=-1,r=e.length,i=r>2?e[2]:void 0;for(i&&pR(e[0],e[1],i)&&(r=1);++n<r;)for(var s=e[n],o=gR(s),a=-1,l=o.length;++a<l;){var c=o[a],u=t[c];(u===void 0||dR(u,Sf[c])&&!mR.call(t,c))&&(t[c]=s[c])}return t}),Tf=_R;Object.defineProperty(Wo,"__esModule",{value:!0});var Ge=fn,ze=rr,yR=Tf,vR={targetDarkLuma:.26,maxDarkLuma:.45,minLightLuma:.55,targetLightLuma:.74,minNormalLuma:.3,targetNormalLuma:.5,maxNormalLuma:.7,targetMutesSaturation:.3,maxMutesSaturation:.4,targetVibrantSaturation:1,minVibrantSaturation:.35,weightSaturation:3,weightLuma:6.5,weightPopulation:.5};function bR(t){var e=0;return t.forEach(function(n){e=Math.max(e,n.getPopulation())}),e}function wR(t,e){return t.Vibrant===e||t.DarkVibrant===e||t.LightVibrant===e||t.Muted===e||t.DarkMuted===e||t.LightMuted===e}function ER(t,e,n,r,i,s,o){function a(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];for(var f=0,h=0,p=0;p<c.length;p+=2){var d=c[p],g=c[p+1];f+=d*g,h+=g}return f/h}function l(c,u){return 1-Math.abs(c-u)}return a(l(t,e),o.weightSaturation,l(n,r),o.weightLuma,i/s,o.weightPopulation)}function Ft(t,e,n,r,i,s,o,a,l,c){var u=null,f=0;return e.forEach(function(h){var p=h.getHsl(),d=p[1],g=p[2];if(d>=a&&d<=l&&g>=i&&g<=s&&!wR(t,h)){var m=ER(d,o,g,r,h.getPopulation(),n,c);(u===null||m>f)&&(u=h,f=m)}}),u}function CR(t,e,n){var r={};return r.Vibrant=Ft(r,t,e,n.targetNormalLuma,n.minNormalLuma,n.maxNormalLuma,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),r.LightVibrant=Ft(r,t,e,n.targetLightLuma,n.minLightLuma,1,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),r.DarkVibrant=Ft(r,t,e,n.targetDarkLuma,0,n.maxDarkLuma,n.targetVibrantSaturation,n.minVibrantSaturation,1,n),r.Muted=Ft(r,t,e,n.targetNormalLuma,n.minNormalLuma,n.maxNormalLuma,n.targetMutesSaturation,0,n.maxMutesSaturation,n),r.LightMuted=Ft(r,t,e,n.targetLightLuma,n.minLightLuma,1,n.targetMutesSaturation,0,n.maxMutesSaturation,n),r.DarkMuted=Ft(r,t,e,n.targetDarkLuma,0,n.maxDarkLuma,n.targetMutesSaturation,0,n.maxMutesSaturation,n),r}function SR(t,e,n){if(t.Vibrant===null&&t.DarkVibrant===null&&t.LightVibrant===null){if(t.DarkVibrant===null&&t.DarkMuted!==null){var r=t.DarkMuted.getHsl(),i=r[0],s=r[1],o=r[2];o=n.targetDarkLuma,t.DarkVibrant=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}if(t.LightVibrant===null&&t.LightMuted!==null){var a=t.LightMuted.getHsl(),i=a[0],s=a[1],o=a[2];o=n.targetDarkLuma,t.DarkVibrant=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}}if(t.Vibrant===null&&t.DarkVibrant!==null){var l=t.DarkVibrant.getHsl(),i=l[0],s=l[1],o=l[2];o=n.targetNormalLuma,t.Vibrant=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}else if(t.Vibrant===null&&t.LightVibrant!==null){var c=t.LightVibrant.getHsl(),i=c[0],s=c[1],o=c[2];o=n.targetNormalLuma,t.Vibrant=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}if(t.DarkVibrant===null&&t.Vibrant!==null){var u=t.Vibrant.getHsl(),i=u[0],s=u[1],o=u[2];o=n.targetDarkLuma,t.DarkVibrant=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}if(t.LightVibrant===null&&t.Vibrant!==null){var f=t.Vibrant.getHsl(),i=f[0],s=f[1],o=f[2];o=n.targetLightLuma,t.LightVibrant=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}if(t.Muted===null&&t.Vibrant!==null){var h=t.Vibrant.getHsl(),i=h[0],s=h[1],o=h[2];o=n.targetMutesSaturation,t.Muted=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}if(t.DarkMuted===null&&t.DarkVibrant!==null){var p=t.DarkVibrant.getHsl(),i=p[0],s=p[1],o=p[2];o=n.targetMutesSaturation,t.DarkMuted=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}if(t.LightMuted===null&&t.LightVibrant!==null){var d=t.LightVibrant.getHsl(),i=d[0],s=d[1],o=d[2];o=n.targetMutesSaturation,t.LightMuted=new Ge.Swatch(ze.hslToRgb(i,s,o),0)}}var TR=function(t,e){e=yR({},e,vR);var n=bR(t),r=CR(t,n,e);return SR(r,n,e),r};Wo.default=TR;(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Wo;Object.defineProperty(t,"Default",{enumerable:!0,get:function(){return e.default}})})(Cf);var If={},Go={};Object.defineProperty(Go,"__esModule",{value:!0});function IR(t,e,n,r){return r>=125&&!(t>250&&e>250&&n>250)}Go.default=IR;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.combineFilters=void 0;var e=Go;Object.defineProperty(t,"Default",{enumerable:!0,get:function(){return e.default}});function n(r){return!Array.isArray(r)||r.length===0?null:function(i,s,o,a){if(a===0)return!1;for(var l=0;l<r.length;l++)if(!r[l](i,s,o,a))return!1;return!0}}t.combineFilters=n})(If);var Ql;function Af(){if(Ql)return mr;Ql=1;var t=B&&B.__createBinding||(Object.create?function(h,p,d,g){g===void 0&&(g=d),Object.defineProperty(h,g,{enumerable:!0,get:function(){return p[d]}})}:function(h,p,d,g){g===void 0&&(g=d),h[g]=p[d]}),e=B&&B.__setModuleDefault||(Object.create?function(h,p){Object.defineProperty(h,"default",{enumerable:!0,value:p})}:function(h,p){h.default=p}),n=B&&B.__importStar||function(h){if(h&&h.__esModule)return h;var p={};if(h!=null)for(var d in h)d!=="default"&&Object.hasOwnProperty.call(h,d)&&t(p,h,d);return e(p,h),p},r=B&&B.__importDefault||function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(mr,"__esModule",{value:!0});var i=fn,s=r(AP()),o=n(rr),a=n(wf),l=n(Cf),c=n(If),u=Tf,f=function(){function h(p,d){this._src=p,this.opts=u({},d,h.DefaultOpts),this.opts.combinedFilter=c.combineFilters(this.opts.filters)}return h.from=function(p){return new s.default(p)},h.prototype._process=function(p,d){var g=d.quantizer,m=d.generator;return p.scaleDown(d),p.applyFilter(d.combinedFilter).then(function(_){return g(_.data,d)}).then(function(_){return i.Swatch.applyFilter(_,d.combinedFilter)}).then(function(_){return Promise.resolve(m(_))})},h.prototype.palette=function(){return this.swatches()},h.prototype.swatches=function(){return this._palette},h.prototype.getPalette=function(p){var d=this,g=new this.opts.ImageClass,m=g.load(this._src).then(function(_){return d._process(_,d.opts)}).then(function(_){return d._palette=_,g.remove(),_},function(_){throw g.remove(),_});return p&&m.then(function(_){return p(null,_)},function(_){return p(_)}),m},h.Builder=s.default,h.Quantizer=a,h.Generator=l,h.Filter=c,h.Util=o,h.Swatch=i.Swatch,h.DefaultOpts={colorCount:64,quality:5,generator:l.Default,ImageClass:null,quantizer:a.MMCQ,filters:[c.Default]},h}();return mr.default=f,mr}var zo={},Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});Ti.ImageBase=void 0;var AR=function(){function t(){}return t.prototype.scaleDown=function(e){var n=this.getWidth(),r=this.getHeight(),i=1;if(e.maxDimension>0){var s=Math.max(n,r);s>e.maxDimension&&(i=e.maxDimension/s)}else i=1/e.quality;i<1&&this.resize(n*i,r*i,i)},t.prototype.applyFilter=function(e){var n=this.getImageData();if(typeof e=="function")for(var r=n.data,i=r.length/4,s=void 0,o=void 0,a=void 0,l=void 0,c=void 0,u=0;u<i;u++)s=u*4,o=r[s+0],a=r[s+1],l=r[s+2],c=r[s+3],e(o,a,l,c)||(r[s+3]=0);return Promise.resolve(n)},t}();Ti.ImageBase=AR;var yn={},Qr={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */Qr.exports;(function(t,e){(function(n){var r=e&&!e.nodeType&&e,i=t&&!t.nodeType&&t,s=typeof B=="object"&&B;(s.global===s||s.window===s||s.self===s)&&(n=s);var o,a=2147483647,l=36,c=1,u=26,f=38,h=700,p=72,d=128,g="-",m=/^xn--/,_=/[^\x20-\x7E]/,y=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},E=l-c,C=Math.floor,I=String.fromCharCode,L;function R(S){throw new RangeError(w[S])}function N(S,P){for(var F=S.length,Q=[];F--;)Q[F]=P(S[F]);return Q}function q(S,P){var F=S.split("@"),Q="";F.length>1&&(Q=F[0]+"@",S=F[1]),S=S.replace(y,".");var te=S.split("."),be=N(te,P).join(".");return Q+be}function de(S){for(var P=[],F=0,Q=S.length,te,be;F<Q;)te=S.charCodeAt(F++),te>=55296&&te<=56319&&F<Q?(be=S.charCodeAt(F++),(be&64512)==56320?P.push(((te&1023)<<10)+(be&1023)+65536):(P.push(te),F--)):P.push(te);return P}function Y(S){return N(S,function(P){var F="";return P>65535&&(P-=65536,F+=I(P>>>10&1023|55296),P=56320|P&1023),F+=I(P),F}).join("")}function X(S){return S-48<10?S-22:S-65<26?S-65:S-97<26?S-97:l}function K(S,P){return S+22+75*(S<26)-((P!=0)<<5)}function ee(S,P,F){var Q=0;for(S=F?C(S/h):S>>1,S+=C(S/P);S>E*u>>1;Q+=l)S=C(S/E);return C(Q+(E+1)*S/(S+f))}function M(S){var P=[],F=S.length,Q,te=0,be=d,pe=p,Ae,$e,Ue,We,me,xe,Me,tt,gt;for(Ae=S.lastIndexOf(g),Ae<0&&(Ae=0),$e=0;$e<Ae;++$e)S.charCodeAt($e)>=128&&R("not-basic"),P.push(S.charCodeAt($e));for(Ue=Ae>0?Ae+1:0;Ue<F;){for(We=te,me=1,xe=l;Ue>=F&&R("invalid-input"),Me=X(S.charCodeAt(Ue++)),(Me>=l||Me>C((a-te)/me))&&R("overflow"),te+=Me*me,tt=xe<=pe?c:xe>=pe+u?u:xe-pe,!(Me<tt);xe+=l)gt=l-tt,me>C(a/gt)&&R("overflow"),me*=gt;Q=P.length+1,pe=ee(te-We,Q,We==0),C(te/Q)>a-be&&R("overflow"),be+=C(te/Q),te%=Q,P.splice(te++,0,be)}return Y(P)}function De(S){var P,F,Q,te,be,pe,Ae,$e,Ue,We,me,xe=[],Me,tt,gt,Pi;for(S=de(S),Me=S.length,P=d,F=0,be=p,pe=0;pe<Me;++pe)me=S[pe],me<128&&xe.push(I(me));for(Q=te=xe.length,te&&xe.push(g);Q<Me;){for(Ae=a,pe=0;pe<Me;++pe)me=S[pe],me>=P&&me<Ae&&(Ae=me);for(tt=Q+1,Ae-P>C((a-F)/tt)&&R("overflow"),F+=(Ae-P)*tt,P=Ae,pe=0;pe<Me;++pe)if(me=S[pe],me<P&&++F>a&&R("overflow"),me==P){for($e=F,Ue=l;We=Ue<=be?c:Ue>=be+u?u:Ue-be,!($e<We);Ue+=l)Pi=$e-We,gt=l-We,xe.push(I(K(We+Pi%gt,0))),$e=C(Pi/gt);xe.push(I(K($e,0))),be=ee(F,tt,Q==te),F=0,++Q}++F,++P}return xe.join("")}function Mt(S){return q(S,function(P){return m.test(P)?M(P.slice(4).toLowerCase()):P})}function Lt(S){return q(S,function(P){return _.test(P)?"xn--"+De(P):P})}if(o={version:"1.4.1",ucs2:{decode:de,encode:Y},decode:M,encode:De,toASCII:Lt,toUnicode:Mt},r&&i)if(t.exports==r)i.exports=o;else for(L in o)o.hasOwnProperty(L)&&(r[L]=o[L]);else n.punycode=o})(B)})(Qr,Qr.exports);var PR=Qr.exports,RR=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},n=Symbol("test"),r=Object(n);if(typeof n=="string"||Object.prototype.toString.call(n)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var i=42;e[n]=i;for(n in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==n||!Object.prototype.propertyIsEnumerable.call(e,n))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,n);if(o.value!==i||o.enumerable!==!0)return!1}return!0},Xl=typeof Symbol<"u"&&Symbol,OR=RR,xR=function(){return typeof Xl!="function"||typeof Symbol!="function"||typeof Xl("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:OR()},Jl={foo:{}},NR=Object,DR=function(){return{__proto__:Jl}.foo===Jl.foo&&!({__proto__:null}instanceof NR)},$R="Function.prototype.bind called on incompatible ",MR=Object.prototype.toString,LR=Math.max,kR="[object Function]",Zl=function(e,n){for(var r=[],i=0;i<e.length;i+=1)r[i]=e[i];for(var s=0;s<n.length;s+=1)r[s+e.length]=n[s];return r},FR=function(e,n){for(var r=[],i=n||0,s=0;i<e.length;i+=1,s+=1)r[s]=e[i];return r},BR=function(t,e){for(var n="",r=0;r<t.length;r+=1)n+=t[r],r+1<t.length&&(n+=e);return n},UR=function(e){var n=this;if(typeof n!="function"||MR.apply(n)!==kR)throw new TypeError($R+n);for(var r=FR(arguments,1),i,s=function(){if(this instanceof i){var u=n.apply(this,Zl(r,arguments));return Object(u)===u?u:this}return n.apply(e,Zl(r,arguments))},o=LR(0,n.length-r.length),a=[],l=0;l<o;l++)a[l]="$"+l;if(i=Function("binder","return function ("+BR(a,",")+"){ return binder.apply(this,arguments); }")(s),n.prototype){var c=function(){};c.prototype=n.prototype,i.prototype=new c,c.prototype=null}return i},HR=UR,Ko=Function.prototype.bind||HR,jR=Function.prototype.call,VR=Object.prototype.hasOwnProperty,qR=Ko,WR=qR.call(jR,VR),D,sn=SyntaxError,Pf=Function,Xt=TypeError,qi=function(t){try{return Pf('"use strict"; return ('+t+").constructor;")()}catch{}},Ct=Object.getOwnPropertyDescriptor;if(Ct)try{Ct({},"")}catch{Ct=null}var Wi=function(){throw new Xt},GR=Ct?function(){try{return arguments.callee,Wi}catch{try{return Ct(arguments,"callee").get}catch{return Wi}}}():Wi,Bt=xR(),zR=DR(),ae=Object.getPrototypeOf||(zR?function(t){return t.__proto__}:null),Vt={},KR=typeof Uint8Array>"u"||!ae?D:ae(Uint8Array),St={"%AggregateError%":typeof AggregateError>"u"?D:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?D:ArrayBuffer,"%ArrayIteratorPrototype%":Bt&&ae?ae([][Symbol.iterator]()):D,"%AsyncFromSyncIteratorPrototype%":D,"%AsyncFunction%":Vt,"%AsyncGenerator%":Vt,"%AsyncGeneratorFunction%":Vt,"%AsyncIteratorPrototype%":Vt,"%Atomics%":typeof Atomics>"u"?D:Atomics,"%BigInt%":typeof BigInt>"u"?D:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?D:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?D:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?D:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?D:Float32Array,"%Float64Array%":typeof Float64Array>"u"?D:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?D:FinalizationRegistry,"%Function%":Pf,"%GeneratorFunction%":Vt,"%Int8Array%":typeof Int8Array>"u"?D:Int8Array,"%Int16Array%":typeof Int16Array>"u"?D:Int16Array,"%Int32Array%":typeof Int32Array>"u"?D:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Bt&&ae?ae(ae([][Symbol.iterator]())):D,"%JSON%":typeof JSON=="object"?JSON:D,"%Map%":typeof Map>"u"?D:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Bt||!ae?D:ae(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?D:Promise,"%Proxy%":typeof Proxy>"u"?D:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?D:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?D:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Bt||!ae?D:ae(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?D:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Bt&&ae?ae(""[Symbol.iterator]()):D,"%Symbol%":Bt?Symbol:D,"%SyntaxError%":sn,"%ThrowTypeError%":GR,"%TypedArray%":KR,"%TypeError%":Xt,"%Uint8Array%":typeof Uint8Array>"u"?D:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?D:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?D:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?D:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?D:WeakMap,"%WeakRef%":typeof WeakRef>"u"?D:WeakRef,"%WeakSet%":typeof WeakSet>"u"?D:WeakSet};if(ae)try{null.error}catch(t){var YR=ae(ae(t));St["%Error.prototype%"]=YR}var QR=function t(e){var n;if(e==="%AsyncFunction%")n=qi("async function () {}");else if(e==="%GeneratorFunction%")n=qi("function* () {}");else if(e==="%AsyncGeneratorFunction%")n=qi("async function* () {}");else if(e==="%AsyncGenerator%"){var r=t("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var i=t("%AsyncGenerator%");i&&ae&&(n=ae(i.prototype))}return St[e]=n,n},ec={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},lr=Ko,Xr=WR,XR=lr.call(Function.call,Array.prototype.concat),JR=lr.call(Function.apply,Array.prototype.splice),tc=lr.call(Function.call,String.prototype.replace),Jr=lr.call(Function.call,String.prototype.slice),ZR=lr.call(Function.call,RegExp.prototype.exec),eO=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,tO=/\\(\\)?/g,nO=function(e){var n=Jr(e,0,1),r=Jr(e,-1);if(n==="%"&&r!=="%")throw new sn("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&n!=="%")throw new sn("invalid intrinsic syntax, expected opening `%`");var i=[];return tc(e,eO,function(s,o,a,l){i[i.length]=a?tc(l,tO,"$1"):o||s}),i},rO=function(e,n){var r=e,i;if(Xr(ec,r)&&(i=ec[r],r="%"+i[0]+"%"),Xr(St,r)){var s=St[r];if(s===Vt&&(s=QR(r)),typeof s>"u"&&!n)throw new Xt("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:i,name:r,value:s}}throw new sn("intrinsic "+e+" does not exist!")},$t=function(e,n){if(typeof e!="string"||e.length===0)throw new Xt("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof n!="boolean")throw new Xt('"allowMissing" argument must be a boolean');if(ZR(/^%?[^%]*%?$/,e)===null)throw new sn("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=nO(e),i=r.length>0?r[0]:"",s=rO("%"+i+"%",n),o=s.name,a=s.value,l=!1,c=s.alias;c&&(i=c[0],JR(r,XR([0,1],c)));for(var u=1,f=!0;u<r.length;u+=1){var h=r[u],p=Jr(h,0,1),d=Jr(h,-1);if((p==='"'||p==="'"||p==="`"||d==='"'||d==="'"||d==="`")&&p!==d)throw new sn("property names with quotes must have matching quotes");if((h==="constructor"||!f)&&(l=!0),i+="."+h,o="%"+i+"%",Xr(St,o))a=St[o];else if(a!=null){if(!(h in a)){if(!n)throw new Xt("base intrinsic for "+e+" exists, but the property is not available.");return}if(Ct&&u+1>=r.length){var g=Ct(a,h);f=!!g,f&&"get"in g&&!("originalValue"in g.get)?a=g.get:a=a[h]}else f=Xr(a,h),a=a[h];f&&!l&&(St[o]=a)}}return a},Rf={exports:{}},iO=$t,Rs=iO("%Object.defineProperty%",!0),Os=function(){if(Rs)try{return Rs({},"a",{value:1}),!0}catch{return!1}return!1};Os.hasArrayLengthDefineBug=function(){if(!Os())return null;try{return Rs([],"length",{value:1}).length!==1}catch{return!0}};var Of=Os,sO=$t,Tr=sO("%Object.getOwnPropertyDescriptor%",!0);if(Tr)try{Tr([],"length")}catch{Tr=null}var xf=Tr,oO=Of(),Yo=$t,Nn=oO&&Yo("%Object.defineProperty%",!0);if(Nn)try{Nn({},"a",{value:1})}catch{Nn=!1}var aO=Yo("%SyntaxError%"),Ut=Yo("%TypeError%"),nc=xf,lO=function(e,n,r){if(!e||typeof e!="object"&&typeof e!="function")throw new Ut("`obj` must be an object or a function`");if(typeof n!="string"&&typeof n!="symbol")throw new Ut("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Ut("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Ut("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Ut("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Ut("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,s=arguments.length>4?arguments[4]:null,o=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!nc&&nc(e,n);if(Nn)Nn(e,n,{configurable:o===null&&l?l.configurable:!o,enumerable:i===null&&l?l.enumerable:!i,value:r,writable:s===null&&l?l.writable:!s});else if(a||!i&&!s&&!o)e[n]=r;else throw new aO("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Nf=$t,rc=lO,cO=Of(),ic=xf,sc=Nf("%TypeError%"),uO=Nf("%Math.floor%"),hO=function(e,n){if(typeof e!="function")throw new sc("`fn` is not a function");if(typeof n!="number"||n<0||n>4294967295||uO(n)!==n)throw new sc("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],i=!0,s=!0;if("length"in e&&ic){var o=ic(e,"length");o&&!o.configurable&&(i=!1),o&&!o.writable&&(s=!1)}return(i||s||!r)&&(cO?rc(e,"length",n,!0,!0):rc(e,"length",n)),e};(function(t){var e=Ko,n=$t,r=hO,i=n("%TypeError%"),s=n("%Function.prototype.apply%"),o=n("%Function.prototype.call%"),a=n("%Reflect.apply%",!0)||e.call(o,s),l=n("%Object.defineProperty%",!0),c=n("%Math.max%");if(l)try{l({},"a",{value:1})}catch{l=null}t.exports=function(h){if(typeof h!="function")throw new i("a function is required");var p=a(e,o,arguments);return r(p,1+c(0,h.length-(arguments.length-1)),!0)};var u=function(){return a(e,s,arguments)};l?l(t.exports,"apply",{value:u}):t.exports.apply=u})(Rf);var fO=Rf.exports,Df=$t,$f=fO,dO=$f(Df("String.prototype.indexOf")),pO=function(e,n){var r=Df(e,!!n);return typeof r=="function"&&dO(e,".prototype.")>-1?$f(r):r};const gO={},mO=Object.freeze(Object.defineProperty({__proto__:null,default:gO},Symbol.toStringTag,{value:"Module"})),_O=Dv(mO);var Qo=typeof Map=="function"&&Map.prototype,Gi=Object.getOwnPropertyDescriptor&&Qo?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Zr=Qo&&Gi&&typeof Gi.get=="function"?Gi.get:null,oc=Qo&&Map.prototype.forEach,Xo=typeof Set=="function"&&Set.prototype,zi=Object.getOwnPropertyDescriptor&&Xo?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,ei=Xo&&zi&&typeof zi.get=="function"?zi.get:null,ac=Xo&&Set.prototype.forEach,yO=typeof WeakMap=="function"&&WeakMap.prototype,Dn=yO?WeakMap.prototype.has:null,vO=typeof WeakSet=="function"&&WeakSet.prototype,$n=vO?WeakSet.prototype.has:null,bO=typeof WeakRef=="function"&&WeakRef.prototype,lc=bO?WeakRef.prototype.deref:null,wO=Boolean.prototype.valueOf,EO=Object.prototype.toString,CO=Function.prototype.toString,SO=String.prototype.match,Jo=String.prototype.slice,it=String.prototype.replace,TO=String.prototype.toUpperCase,cc=String.prototype.toLowerCase,Mf=RegExp.prototype.test,uc=Array.prototype.concat,je=Array.prototype.join,IO=Array.prototype.slice,hc=Math.floor,xs=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Ki=Object.getOwnPropertySymbols,Ns=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,on=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ve=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===on||"symbol")?Symbol.toStringTag:null,Lf=Object.prototype.propertyIsEnumerable,fc=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function dc(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||Mf.call(/e/,e))return e;var n=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var r=t<0?-hc(-t):hc(t);if(r!==t){var i=String(r),s=Jo.call(e,i.length+1);return it.call(i,n,"$&_")+"."+it.call(it.call(s,/([0-9]{3})/g,"$&_"),/_$/,"")}}return it.call(e,n,"$&_")}var Ds=_O,pc=Ds.custom,gc=Ff(pc)?pc:null,AO=function t(e,n,r,i){var s=n||{};if(nt(s,"quoteStyle")&&s.quoteStyle!=="single"&&s.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(nt(s,"maxStringLength")&&(typeof s.maxStringLength=="number"?s.maxStringLength<0&&s.maxStringLength!==1/0:s.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=nt(s,"customInspect")?s.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(nt(s,"indent")&&s.indent!==null&&s.indent!=="	"&&!(parseInt(s.indent,10)===s.indent&&s.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(nt(s,"numericSeparator")&&typeof s.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var a=s.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return Uf(e,s);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var l=String(e);return a?dc(e,l):l}if(typeof e=="bigint"){var c=String(e)+"n";return a?dc(e,c):c}var u=typeof s.depth>"u"?5:s.depth;if(typeof r>"u"&&(r=0),r>=u&&u>0&&typeof e=="object")return $s(e)?"[Array]":"[Object]";var f=WO(s,r);if(typeof i>"u")i=[];else if(Bf(i,e)>=0)return"[Circular]";function h(X,K,ee){if(K&&(i=IO.call(i),i.push(K)),ee){var M={depth:s.depth};return nt(s,"quoteStyle")&&(M.quoteStyle=s.quoteStyle),t(X,M,r+1,i)}return t(X,s,r+1,i)}if(typeof e=="function"&&!mc(e)){var p=LO(e),d=vr(e,h);return"[Function"+(p?": "+p:" (anonymous)")+"]"+(d.length>0?" { "+je.call(d,", ")+" }":"")}if(Ff(e)){var g=on?it.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):Ns.call(e);return typeof e=="object"&&!on?In(g):g}if(jO(e)){for(var m="<"+cc.call(String(e.nodeName)),_=e.attributes||[],y=0;y<_.length;y++)m+=" "+_[y].name+"="+kf(PO(_[y].value),"double",s);return m+=">",e.childNodes&&e.childNodes.length&&(m+="..."),m+="</"+cc.call(String(e.nodeName))+">",m}if($s(e)){if(e.length===0)return"[]";var w=vr(e,h);return f&&!qO(w)?"["+Ms(w,f)+"]":"[ "+je.call(w,", ")+" ]"}if(OO(e)){var E=vr(e,h);return!("cause"in Error.prototype)&&"cause"in e&&!Lf.call(e,"cause")?"{ ["+String(e)+"] "+je.call(uc.call("[cause]: "+h(e.cause),E),", ")+" }":E.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+je.call(E,", ")+" }"}if(typeof e=="object"&&o){if(gc&&typeof e[gc]=="function"&&Ds)return Ds(e,{depth:u-r});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(kO(e)){var C=[];return oc&&oc.call(e,function(X,K){C.push(h(K,e,!0)+" => "+h(X,e))}),_c("Map",Zr.call(e),C,f)}if(UO(e)){var I=[];return ac&&ac.call(e,function(X){I.push(h(X,e))}),_c("Set",ei.call(e),I,f)}if(FO(e))return Yi("WeakMap");if(HO(e))return Yi("WeakSet");if(BO(e))return Yi("WeakRef");if(NO(e))return In(h(Number(e)));if($O(e))return In(h(xs.call(e)));if(DO(e))return In(wO.call(e));if(xO(e))return In(h(String(e)));if(typeof window<"u"&&e===window)return"{ [object Window] }";if(e===B)return"{ [object globalThis] }";if(!RO(e)&&!mc(e)){var L=vr(e,h),R=fc?fc(e)===Object.prototype:e instanceof Object||e.constructor===Object,N=e instanceof Object?"":"null prototype",q=!R&&ve&&Object(e)===e&&ve in e?Jo.call(pt(e),8,-1):N?"Object":"",de=R||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",Y=de+(q||N?"["+je.call(uc.call([],q||[],N||[]),": ")+"] ":"");return L.length===0?Y+"{}":f?Y+"{"+Ms(L,f)+"}":Y+"{ "+je.call(L,", ")+" }"}return String(e)};function kf(t,e,n){var r=(n.quoteStyle||e)==="double"?'"':"'";return r+t+r}function PO(t){return it.call(String(t),/"/g,"&quot;")}function $s(t){return pt(t)==="[object Array]"&&(!ve||!(typeof t=="object"&&ve in t))}function RO(t){return pt(t)==="[object Date]"&&(!ve||!(typeof t=="object"&&ve in t))}function mc(t){return pt(t)==="[object RegExp]"&&(!ve||!(typeof t=="object"&&ve in t))}function OO(t){return pt(t)==="[object Error]"&&(!ve||!(typeof t=="object"&&ve in t))}function xO(t){return pt(t)==="[object String]"&&(!ve||!(typeof t=="object"&&ve in t))}function NO(t){return pt(t)==="[object Number]"&&(!ve||!(typeof t=="object"&&ve in t))}function DO(t){return pt(t)==="[object Boolean]"&&(!ve||!(typeof t=="object"&&ve in t))}function Ff(t){if(on)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!Ns)return!1;try{return Ns.call(t),!0}catch{}return!1}function $O(t){if(!t||typeof t!="object"||!xs)return!1;try{return xs.call(t),!0}catch{}return!1}var MO=Object.prototype.hasOwnProperty||function(t){return t in this};function nt(t,e){return MO.call(t,e)}function pt(t){return EO.call(t)}function LO(t){if(t.name)return t.name;var e=SO.call(CO.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function Bf(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0,r=t.length;n<r;n++)if(t[n]===e)return n;return-1}function kO(t){if(!Zr||!t||typeof t!="object")return!1;try{Zr.call(t);try{ei.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function FO(t){if(!Dn||!t||typeof t!="object")return!1;try{Dn.call(t,Dn);try{$n.call(t,$n)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function BO(t){if(!lc||!t||typeof t!="object")return!1;try{return lc.call(t),!0}catch{}return!1}function UO(t){if(!ei||!t||typeof t!="object")return!1;try{ei.call(t);try{Zr.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function HO(t){if(!$n||!t||typeof t!="object")return!1;try{$n.call(t,$n);try{Dn.call(t,Dn)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function jO(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function Uf(t,e){if(t.length>e.maxStringLength){var n=t.length-e.maxStringLength,r="... "+n+" more character"+(n>1?"s":"");return Uf(Jo.call(t,0,e.maxStringLength),e)+r}var i=it.call(it.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,VO);return kf(i,"single",e)}function VO(t){var e=t.charCodeAt(0),n={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return n?"\\"+n:"\\x"+(e<16?"0":"")+TO.call(e.toString(16))}function In(t){return"Object("+t+")"}function Yi(t){return t+" { ? }"}function _c(t,e,n,r){var i=r?Ms(n,r):je.call(n,", ");return t+" ("+e+") {"+i+"}"}function qO(t){for(var e=0;e<t.length;e++)if(Bf(t[e],`
`)>=0)return!1;return!0}function WO(t,e){var n;if(t.indent==="	")n="	";else if(typeof t.indent=="number"&&t.indent>0)n=je.call(Array(t.indent+1)," ");else return null;return{base:n,prev:je.call(Array(e+1),n)}}function Ms(t,e){if(t.length===0)return"";var n=`
`+e.prev+e.base;return n+je.call(t,","+n)+`
`+e.prev}function vr(t,e){var n=$s(t),r=[];if(n){r.length=t.length;for(var i=0;i<t.length;i++)r[i]=nt(t,i)?e(t[i],t):""}var s=typeof Ki=="function"?Ki(t):[],o;if(on){o={};for(var a=0;a<s.length;a++)o["$"+s[a]]=s[a]}for(var l in t)nt(t,l)&&(n&&String(Number(l))===l&&l<t.length||on&&o["$"+l]instanceof Symbol||(Mf.call(/[^\w$]/,l)?r.push(e(l,t)+": "+e(t[l],t)):r.push(l+": "+e(t[l],t))));if(typeof Ki=="function")for(var c=0;c<s.length;c++)Lf.call(t,s[c])&&r.push("["+e(s[c])+"]: "+e(t[s[c]],t));return r}var Zo=$t,vn=pO,GO=AO,zO=Zo("%TypeError%"),br=Zo("%WeakMap%",!0),wr=Zo("%Map%",!0),KO=vn("WeakMap.prototype.get",!0),YO=vn("WeakMap.prototype.set",!0),QO=vn("WeakMap.prototype.has",!0),XO=vn("Map.prototype.get",!0),JO=vn("Map.prototype.set",!0),ZO=vn("Map.prototype.has",!0),ea=function(t,e){for(var n=t,r;(r=n.next)!==null;n=r)if(r.key===e)return n.next=r.next,r.next=t.next,t.next=r,r},ex=function(t,e){var n=ea(t,e);return n&&n.value},tx=function(t,e,n){var r=ea(t,e);r?r.value=n:t.next={key:e,next:t.next,value:n}},nx=function(t,e){return!!ea(t,e)},rx=function(){var e,n,r,i={assert:function(s){if(!i.has(s))throw new zO("Side channel does not contain "+GO(s))},get:function(s){if(br&&s&&(typeof s=="object"||typeof s=="function")){if(e)return KO(e,s)}else if(wr){if(n)return XO(n,s)}else if(r)return ex(r,s)},has:function(s){if(br&&s&&(typeof s=="object"||typeof s=="function")){if(e)return QO(e,s)}else if(wr){if(n)return ZO(n,s)}else if(r)return nx(r,s);return!1},set:function(s,o){br&&s&&(typeof s=="object"||typeof s=="function")?(e||(e=new br),YO(e,s,o)):wr?(n||(n=new wr),JO(n,s,o)):(r||(r={key:{},next:null}),tx(r,s,o))}};return i},ix=String.prototype.replace,sx=/%20/g,Qi={RFC1738:"RFC1738",RFC3986:"RFC3986"},ta={default:Qi.RFC3986,formatters:{RFC1738:function(t){return ix.call(t,sx,"+")},RFC3986:function(t){return String(t)}},RFC1738:Qi.RFC1738,RFC3986:Qi.RFC3986},ox=ta,Xi=Object.prototype.hasOwnProperty,vt=Array.isArray,He=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),ax=function(e){for(;e.length>1;){var n=e.pop(),r=n.obj[n.prop];if(vt(r)){for(var i=[],s=0;s<r.length;++s)typeof r[s]<"u"&&i.push(r[s]);n.obj[n.prop]=i}}},Hf=function(e,n){for(var r=n&&n.plainObjects?Object.create(null):{},i=0;i<e.length;++i)typeof e[i]<"u"&&(r[i]=e[i]);return r},lx=function t(e,n,r){if(!n)return e;if(typeof n!="object"){if(vt(e))e.push(n);else if(e&&typeof e=="object")(r&&(r.plainObjects||r.allowPrototypes)||!Xi.call(Object.prototype,n))&&(e[n]=!0);else return[e,n];return e}if(!e||typeof e!="object")return[e].concat(n);var i=e;return vt(e)&&!vt(n)&&(i=Hf(e,r)),vt(e)&&vt(n)?(n.forEach(function(s,o){if(Xi.call(e,o)){var a=e[o];a&&typeof a=="object"&&s&&typeof s=="object"?e[o]=t(a,s,r):e.push(s)}else e[o]=s}),e):Object.keys(n).reduce(function(s,o){var a=n[o];return Xi.call(s,o)?s[o]=t(s[o],a,r):s[o]=a,s},i)},cx=function(e,n){return Object.keys(n).reduce(function(r,i){return r[i]=n[i],r},e)},ux=function(t,e,n){var r=t.replace(/\+/g," ");if(n==="iso-8859-1")return r.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(r)}catch{return r}},hx=function(e,n,r,i,s){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),r==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});for(var a="",l=0;l<o.length;++l){var c=o.charCodeAt(l);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||s===ox.RFC1738&&(c===40||c===41)){a+=o.charAt(l);continue}if(c<128){a=a+He[c];continue}if(c<2048){a=a+(He[192|c>>6]+He[128|c&63]);continue}if(c<55296||c>=57344){a=a+(He[224|c>>12]+He[128|c>>6&63]+He[128|c&63]);continue}l+=1,c=65536+((c&1023)<<10|o.charCodeAt(l)&1023),a+=He[240|c>>18]+He[128|c>>12&63]+He[128|c>>6&63]+He[128|c&63]}return a},fx=function(e){for(var n=[{obj:{o:e},prop:"o"}],r=[],i=0;i<n.length;++i)for(var s=n[i],o=s.obj[s.prop],a=Object.keys(o),l=0;l<a.length;++l){var c=a[l],u=o[c];typeof u=="object"&&u!==null&&r.indexOf(u)===-1&&(n.push({obj:o,prop:c}),r.push(u))}return ax(n),e},dx=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},px=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},gx=function(e,n){return[].concat(e,n)},mx=function(e,n){if(vt(e)){for(var r=[],i=0;i<e.length;i+=1)r.push(n(e[i]));return r}return n(e)},jf={arrayToObject:Hf,assign:cx,combine:gx,compact:fx,decode:ux,encode:hx,isBuffer:px,isRegExp:dx,maybeMap:mx,merge:lx},Vf=rx,Ir=jf,Mn=ta,_x=Object.prototype.hasOwnProperty,yc={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,n){return e+"["+n+"]"},repeat:function(e){return e}},Ke=Array.isArray,yx=Array.prototype.push,qf=function(t,e){yx.apply(t,Ke(e)?e:[e])},vx=Date.prototype.toISOString,vc=Mn.default,_e={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Ir.encode,encodeValuesOnly:!1,format:vc,formatter:Mn.formatters[vc],indices:!1,serializeDate:function(e){return vx.call(e)},skipNulls:!1,strictNullHandling:!1},bx=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},Ji={},wx=function t(e,n,r,i,s,o,a,l,c,u,f,h,p,d,g,m){for(var _=e,y=m,w=0,E=!1;(y=y.get(Ji))!==void 0&&!E;){var C=y.get(e);if(w+=1,typeof C<"u"){if(C===w)throw new RangeError("Cyclic object value");E=!0}typeof y.get(Ji)>"u"&&(w=0)}if(typeof l=="function"?_=l(n,_):_ instanceof Date?_=f(_):r==="comma"&&Ke(_)&&(_=Ir.maybeMap(_,function(M){return M instanceof Date?f(M):M})),_===null){if(s)return a&&!d?a(n,_e.encoder,g,"key",h):n;_=""}if(bx(_)||Ir.isBuffer(_)){if(a){var I=d?n:a(n,_e.encoder,g,"key",h);return[p(I)+"="+p(a(_,_e.encoder,g,"value",h))]}return[p(n)+"="+p(String(_))]}var L=[];if(typeof _>"u")return L;var R;if(r==="comma"&&Ke(_))d&&a&&(_=Ir.maybeMap(_,a)),R=[{value:_.length>0?_.join(",")||null:void 0}];else if(Ke(l))R=l;else{var N=Object.keys(_);R=c?N.sort(c):N}for(var q=i&&Ke(_)&&_.length===1?n+"[]":n,de=0;de<R.length;++de){var Y=R[de],X=typeof Y=="object"&&typeof Y.value<"u"?Y.value:_[Y];if(!(o&&X===null)){var K=Ke(_)?typeof r=="function"?r(q,Y):q:q+(u?"."+Y:"["+Y+"]");m.set(e,w);var ee=Vf();ee.set(Ji,m),qf(L,t(X,K,r,i,s,o,r==="comma"&&d&&Ke(_)?null:a,l,c,u,f,h,p,d,g,ee))}}return L},Ex=function(e){if(!e)return _e;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var n=e.charset||_e.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=Mn.default;if(typeof e.format<"u"){if(!_x.call(Mn.formatters,e.format))throw new TypeError("Unknown format option provided.");r=e.format}var i=Mn.formatters[r],s=_e.filter;return(typeof e.filter=="function"||Ke(e.filter))&&(s=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:_e.addQueryPrefix,allowDots:typeof e.allowDots>"u"?_e.allowDots:!!e.allowDots,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:_e.charsetSentinel,delimiter:typeof e.delimiter>"u"?_e.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:_e.encode,encoder:typeof e.encoder=="function"?e.encoder:_e.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:_e.encodeValuesOnly,filter:s,format:r,formatter:i,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:_e.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:_e.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:_e.strictNullHandling}},Cx=function(t,e){var n=t,r=Ex(e),i,s;typeof r.filter=="function"?(s=r.filter,n=s("",n)):Ke(r.filter)&&(s=r.filter,i=s);var o=[];if(typeof n!="object"||n===null)return"";var a;e&&e.arrayFormat in yc?a=e.arrayFormat:e&&"indices"in e?a=e.indices?"indices":"repeat":a="indices";var l=yc[a];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var c=l==="comma"&&e&&e.commaRoundTrip;i||(i=Object.keys(n)),r.sort&&i.sort(r.sort);for(var u=Vf(),f=0;f<i.length;++f){var h=i[f];r.skipNulls&&n[h]===null||qf(o,wx(n[h],h,l,c,r.strictNullHandling,r.skipNulls,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}var p=o.join(r.delimiter),d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),p.length>0?d+p:""},an=jf,Ls=Object.prototype.hasOwnProperty,Sx=Array.isArray,oe={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:an.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},Tx=function(t){return t.replace(/&#(\d+);/g,function(e,n){return String.fromCharCode(parseInt(n,10))})},Wf=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},Ix="utf8=%26%2310003%3B",Ax="utf8=%E2%9C%93",Px=function(e,n){var r={__proto__:null},i=n.ignoreQueryPrefix?e.replace(/^\?/,""):e,s=n.parameterLimit===1/0?void 0:n.parameterLimit,o=i.split(n.delimiter,s),a=-1,l,c=n.charset;if(n.charsetSentinel)for(l=0;l<o.length;++l)o[l].indexOf("utf8=")===0&&(o[l]===Ax?c="utf-8":o[l]===Ix&&(c="iso-8859-1"),a=l,l=o.length);for(l=0;l<o.length;++l)if(l!==a){var u=o[l],f=u.indexOf("]="),h=f===-1?u.indexOf("="):f+1,p,d;h===-1?(p=n.decoder(u,oe.decoder,c,"key"),d=n.strictNullHandling?null:""):(p=n.decoder(u.slice(0,h),oe.decoder,c,"key"),d=an.maybeMap(Wf(u.slice(h+1),n),function(g){return n.decoder(g,oe.decoder,c,"value")})),d&&n.interpretNumericEntities&&c==="iso-8859-1"&&(d=Tx(d)),u.indexOf("[]=")>-1&&(d=Sx(d)?[d]:d),Ls.call(r,p)?r[p]=an.combine(r[p],d):r[p]=d}return r},Rx=function(t,e,n,r){for(var i=r?e:Wf(e,n),s=t.length-1;s>=0;--s){var o,a=t[s];if(a==="[]"&&n.parseArrays)o=[].concat(i);else{o=n.plainObjects?Object.create(null):{};var l=a.charAt(0)==="["&&a.charAt(a.length-1)==="]"?a.slice(1,-1):a,c=parseInt(l,10);!n.parseArrays&&l===""?o={0:i}:!isNaN(c)&&a!==l&&String(c)===l&&c>=0&&n.parseArrays&&c<=n.arrayLimit?(o=[],o[c]=i):l!=="__proto__"&&(o[l]=i)}i=o}return i},Ox=function(e,n,r,i){if(e){var s=r.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,l=r.depth>0&&o.exec(s),c=l?s.slice(0,l.index):s,u=[];if(c){if(!r.plainObjects&&Ls.call(Object.prototype,c)&&!r.allowPrototypes)return;u.push(c)}for(var f=0;r.depth>0&&(l=a.exec(s))!==null&&f<r.depth;){if(f+=1,!r.plainObjects&&Ls.call(Object.prototype,l[1].slice(1,-1))&&!r.allowPrototypes)return;u.push(l[1])}return l&&u.push("["+s.slice(l.index)+"]"),Rx(u,n,r,i)}},xx=function(e){if(!e)return oe;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=typeof e.charset>"u"?oe.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?oe.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:oe.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:oe.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:oe.arrayLimit,charset:n,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:oe.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:oe.comma,decoder:typeof e.decoder=="function"?e.decoder:oe.decoder,delimiter:typeof e.delimiter=="string"||an.isRegExp(e.delimiter)?e.delimiter:oe.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:oe.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:oe.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:oe.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:oe.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:oe.strictNullHandling}},Nx=function(t,e){var n=xx(e);if(t===""||t===null||typeof t>"u")return n.plainObjects?Object.create(null):{};for(var r=typeof t=="string"?Px(t,n):t,i=n.plainObjects?Object.create(null):{},s=Object.keys(r),o=0;o<s.length;++o){var a=s[o],l=Ox(a,r[a],n,typeof t=="string");i=an.merge(i,l,n)}return n.allowSparse===!0?i:an.compact(i)},Dx=Cx,$x=Nx,Mx=ta,Lx={formats:Mx,parse:$x,stringify:Dx},kx=PR;function Ne(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Fx=/^([a-z0-9.+-]+:)/i,Bx=/:[0-9]*$/,Ux=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,Hx=["<",">",'"',"`"," ","\r",`
`,"	"],jx=["{","}","|","\\","^","`"].concat(Hx),ks=["'"].concat(jx),bc=["%","/","?",";","#"].concat(ks),wc=["/","?","#"],Vx=255,Ec=/^[+a-z0-9A-Z_-]{0,63}$/,qx=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Wx={javascript:!0,"javascript:":!0},Fs={javascript:!0,"javascript:":!0},Jt={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},Bs=Lx;function cr(t,e,n){if(t&&typeof t=="object"&&t instanceof Ne)return t;var r=new Ne;return r.parse(t,e,n),r}Ne.prototype.parse=function(t,e,n){if(typeof t!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t.indexOf("?"),i=r!==-1&&r<t.indexOf("#")?"?":"#",s=t.split(i),o=/\\/g;s[0]=s[0].replace(o,"/"),t=s.join(i);var a=t;if(a=a.trim(),!n&&t.split("#").length===1){var l=Ux.exec(a);if(l)return this.path=a,this.href=a,this.pathname=l[1],l[2]?(this.search=l[2],e?this.query=Bs.parse(this.search.substr(1)):this.query=this.search.substr(1)):e&&(this.search="",this.query={}),this}var c=Fx.exec(a);if(c){c=c[0];var u=c.toLowerCase();this.protocol=u,a=a.substr(c.length)}if(n||c||a.match(/^\/\/[^@/]+@[^@/]+/)){var f=a.substr(0,2)==="//";f&&!(c&&Fs[c])&&(a=a.substr(2),this.slashes=!0)}if(!Fs[c]&&(f||c&&!Jt[c])){for(var h=-1,p=0;p<wc.length;p++){var d=a.indexOf(wc[p]);d!==-1&&(h===-1||d<h)&&(h=d)}var g,m;h===-1?m=a.lastIndexOf("@"):m=a.lastIndexOf("@",h),m!==-1&&(g=a.slice(0,m),a=a.slice(m+1),this.auth=decodeURIComponent(g)),h=-1;for(var p=0;p<bc.length;p++){var d=a.indexOf(bc[p]);d!==-1&&(h===-1||d<h)&&(h=d)}h===-1&&(h=a.length),this.host=a.slice(0,h),a=a.slice(h),this.parseHost(),this.hostname=this.hostname||"";var _=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!_)for(var y=this.hostname.split(/\./),p=0,w=y.length;p<w;p++){var E=y[p];if(E&&!E.match(Ec)){for(var C="",I=0,L=E.length;I<L;I++)E.charCodeAt(I)>127?C+="x":C+=E[I];if(!C.match(Ec)){var R=y.slice(0,p),N=y.slice(p+1),q=E.match(qx);q&&(R.push(q[1]),N.unshift(q[2])),N.length&&(a="/"+N.join(".")+a),this.hostname=R.join(".");break}}}this.hostname.length>Vx?this.hostname="":this.hostname=this.hostname.toLowerCase(),_||(this.hostname=kx.toASCII(this.hostname));var de=this.port?":"+this.port:"",Y=this.hostname||"";this.host=Y+de,this.href+=this.host,_&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),a[0]!=="/"&&(a="/"+a))}if(!Wx[u])for(var p=0,w=ks.length;p<w;p++){var X=ks[p];if(a.indexOf(X)!==-1){var K=encodeURIComponent(X);K===X&&(K=escape(X)),a=a.split(X).join(K)}}var ee=a.indexOf("#");ee!==-1&&(this.hash=a.substr(ee),a=a.slice(0,ee));var M=a.indexOf("?");if(M!==-1?(this.search=a.substr(M),this.query=a.substr(M+1),e&&(this.query=Bs.parse(this.query)),a=a.slice(0,M)):e&&(this.search="",this.query={}),a&&(this.pathname=a),Jt[u]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var de=this.pathname||"",De=this.search||"";this.path=de+De}return this.href=this.format(),this};function Gx(t){return typeof t=="string"&&(t=cr(t)),t instanceof Ne?t.format():Ne.prototype.format.call(t)}Ne.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,s="";this.host?i=t+this.host:this.hostname&&(i=t+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(s=Bs.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var o=this.search||s&&"?"+s||"";return e&&e.substr(-1)!==":"&&(e+=":"),this.slashes||(!e||Jt[e])&&i!==!1?(i="//"+(i||""),n&&n.charAt(0)!=="/"&&(n="/"+n)):i||(i=""),r&&r.charAt(0)!=="#"&&(r="#"+r),o&&o.charAt(0)!=="?"&&(o="?"+o),n=n.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),o=o.replace("#","%23"),e+i+n+o+r};function zx(t,e){return cr(t,!1,!0).resolve(e)}Ne.prototype.resolve=function(t){return this.resolveObject(cr(t,!1,!0)).format()};function Kx(t,e){return t?cr(t,!1,!0).resolveObject(e):e}Ne.prototype.resolveObject=function(t){if(typeof t=="string"){var e=new Ne;e.parse(t,!1,!0),t=e}for(var n=new Ne,r=Object.keys(this),i=0;i<r.length;i++){var s=r[i];n[s]=this[s]}if(n.hash=t.hash,t.href==="")return n.href=n.format(),n;if(t.slashes&&!t.protocol){for(var o=Object.keys(t),a=0;a<o.length;a++){var l=o[a];l!=="protocol"&&(n[l]=t[l])}return Jt[n.protocol]&&n.hostname&&!n.pathname&&(n.pathname="/",n.path=n.pathname),n.href=n.format(),n}if(t.protocol&&t.protocol!==n.protocol){if(!Jt[t.protocol]){for(var c=Object.keys(t),u=0;u<c.length;u++){var f=c[u];n[f]=t[f]}return n.href=n.format(),n}if(n.protocol=t.protocol,!t.host&&!Fs[t.protocol]){for(var w=(t.pathname||"").split("/");w.length&&!(t.host=w.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),w[0]!==""&&w.unshift(""),w.length<2&&w.unshift(""),n.pathname=w.join("/")}else n.pathname=t.pathname;if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var h=n.pathname||"",p=n.search||"";n.path=h+p}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var d=n.pathname&&n.pathname.charAt(0)==="/",g=t.host||t.pathname&&t.pathname.charAt(0)==="/",m=g||d||n.host&&t.pathname,_=m,y=n.pathname&&n.pathname.split("/")||[],w=t.pathname&&t.pathname.split("/")||[],E=n.protocol&&!Jt[n.protocol];if(E&&(n.hostname="",n.port=null,n.host&&(y[0]===""?y[0]=n.host:y.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(w[0]===""?w[0]=t.host:w.unshift(t.host)),t.host=null),m=m&&(w[0]===""||y[0]==="")),g)n.host=t.host||t.host===""?t.host:n.host,n.hostname=t.hostname||t.hostname===""?t.hostname:n.hostname,n.search=t.search,n.query=t.query,y=w;else if(w.length)y||(y=[]),y.pop(),y=y.concat(w),n.search=t.search,n.query=t.query;else if(t.search!=null){if(E){n.host=y.shift(),n.hostname=n.host;var C=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;C&&(n.auth=C.shift(),n.hostname=C.shift(),n.host=n.hostname)}return n.search=t.search,n.query=t.query,(n.pathname!==null||n.search!==null)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!y.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var I=y.slice(-1)[0],L=(n.host||t.host||y.length>1)&&(I==="."||I==="..")||I==="",R=0,N=y.length;N>=0;N--)I=y[N],I==="."?y.splice(N,1):I===".."?(y.splice(N,1),R++):R&&(y.splice(N,1),R--);if(!m&&!_)for(;R--;R)y.unshift("..");m&&y[0]!==""&&(!y[0]||y[0].charAt(0)!=="/")&&y.unshift(""),L&&y.join("/").substr(-1)!=="/"&&y.push("");var q=y[0]===""||y[0]&&y[0].charAt(0)==="/";if(E){n.hostname=q?"":y.length?y.shift():"",n.host=n.hostname;var C=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;C&&(n.auth=C.shift(),n.hostname=C.shift(),n.host=n.hostname)}return m=m||n.host&&y.length,m&&!q&&y.unshift(""),y.length>0?n.pathname=y.join("/"):(n.pathname=null,n.path=null),(n.pathname!==null||n.search!==null)&&(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n};Ne.prototype.parseHost=function(){var t=this.host,e=Bx.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};yn.parse=cr;yn.resolve=zx;yn.resolveObject=Kx;yn.format=Gx;yn.Url=Ne;var Yx=B&&B.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Qx=B&&B.__createBinding||(Object.create?function(t,e,n,r){r===void 0&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){r===void 0&&(r=n),t[r]=e[n]}),Xx=B&&B.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Jx=B&&B.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var n in t)n!=="default"&&Object.hasOwnProperty.call(t,n)&&Qx(e,t,n);return Xx(e,t),e};Object.defineProperty(zo,"__esModule",{value:!0});var Zx=Ti,Us=Jx(yn);function eN(t){var e=Us.parse(t);return e.protocol===null&&e.host===null&&e.port===null}function tN(t,e){var n=Us.parse(t),r=Us.parse(e);return n.protocol===r.protocol&&n.hostname===r.hostname&&n.port===r.port}var nN=function(t){Yx(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype._initCanvas=function(){var n=this.image,r=this._canvas=document.createElement("canvas"),i=this._context=r.getContext("2d");r.className="vibrant-canvas",r.style.display="none",this._width=r.width=n.width,this._height=r.height=n.height,i.drawImage(n,0,0),document.body.appendChild(r)},e.prototype.load=function(n){var r=this,i=null,s=null;if(typeof n=="string")i=document.createElement("img"),!eN(n)&&!tN(window.location.href,n)&&(i.crossOrigin="anonymous"),s=i.src=n;else if(n instanceof HTMLImageElement)i=n,s=n.src;else return Promise.reject(new Error("Cannot load buffer as an image in browser"));return this.image=i,new Promise(function(o,a){var l=function(){r._initCanvas(),o(r)};i.complete?l():(i.onload=l,i.onerror=function(c){return a(new Error("Fail to load image: "+s))})})},e.prototype.clear=function(){this._context.clearRect(0,0,this._width,this._height)},e.prototype.update=function(n){this._context.putImageData(n,0,0)},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e.prototype.resize=function(n,r,i){var s=this,o=s._canvas,a=s._context,l=s.image;this._width=o.width=n,this._height=o.height=r,a.scale(i,i),a.drawImage(l,0,0)},e.prototype.getPixelCount=function(){return this._width*this._height},e.prototype.getImageData=function(){return this._context.getImageData(0,0,this._width,this._height)},e.prototype.remove=function(){this._canvas&&this._canvas.parentNode&&this._canvas.parentNode.removeChild(this._canvas)},e}(Zx.ImageBase);zo.default=nN;var Gf=B&&B.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},zf=Gf(Af()),rN=Gf(zo);zf.default.DefaultOpts.ImageClass=rN.default;var iN=zf.default;const sN=Nv(iN),Kf=zs({apiKey:{}.FIREBASE_API_KEY,authDomain:{}.FIREBASE_AUTH_DOMAIN,databaseURL:{}.FIREBASE_DATABASE_URL,projectId:{}.FIREBASE_PROJECT_ID,storageBucket:{}.FIREBASE_STORAGE_BUCKET,messagingSenderId:{}.FIREBASE_MESSAGING_SENDER_ID,appId:{}.FIREBASE_APP_ID,measurementId:{}.FIREBASE_MEASUREMENT_ID}),Hs=_u(Kf),oN=$h(Kf),aN=Dh(oN,"songData"),lN=await So(aN),z=lN.val();let cN=document.getElementById("backButton"),Yf=document.querySelectorAll(".song"),uN=document.getElementById("cover"),hN=document.getElementById("playlistTitle"),fN=document.getElementById("author"),ur=document.getElementById("title"),hr=document.getElementById("artist"),dN=document.getElementById("playlistLength"),Ln=document.getElementById("songs"),Qf=document.getElementById("playlistMain"),Xf=document.getElementById("main"),Te=document.getElementById("playPlaylist")?.lastElementChild,Oe=document.getElementById("audio"),pN=document.getElementById("playNext"),gN=document.getElementById("playPrevious"),Ht=document.querySelectorAll(".playButton");const Ii=async t=>{b.audioSource=t;const e=Un(Hs,"songs/"+t),n=await li(e);if(Oe.src=n,ne==b.currentPlaylist&&(Te.firstElementChild.style.display="none",Te.lastElementChild.style.display="block"),Oe.play(),Ln.querySelectorAll("tr").forEach(i=>{let s=i.children[1]?.firstElementChild?.firstElementChild?.lastElementChild;i.classList.remove("playing"),s.style.fill="white"}),ne==b.currentPlaylist){Ln.children[A].classList.add("playing");let i=Ln.children[A].children[1]?.firstElementChild?.firstElementChild?.lastElementChild;i.style.fill="url(#gradient)"}};Te.lastElementChild.style.display="none";let ne=0,A=NaN;cN?.addEventListener("click",()=>{Qf.style.display="none",Xf.style.display="flex";let t=document.querySelectorAll(".song");t.forEach(e=>{e.parentElement.classList.remove("active")}),b.currentPlaylist&&t[b.currentPlaylist].parentElement.classList.add("active"),Yf.forEach((e,n)=>{if(n!=b.currentPlaylist)Ht[n].firstElementChild.style.display="block",Ht[n].lastElementChild.style.display="none";else{let r=document.querySelectorAll(".singleSongButton");Oe.paused?(Ht[n].firstElementChild.style.display="block",Ht[n].lastElementChild.style.display="none",r[A].firstElementChild.style.display="block",r[A].lastElementChild.style.display="none"):(Ht[n].firstElementChild.style.display="none",Ht[n].lastElementChild.style.display="block",r[A].firstElementChild.style.display="none",r[A].lastElementChild.style.display="block")}})});function Cc(t){const e=Math.floor(t/60),n=Math.floor(t%60);return`${e}:${n<10?"0":""}${n}`}async function mN(){let t=0;const e=Un(Hs,"covers/"+z[ne].img),n=await li(e);A!=b.currentSong&&(A=b.currentSong),uN.src=n,hN.textContent=z[ne].title,fN.textContent=z[ne].author;var r=Ln.querySelectorAll("tr");r.forEach(l=>{l.remove()});let i;const s=z[ne].songs.map(async l=>{const c=Un(Hs,"songs/"+l.source);return sm(c).then(u=>u.customMetadata?.duration||"").catch(u=>"")});async function o(){try{const u=`linear-gradient(180deg, ${(await sN.from(n).getPalette()).Vibrant.getHex()} 0%, #13151a 40%, #13151a 100%)`;document.documentElement.style.setProperty("--gradient",u)}catch(l){console.error("Error:",l)}}o();const a=await Promise.all(s);for(const[l,c]of z[ne].songs.entries()){let u=document.createElement("tr");if(u.style.height="3rem",i=parseFloat(a[l]),u.innerHTML+=`
                <td></td>
                <td style="display: flex; height: inherit; padding-right: 1rem;">
                    <button class="singleSongButton" data-id='${l}' data-openedPlaylistID='${ne}' style="padding: 0; border: none; background: none; color: white; cursor: pointer;">
                        <svg viewBox="0 0 16 16" width="32px" height="32px">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M3.24182 2.32181C3.3919 2.23132 3.5784 2.22601 3.73338 2.30781L12.7334 7.05781C12.8974 7.14436 13 7.31457 13 7.5C13 7.68543 12.8974 7.85564 12.7334 7.94219L3.73338 12.6922C3.5784 12.774 3.3919 12.7687 3.24182 12.6782C3.09175 12.5877 3 12.4252 3 12.25V2.75C3 2.57476 3.09175 2.4123 3.24182 2.32181ZM4 3.57925V11.4207L11.4288 7.5L4 3.57925Z" fill="white"></path>
                        </svg>
                        <svg viewBox="0 0 16 16" width="32px" height="32px">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M6.04995 2.74998C6.04995 2.44623 5.80371 2.19998 5.49995 2.19998C5.19619 2.19998 4.94995 2.44623 4.94995 2.74998V12.25C4.94995 12.5537 5.19619 12.8 5.49995 12.8C5.80371 12.8 6.04995 12.5537 6.04995 12.25V2.74998ZM10.05 2.74998C10.05 2.44623 9.80371 2.19998 9.49995 2.19998C9.19619 2.19998 8.94995 2.44623 8.94995 2.74998V12.25C8.94995 12.5537 9.19619 12.8 9.49995 12.8C9.80371 12.8 10.05 12.5537 10.05 12.25V2.74998Z" fill=url(#gradient)></path>
                        </svg>
                    </button>
                </td>
                <td style="padding-right: 1rem;">${l+1}</td>
                <td style="padding-right: 1rem;">${c.title}</td>
                <td style="padding-right: 1rem;">${c.artist}</td>
                <td>${Cc(i)}</td>`,l==A&&ne==b.currentPlaylist){u.classList.add("playing");let g=u.children[1]?.firstElementChild?.firstElementChild?.firstElementChild;g.style.fill="url(#gradient)"}Ln.appendChild(u),t+=i;let f=document.querySelectorAll(".singleSongButton")[l],h=f.firstElementChild,p=f.lastElementChild;if(l!=A||ne!=b.currentPlaylist||Oe.paused?(h.style.display="block",p.style.display="none"):(h.style.display="none",p.style.display="block"),f.getAttribute("listener"))return;const d=()=>{A!=l||b.currentPlaylist!=ne?(A=l,b.currentSong=l,b.currentPlaylist=ne,document.querySelectorAll(".singleSongButton").forEach(m=>{let _=m.firstElementChild,y=m.lastElementChild;_.style.display="block",y.style.display="none"}),Ii(c.source),ur.textContent=z[b.currentPlaylist].songs[l].title,hr.textContent=z[b.currentPlaylist].songs[l].artist,h.style.display="none",p.style.display="block"):Oe.paused?(ti(Te),h.style.display="none",p.style.display="block"):(ti(Te),h.style.display="block",p.style.display="none")};u.addEventListener("click",()=>{u.parentElement.querySelectorAll("tr").forEach(g=>{g.classList.remove("selected")}),u.classList.add("selected")}),u.addEventListener("dblclick",()=>{d()}),f.addEventListener("click",()=>{d()})}dN.textContent="Playlist length: "+Cc(t)}const ti=(t,e=!1)=>{let n=t.firstElementChild,r=t.lastElementChild;if(z[b.currentPlaylist].songs[A]&&z[b.currentPlaylist].songs[A].source!=b.audioSource&&!e){Ii(z[b.currentPlaylist].songs[A].source),n.style.display="none",r.style.display="block",ur.textContent=z[b.currentPlaylist].songs[A].title,hr.textContent=z[b.currentPlaylist].songs[A].artist;return}Oe.paused?(e||Oe.play(),n.style.display="none",r.style.display="block"):(e||Oe.pause(),n.style.display="block",r.style.display="none")},_N=()=>{let t=document.querySelectorAll(".singleSongButton");isNaN(A)&&(A=0,b.currentSong=0),ne==b.currentPlaylist?ti(t[A]):ne!=b.currentPlaylist&&(A=0,b.currentSong=0,Ii(z[ne].songs[A].source),b.currentPlaylist=ne,ti(t[A],!1),t[A].lastElementChild.style.display="block",t[A].firstElementChild.style.display="none"),ur.textContent=z[b.currentPlaylist].songs[A].title,hr.textContent=z[b.currentPlaylist].songs[A].artist,Oe.paused?(Te.firstElementChild.style.display="block",Te.lastElementChild.style.display="none"):(Te.firstElementChild.style.display="none",Te.lastElementChild.style.display="block")};Te.addEventListener("click",()=>{_N()});Yf.forEach((t,e)=>{t.addEventListener("click",()=>{Qf.style.display="block",Xf.style.display="none",ne=e,b.openedPlaylist=ne,mN(),ne!=b.currentPlaylist||Oe.paused?(Te.firstElementChild.style.display="block",Te.lastElementChild.style.display="none"):(Te.firstElementChild.style.display="none",Te.lastElementChild.style.display="block")})});const ni=()=>{let t=document.querySelectorAll(".singleSongButton");ne==b.currentPlaylist&&t[A]&&(t.forEach(e=>{let n=e.firstElementChild,r=e.lastElementChild;n.style.display="block",r.style.display="none"}),t[b.currentSong].firstElementChild.style.display="none",t[b.currentSong].lastElementChild.style.display="block"),Ii(z[b.currentPlaylist].songs[A].source),ur.textContent=z[b.currentPlaylist].songs[A].title,hr.textContent=z[b.currentPlaylist].songs[A].artist};let An=[],ri=[];const Jf=()=>{if(isNaN(A)&&(A=b.currentSong),b.isShuffling){ri.push(z[b.currentPlaylist].songs[A]),An.length<=1&&(An=z[b.currentPlaylist].songs.filter(e=>e.source!==z[b.currentPlaylist].songs[A].source),An.sort(()=>Math.random()-.5));let t=An[0];ur.textContent=t.title,hr.textContent=t.artist,A=z[b.currentPlaylist].songs.findIndex(e=>e.source===t.source),b.currentSong=A,ni(),An.shift()}else z[b.currentPlaylist].songs.length-1>b.currentSong&&(ri.push(z[b.currentPlaylist].songs[A]),A++,b.currentSong=A,ni())},yN=()=>{if(isNaN(A)&&(A=b.currentSong),Oe.currentTime>3){Oe.currentTime=0;return}if(ri.length>0){let t=ri.pop();A=z[b.currentPlaylist].songs.findIndex(e=>e.source===t.source),b.currentSong=A,ni()}else b.currentSong>0&&(A--,b.currentSong=A,ni())};Oe.addEventListener("ended",()=>{Jf()});pN.addEventListener("click",()=>{Jf()});gN.addEventListener("click",()=>{yN()});const vN="astro:before-preparation",bN="astro:after-preparation",wN="astro:before-swap",EN="astro:after-swap",CN=t=>document.dispatchEvent(new Event(t));class Zf extends Event{from;to;direction;navigationType;sourceElement;info;newDocument;constructor(e,n,r,i,s,o,a,l,c){super(e,n),this.from=r,this.to=i,this.direction=s,this.navigationType=o,this.sourceElement=a,this.info=l,this.newDocument=c,Object.defineProperties(this,{from:{enumerable:!0},to:{enumerable:!0,writable:!0},direction:{enumerable:!0,writable:!0},navigationType:{enumerable:!0},sourceElement:{enumerable:!0},info:{enumerable:!0},newDocument:{enumerable:!0,writable:!0}})}}class SN extends Zf{formData;loader;constructor(e,n,r,i,s,o,a,l,c){super(vN,{cancelable:!0},e,n,r,i,s,o,a),this.formData=l,this.loader=c.bind(this,this),Object.defineProperties(this,{formData:{enumerable:!0},loader:{enumerable:!0,writable:!0}})}}class TN extends Zf{direction;viewTransition;swap;constructor(e,n,r){super(wN,void 0,e.from,e.to,e.direction,e.navigationType,e.sourceElement,e.info,e.newDocument),this.direction=e.direction,this.viewTransition=n,this.swap=r.bind(this,this),Object.defineProperties(this,{direction:{enumerable:!0},viewTransition:{enumerable:!0},swap:{enumerable:!0,writable:!0}})}}async function IN(t,e,n,r,i,s,o,a){const l=new SN(t,e,n,r,i,s,window.document,o,a);return document.dispatchEvent(l)&&(await l.loader(),l.defaultPrevented||(CN(bN),l.navigationType!=="traverse"&&na({scrollX,scrollY}))),l}async function AN(t,e,n){const r=new TN(t,e,n);return document.dispatchEvent(r),r.swap(),r}const na=t=>{history.state&&(history.scrollRestoration="manual",history.replaceState({...history.state,...t},""))},ra=!!document.startViewTransition,ia=()=>!!document.querySelector('[name="astro-view-transitions-enabled"]'),js=(t,e)=>t.origin===e.origin&&t.pathname===e.pathname&&t.search===e.search;let Ai,qt,ii=!1,ed;const td=t=>document.dispatchEvent(new Event(t)),nd=()=>td("astro:page-load"),PN=()=>{let t=document.createElement("div");t.setAttribute("aria-live","assertive"),t.setAttribute("aria-atomic","true"),t.className="astro-route-announcer",document.body.append(t),setTimeout(()=>{let e=document.title||document.querySelector("h1")?.textContent||location.pathname;t.textContent=e},60)},rt="data-astro-transition-persist",rd="data-astro-transition",id="data-astro-transition-fallback";let Sc,Yn=0;history.state?(Yn=history.state.index,scrollTo({left:history.state.scrollX,top:history.state.scrollY})):ia()&&(history.replaceState({index:Yn,scrollX,scrollY},""),history.scrollRestoration="manual");const RN=(t,e)=>{let n=!1,r=!1;return(...i)=>{if(n){r=!0;return}t(...i),n=!0,setTimeout(()=>{r&&(r=!1,t(...i)),n=!1},e)}};async function ON(t,e){try{const n=await fetch(t,e),r=n.headers.get("content-type")?.replace(/;.*$/,"");return r!=="text/html"&&r!=="application/xhtml+xml"?null:{html:await n.text(),redirected:n.redirected?n.url:void 0,mediaType:r}}catch{return null}}function sd(){const t=document.querySelector('[name="astro-view-transitions-fallback"]');return t?t.getAttribute("content"):"animate"}function xN(){let t=Promise.resolve();for(const e of Array.from(document.scripts)){if(e.dataset.astroExec==="")continue;const n=document.createElement("script");n.innerHTML=e.innerHTML;for(const r of e.attributes){if(r.name==="src"){const i=new Promise(s=>{n.onload=s});t=t.then(()=>i)}n.setAttribute(r.name,r.value)}n.dataset.astroExec="",e.replaceWith(n)}return t}const od=(t,e,n,r)=>{const i=js(e,t);let s=!1;if(t.href!==location.href&&!r)if(n.history==="replace"){const o=history.state;history.replaceState({...n.state,index:o.index,scrollX:o.scrollX,scrollY:o.scrollY},"",t.href)}else history.pushState({...n.state,index:++Yn,scrollX:0,scrollY:0},"",t.href);Ai=t,i||(scrollTo({left:0,top:0,behavior:"instant"}),s=!0),r?scrollTo(r.scrollX,r.scrollY):(t.hash?(history.scrollRestoration="auto",location.href=t.href):s||scrollTo({left:0,top:0,behavior:"instant"}),history.scrollRestoration="manual")};function NN(t){const e=[];for(const n of t.querySelectorAll("head link[rel=stylesheet]"))if(!document.querySelector(`[${rt}="${n.getAttribute(rt)}"], link[rel=stylesheet][href="${n.getAttribute("href")}"]`)){const r=document.createElement("link");r.setAttribute("rel","preload"),r.setAttribute("as","style"),r.setAttribute("href",n.getAttribute("href")),e.push(new Promise(i=>{["load","error"].forEach(s=>r.addEventListener(s,i)),document.head.append(r)}))}return e}async function Tc(t,e,n,r){const i=(u,f)=>{const h=u.getAttribute(rt),p=h&&f.head.querySelector(`[${rt}="${h}"]`);if(p)return p;if(u.matches("link[rel=stylesheet]")){const d=u.getAttribute("href");return f.head.querySelector(`link[rel=stylesheet][href="${d}"]`)}return null},s=()=>{const u=document.activeElement;if(u?.closest(`[${rt}]`)){if(u instanceof HTMLInputElement||u instanceof HTMLTextAreaElement){const f=u.selectionStart,h=u.selectionEnd;return{activeElement:u,start:f,end:h}}return{activeElement:u}}else return{activeElement:null}},o=({activeElement:u,start:f,end:h})=>{u&&(u.focus(),(u instanceof HTMLInputElement||u instanceof HTMLTextAreaElement)&&(u.selectionStart=f,u.selectionEnd=h))},a=u=>{const f=document.documentElement,h=[...f.attributes].filter(({name:g})=>(f.removeAttribute(g),g.startsWith("data-astro-")));[...u.newDocument.documentElement.attributes,...h].forEach(({name:g,value:m})=>f.setAttribute(g,m));for(const g of document.scripts)for(const m of u.newDocument.scripts)if(!g.src&&g.textContent===m.textContent||g.src&&g.type===m.type&&g.src===m.src){m.dataset.astroExec="";break}for(const g of Array.from(document.head.children)){const m=i(g,u.newDocument);m?m.remove():g.remove()}document.head.append(...u.newDocument.head.children);const p=document.body,d=s();document.body.replaceWith(u.newDocument.body);for(const g of p.querySelectorAll(`[${rt}]`)){const m=g.getAttribute(rt),_=document.querySelector(`[${rt}="${m}"]`);_&&_.replaceWith(g)}o(d)};async function l(u){function f(g){const m=g.effect;return!m||!(m instanceof KeyframeEffect)||!m.target?!1:window.getComputedStyle(m.target,m.pseudoElement).animationIterationCount==="infinite"}const h=document.getAnimations();document.documentElement.setAttribute(id,u);const d=document.getAnimations().filter(g=>!h.includes(g)&&!f(g));return Promise.all(d.map(g=>g.finished))}if(!ii)document.documentElement.setAttribute(rd,t.direction),r==="animate"&&await l("old");else throw new DOMException("Transition was skipped");const c=await AN(t,qt,a);od(c.to,c.from,e,n),td(EN),r==="animate"&&!ii&&l("new").then(()=>ed())}async function ad(t,e,n,r,i){const s=i?"traverse":r.history==="replace"?"replace":"push";if(js(e,n)&&!r.formData){s!=="traverse"&&na({scrollX,scrollY}),od(n,e,r,i);return}const o=await IN(e,n,t,s,r.sourceElement,r.info,r.formData,l);if(o.defaultPrevented){location.href=n.href;return}function a(c){return c.to.hash===""||!js(c.from,c.to)||c.sourceElement instanceof HTMLFormElement}async function l(c){if(a(c)){const u=c.to.href,f={};c.formData&&(f.method="POST",f.body=c.formData);const h=await ON(u,f);if(h===null){c.preventDefault();return}if(h.redirected&&(c.to=new URL(h.redirected)),Sc??=new DOMParser,c.newDocument=Sc.parseFromString(h.html,h.mediaType),c.newDocument.querySelectorAll("noscript").forEach(d=>d.remove()),!c.newDocument.querySelector('[name="astro-view-transitions-enabled"]')&&!c.formData){c.preventDefault();return}const p=NN(c.newDocument);p.length&&await Promise.all(p)}else{c.newDocument=document;return}}if(ii=!1,ra)qt=document.startViewTransition(async()=>await Tc(o,r,i));else{const c=(async()=>{await new Promise(u=>setTimeout(u)),await Tc(o,r,i,sd())})();qt={updateCallbackDone:c,ready:c,finished:new Promise(u=>ed=u),skipTransition:()=>{ii=!0}}}qt.ready.then(async()=>{await xN(),nd(),PN()}),qt.finished.then(()=>{document.documentElement.removeAttribute(rd),document.documentElement.removeAttribute(id)}),await qt.ready}async function Ic(t,e){if(!ia()){location.href=t;return}await ad("forward",Ai,new URL(t,location.href),e??{})}function DN(t){if(!ia()&&t.state){location.reload();return}if(t.state===null)return;const e=history.state,n=e.index,r=n>Yn?"forward":"back";Yn=n,ad(r,Ai,new URL(location.href),{},e)}const Ac=()=>{na({scrollX,scrollY})};{(ra||sd()!=="none")&&(Ai=new URL(location.href),addEventListener("popstate",DN),addEventListener("load",nd),"onscrollend"in window?addEventListener("scrollend",Ac):addEventListener("scroll",RN(Ac,350),{passive:!0}));for(const t of document.scripts)t.dataset.astroExec=""}const ld=new Set,si=new WeakSet;let Vs,cd,Pc=!1;function $N(t){Pc||(Pc=!0,Vs??=t?.prefetchAll??!1,cd??=t?.defaultStrategy??"hover",MN(),LN(),kN())}function MN(){for(const t of["touchstart","mousedown"])document.body.addEventListener(t,e=>{oi(e.target,"tap")&&sa(e.target.href,{with:"fetch",ignoreSlowConnection:!0})},{passive:!0})}function LN(){let t;document.body.addEventListener("focusin",r=>{oi(r.target,"hover")&&e(r)},{passive:!0}),document.body.addEventListener("focusout",n,{passive:!0}),hd(()=>{for(const r of document.getElementsByTagName("a"))si.has(r)||oi(r,"hover")&&(si.add(r),r.addEventListener("mouseenter",e,{passive:!0}),r.addEventListener("mouseleave",n,{passive:!0}))});function e(r){const i=r.target.href;t&&clearTimeout(t),t=setTimeout(()=>{sa(i,{with:"fetch"})},80)}function n(){t&&(clearTimeout(t),t=0)}}function kN(){let t;hd(()=>{for(const e of document.getElementsByTagName("a"))si.has(e)||oi(e,"viewport")&&(si.add(e),t??=FN(),t.observe(e))})}function FN(){const t=new WeakMap;return new IntersectionObserver((e,n)=>{for(const r of e){const i=r.target,s=t.get(i);r.isIntersecting?(s&&clearTimeout(s),t.set(i,setTimeout(()=>{n.unobserve(i),t.delete(i),sa(i.href,{with:"link"})},300))):s&&(clearTimeout(s),t.delete(i))}})}function sa(t,e){const n=e?.ignoreSlowConnection??!1;if(!BN(t,n))return;if(ld.add(t),(e?.with??"link")==="link"){const i=document.createElement("link");i.rel="prefetch",i.setAttribute("href",t),document.head.append(i)}else fetch(t).catch(i=>{console.log(`[astro] Failed to prefetch ${t}`),console.error(i)})}function BN(t,e){if(!navigator.onLine||!e&&ud())return!1;try{const n=new URL(t,location.href);return location.origin===n.origin&&(location.pathname!==n.pathname||location.search!==n.search)&&!ld.has(t)}catch{}return!1}function oi(t,e){if(t?.tagName!=="A")return!1;const n=t.dataset.astroPrefetch;return n==="false"?!1:e==="tap"&&(n!=null||Vs)&&ud()?!0:n==null&&Vs||n===""?e===cd:n===e}function ud(){if("connection"in navigator){const t=navigator.connection;return t.saveData||/(2|3)g/.test(t.effectiveType)}return!1}function hd(t){t();let e=!1;document.addEventListener("astro:page-load",()=>{if(!e){e=!0;return}t()})}function UN(){const t=document.querySelector('[name="astro-view-transitions-fallback"]');return t?t.getAttribute("content"):"animate"}function Rc(t){return t.dataset.astroReload!==void 0}(ra||UN()!=="none")&&(document.addEventListener("click",t=>{let e=t.target;if(e instanceof Element&&(e=e.closest("a, area")),!(e instanceof HTMLAnchorElement)&&!(e instanceof SVGAElement)&&!(e instanceof HTMLAreaElement))return;const n=e instanceof HTMLElement?e.target:e.target.baseVal,r=e instanceof HTMLElement?e.href:e.href.baseVal,i=new URL(r,location.href).origin;Rc(e)||e.hasAttribute("download")||!e.href||n&&n!=="_self"||i!==location.origin||t.button!==0||t.metaKey||t.ctrlKey||t.altKey||t.shiftKey||t.defaultPrevented||(t.preventDefault(),Ic(r,{history:e.dataset.astroHistory==="replace"?"replace":"auto",sourceElement:e}))}),document.querySelector('[name="astro-view-transitions-forms"]')&&document.addEventListener("submit",t=>{let e=t.target;if(e.tagName!=="FORM"||Rc(e))return;const n=e,r=t.submitter,i=new FormData(n);let s=r?.getAttribute("formaction")??n.action??location.pathname;const o=r?.getAttribute("formmethod")??n.method,a={sourceElement:r??n};if(o==="get"){const l=new URLSearchParams(i),c=new URL(s);c.search=l.toString(),s=c.toString()}else a.formData=i;t.preventDefault(),Ic(s,a)}),$N({prefetchAll:!0}));
